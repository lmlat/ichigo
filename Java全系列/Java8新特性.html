<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>lambdaè¡¨è¾¾ç¤º | ç¨‹åºå‘˜æˆé•¿æŒ‡å—</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/ichigo/logo.ico">
    <meta name="description" content="è®°å½•ä¸ªäººçš„æˆé•¿è¿‡ç¨‹, çŸ¥è¯†ç‚¹å½’çº³æ€»ç»“, ä»å…¥å‘åˆ°æŒ–å‘çš„å¼€å¿ƒæ—¶å…‰~">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/ichigo/assets/css/0.styles.cf0a4651.css" as="style"><link rel="preload" href="/ichigo/assets/js/app.8ce08534.js" as="script"><link rel="preload" href="/ichigo/assets/js/3.440a4598.js" as="script"><link rel="preload" href="/ichigo/assets/js/1.7543bd4f.js" as="script"><link rel="preload" href="/ichigo/assets/js/13.ecbcfc5b.js" as="script"><link rel="preload" href="/ichigo/assets/js/9.00897824.js" as="script"><link rel="prefetch" href="/ichigo/assets/js/10.06f06474.js"><link rel="prefetch" href="/ichigo/assets/js/11.d88a996d.js"><link rel="prefetch" href="/ichigo/assets/js/12.40112076.js"><link rel="prefetch" href="/ichigo/assets/js/14.2d4ad4d8.js"><link rel="prefetch" href="/ichigo/assets/js/15.7f02c07a.js"><link rel="prefetch" href="/ichigo/assets/js/16.3e83926b.js"><link rel="prefetch" href="/ichigo/assets/js/17.895365fa.js"><link rel="prefetch" href="/ichigo/assets/js/18.5ce7702c.js"><link rel="prefetch" href="/ichigo/assets/js/19.4026da04.js"><link rel="prefetch" href="/ichigo/assets/js/20.82775ba2.js"><link rel="prefetch" href="/ichigo/assets/js/21.336709a8.js"><link rel="prefetch" href="/ichigo/assets/js/22.cd8ce7e7.js"><link rel="prefetch" href="/ichigo/assets/js/23.de97340d.js"><link rel="prefetch" href="/ichigo/assets/js/24.8136404b.js"><link rel="prefetch" href="/ichigo/assets/js/25.580ae8ec.js"><link rel="prefetch" href="/ichigo/assets/js/4.2bb206fd.js"><link rel="prefetch" href="/ichigo/assets/js/5.4377ba8f.js"><link rel="prefetch" href="/ichigo/assets/js/6.374eca97.js"><link rel="prefetch" href="/ichigo/assets/js/7.d49f5611.js"><link rel="prefetch" href="/ichigo/assets/js/8.8f8e74be.js">
    <link rel="stylesheet" href="/ichigo/assets/css/0.styles.cf0a4651.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>ç¨‹åºå‘˜æˆé•¿æŒ‡å—</h3> <p class="description" data-v-59e6cb88>è®°å½•ä¸ªäººçš„æˆé•¿è¿‡ç¨‹, çŸ¥è¯†ç‚¹å½’çº³æ€»ç»“, ä»å…¥å‘åˆ°æŒ–å‘çš„å¼€å¿ƒæ—¶å…‰~</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>æ‰€å¹¸ä½ æ˜¯ä¾‹å¤–</span>
        Â Â 
        <!---->
        2023
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/ichigo/" class="home-link router-link-active"><!----> <span class="site-name">ç¨‹åºå‘˜æˆé•¿æŒ‡å—</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/ichigo/" class="nav-link"><i class="iconfont reco-home"></i>
  é¦–é¡µ
</a></div><div class="nav-item"><a href="https://juejin.cn/user/726107228492253" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  å¯¼èˆª
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/ichigo/æ•°æ®ç»“æ„ä¸ç®—æ³•/" class="nav-link"><i class="undefined"></i>
  æ•°æ®ç»“æ„ä¸ç®—æ³•
</a></div><div class="nav-item"><a href="https://juejin.cn/user/726107228492253" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-juejin"></i>
  æ˜é‡‘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/coding-lin" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><!----> <h3 class="name" data-v-1fad0c41>
    æ‰€å¹¸ä½ æ˜¯ä¾‹å¤–
  </h3> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>13</h3> <h6 data-v-1fad0c41>æ–‡ç« </h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>0</h3> <h6 data-v-1fad0c41>æ ‡ç­¾</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/ichigo/" class="nav-link"><i class="iconfont reco-home"></i>
  é¦–é¡µ
</a></div><div class="nav-item"><a href="https://juejin.cn/user/726107228492253" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  å¯¼èˆª
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/ichigo/æ•°æ®ç»“æ„ä¸ç®—æ³•/" class="nav-link"><i class="undefined"></i>
  æ•°æ®ç»“æ„ä¸ç®—æ³•
</a></div><div class="nav-item"><a href="https://juejin.cn/user/726107228492253" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-juejin"></i>
  æ˜é‡‘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/coding-lin" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Javaå…¨ç³»åˆ—</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ichigo/Javaå…¨ç³»åˆ—/Java IOæµ.html" class="sidebar-link">IOæµ</a></li><li><a href="/ichigo/Javaå…¨ç³»åˆ—/Java8æ–°ç‰¹æ€§.html" class="active sidebar-link">lambdaè¡¨è¾¾ç¤º</a></li><li><a href="/ichigo/Javaå…¨ç³»åˆ—/Java9æ–°ç‰¹æ€§.html" class="sidebar-link">Java9æ–°ç‰¹æ€§</a></li><li><a href="/ichigo/Javaå…¨ç³»åˆ—/Javaå…¨ç¯‡.html" class="sidebar-link">æ¦‚è¿°</a></li><li><a href="/ichigo/Javaå…¨ç³»åˆ—/Javaå¸¸ç”¨ç±».html" class="sidebar-link">å¤§æ•°ç±»</a></li><li><a href="/ichigo/Javaå…¨ç³»åˆ—/æ­£åˆ™è¡¨è¾¾å¼.html" class="sidebar-link">æ­£åˆ™è¡¨è¾¾å¼</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88></h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>æ‰€å¹¸ä½ æ˜¯ä¾‹å¤–</span>
        Â Â 
        <!---->
        2023
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">lambdaè¡¨è¾¾ç¤º</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>æ‰€å¹¸ä½ æ˜¯ä¾‹å¤–</span></i> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default"><h1 id="lambdaè¡¨è¾¾ç¤º"><a href="#lambdaè¡¨è¾¾ç¤º" class="header-anchor">#</a> lambdaè¡¨è¾¾ç¤º</h1> <p>å‚è€ƒæ–‡ç« ï¼š</p> <ol><li><a href="https://www.w3cschool.cn/java/java-lambda-syntax.html" target="_blank" rel="noopener noreferrer">java lambdaè¡¨è¾¾å¼æ•™ç¨‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/qq_31807385/article/details/82670505" target="_blank" rel="noopener noreferrer">æ·±å…¥ç†è§£java lambdaè¡¨è¾¾å¼ï¼ˆå…¨ç½‘ä¹‹æœ€ï¼‰<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>https://docs.oracle.com/javase/8/docs/technotes/tools/windows/javap.html</li> <li><a href="https://blog.csdn.net/jiankunking/article/details/79825928" target="_blank" rel="noopener noreferrer">Java Lambdaè¡¨è¾¾å¼ å®ç°åŸç†åˆ†æ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol> <h2 id="ä»€ä¹ˆæ˜¯lambdaè¡¨è¾¾å¼"><a href="#ä»€ä¹ˆæ˜¯lambdaè¡¨è¾¾å¼" class="header-anchor">#</a> ä»€ä¹ˆæ˜¯lambdaè¡¨è¾¾å¼</h2> <p>lambdaè¡¨è¾¾å¼ç§°ä¸ºé—­åŒ…ï¼Œå®ƒæ˜¯ä¸€ç§æ›´ç®€æ´çš„åŒ¿åå‡½æ•°ï¼Œå¯ä»¥åŒ…å«è¡¨è¾¾å¼å’Œè¯­å¥ã€‚å®ƒå…è®¸<code>å°†ä¸€ä¸ªæ–¹æ³•ä½œä¸ºå‚æ•°ä¼ é€’åˆ°å¦ä¸€ä¸ªæ–¹æ³•ä¸­</code>ã€‚</p> <p>lambdaè¡¨è¾¾å¼è¯­æ³•ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token punctuation">(</span>å‚æ•°åˆ—è¡¨<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span> è¡¨è¾¾å¼<span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre></div><blockquote><p>æ€§è´¨ï¼š</p> <ul><li><code>å¯é€‰ç±»å‹å£°æ˜</code>ï¼šæ— éœ€å£°æ˜å‚æ•°ç±»å‹ï¼›</li> <li><code>å¯é€‰çš„å‚æ•°åœ†æ‹¬å·</code>ï¼šä¸€ä¸ªå‚æ•°æ—¶ä¸éœ€è¦å®šä¹‰åœ†æ‹¬å·ï¼›</li> <li><code>å¯é€‰çš„å¤§æ‹¬å·</code>ï¼šæ–¹æ³•ä½“åªåŒ…å«ä¸€æ¡è¯­å¥æ—¶ä¸éœ€è¦å¤§æ‹¬å·ï¼›</li> <li><code>å¯é€‰çš„returnå…³é”®å­—</code>ï¼šæ–¹æ³•ä½“ä¸­åªæœ‰ä¸€æ¡è¡¨è¾¾å¼æ—¶ï¼Œä¸éœ€è¦é€šè¿‡returnå…³é”®å­—ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å°†å…¶ä½œä¸ºè¿”å›å€¼ï¼›</li></ul></blockquote> <p>lambdaè¡¨è¾¾å¼å¯åˆ†ä¸ºç©ºå‚æ— è¿”å›å€¼ã€ç©ºå‚æœ‰è¿”å›å€¼ã€æœ‰å‚æ— è¿”å›å€¼ã€æœ‰å‚æœ‰è¿”å›å€¼4ç§ã€‚</p> <ul><li><strong>ç©ºå‚æ— è¿”å›å€¼</strong></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//ç©ºå‚</span>
<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;hello java8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><strong>ç©ºå‚æœ‰è¿”å›å€¼</strong></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token string">&quot;hello java8&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token string">&quot;hello java8&quot;</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
</code></pre></div><ul><li><strong>æœ‰å‚æ— è¿”å›å€¼</strong></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// éšå¼ç±»å‹</span>
msg <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// æ˜¾ç¤ºç±»å‹</span>
<span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span><span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">String</span> msg<span class="token punctuation">)</span><span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><strong>æœ‰å‚æœ‰è¿”å›å€¼</strong></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//å•ä¸ªå‚æ•°</span>
msg <span class="token operator">-&gt;</span> msg<span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span><span class="token operator">-</span> <span class="token operator">&gt;</span> msg<span class="token punctuation">;</span>
<span class="token comment">// finalä¿®é¥°</span>
<span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">String</span> msg<span class="token punctuation">)</span><span class="token operator">-</span> <span class="token operator">&gt;</span> msg<span class="token punctuation">;</span>
msg <span class="token operator">-&gt;</span> <span class="token punctuation">{</span><span class="token keyword">return</span> msg<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token comment">//å¤šä¸ªå‚æ•°</span>
<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> a<span class="token operator">+</span>b<span class="token punctuation">;</span>
<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span><span class="token keyword">return</span> a<span class="token operator">+</span>b<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> a<span class="token operator">+</span>b<span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> a<span class="token operator">+</span>b<span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> a<span class="token operator">+</span>b<span class="token punctuation">;</span>
</code></pre></div><blockquote><p>ğŸ’¡tipï¼š</p> <ul><li>lambdaè¡¨è¾¾å¼ä¸»ä½“å¯ä»¥æœ‰å±€éƒ¨å˜é‡ï¼Œè¯­å¥ã€‚å¯ä»¥ä½¿ç”¨breakã€continueã€returnï¼Œæˆ–è€…æŠ›å‡º(throw)å¼‚å¸¸ã€‚</li> <li>lambdaè¡¨è¾¾å¼çš„<strong>è¿”å›ç±»å‹ç”±ç¼–è¯‘å™¨æ¨æ–­</strong>ã€‚</li> <li>lambdaè¡¨è¾¾å¼<strong>ä¸èƒ½ä½¿ç”¨throwså­å¥</strong>ã€‚</li> <li>lambdaè¡¨è¾¾å¼<strong>ä¸èƒ½æ˜¯æ³›å‹</strong>ï¼Œè€Œæ³›å‹åœ¨å‡½æ•°æ¥å£ä¸­å®šä¹‰ã€‚</li> <li>lambdaè¡¨è¾¾å¼<strong>æœ¬èº«ä¸èƒ½ç”¨ä½œç‹¬ç«‹çš„è¡¨è¾¾å¼</strong>ã€‚</li></ul></blockquote> <h2 id="lambdaè¡¨è¾¾å¼ç±»å‹æ£€æŸ¥"><a href="#lambdaè¡¨è¾¾å¼ç±»å‹æ£€æŸ¥" class="header-anchor">#</a> Lambdaè¡¨è¾¾å¼ç±»å‹æ£€æŸ¥</h2> <p><img src="https://www.freesion.com/images/522/b6ed8af5b0cc7b560b19be1320e8273a.png" alt="img"></p> <h2 id="lambdaè¡¨è¾¾å¼ç±»å‹æ¨æ–­"><a href="#lambdaè¡¨è¾¾å¼ç±»å‹æ¨æ–­" class="header-anchor">#</a> Lambdaè¡¨è¾¾å¼ç±»å‹æ¨æ–­</h2> <p>å½“lambdaè¡¨è¾¾å¼<code>æ²¡æœ‰æ˜¾å¼å£°æ˜å‚æ•°ç±»å‹</code>æ—¶ï¼ŒJVMä¼šé€šè¿‡ç›®æ ‡ç±»å‹æ¨æ–­å‡ºå…¥å‚ç±»å‹ã€‚</p> <p>æ¨æ–­lambdaè¡¨è¾¾å¼ç±»å‹çš„è¿‡ç¨‹ç§°ä¸ºç›®æ ‡ç±»å‹ï¼›</p> <blockquote><p>ç¼–è¯‘å™¨æ¨æ–­lambdaè¡¨è¾¾å¼ç±»å‹çš„æ¡ä»¶ï¼š</p> <ul><li>å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼›</li> <li>lambdaè¡¨è¾¾ç¤ºçš„å‚æ•°å¿…é¡»ä¸å‡½æ•°å¼æ¥å£ä¸­çš„æ–¹æ³•åŒ¹é…ï¼›</li> <li>lambdaè¡¨è¾¾å¼çš„è¿”å›ç±»å‹å¿…é¡»ä¸å‡½æ•°å¼æ¥å£ä¸­çš„æ–¹æ³•è¿”å›ç±»å‹å…¼å®¹ï¼›</li> <li>lambdaè¡¨è¾¾å¼æŠ›å‡ºçš„æ£€æŸ¥å¼‚å¸¸å¿…é¡»ä¸å‡½æ•°å¼æ¥å£ä¸­æŠ›å‡ºçš„å¼‚å¸¸å…¼å®¹ï¼›</li></ul></blockquote> <p>ä¸‹é¢å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°å¼æ¥å£Calculator<T>ã€‚Calculatoræ¥å£ä¸­å®šä¹‰äº†ä¸€ä¸ªaddæ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ¥å—ä¸¤ä¸ªæ³›å‹Tç±»å‹ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›æ³›å‹Tç±»å‹ã€‚</T></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@FunctionalInterface</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Calculator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token class-name">T</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">T</span> a<span class="token punctuation">,</span> <span class="token class-name">T</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Integerç±»å‹</span>
        <span class="token class-name">Calculator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> calculator <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
        <span class="token comment">// è¿”å›3</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>calculator<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="lambdaè¡¨è¾¾å¼è¡Œä¸ºå‚æ•°åŒ–"><a href="#lambdaè¡¨è¾¾å¼è¡Œä¸ºå‚æ•°åŒ–" class="header-anchor">#</a> Lambdaè¡¨è¾¾å¼è¡Œä¸ºå‚æ•°åŒ–</h2> <p><code>è¡Œä¸ºå‚æ•°åŒ–</code>ï¼šå°†lambdaè¡¨è¾¾å¼ä½œä¸ºå‚æ•°ä¼ é€’åˆ°å¦ä¸€ä¸ªæ–¹æ³•ä¸­ï¼Œé€šè¿‡è¯¥å‚æ•°ä¿®æ”¹æ–¹æ³•çš„è¡Œä¸ºã€‚</p> <p><code>è¡Œä¸ºå‚æ•°åŒ–æ¨¡ç³Šæ€§</code>ï¼šåœ¨æŸç§éœ€æ±‚ä¸­ï¼Œç¼–è¯‘å™¨å¹¶ä¸æ€»æ˜¯å¯ä»¥æ¨æ–­å‡ºlambdaè¡¨è¾¾å¼çš„ç±»å‹ï¼Œä¾‹å¦‚å°†lambdaè¡¨è¾¾å¼ä¼ é€’ç»™ä¸€ä¸ªé‡è½½æ–¹æ³•ç­‰ã€‚</p> <p>åœ¨Demoç±»ä¸­å®šä¹‰äº†ä¸€ä¸ªengineé‡è½½æ–¹æ³•ã€‚å½“æˆ‘ä»¬ä¼å›¾é€šè¿‡lambdaè¡¨è¾¾å¼å»è°ƒç”¨æŒ‡å®šæ–¹æ³•æ—¶ï¼Œç¼–è¯‘å™¨ç›´æ¥æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å¤§æ¦‚æ„æ€å°±æ˜¯ç¼–è¯‘å™¨ä¸çŸ¥é“è¯¥å»è°ƒç”¨å“ªä¸€ä¸ªæ–¹æ³•ï¼Œå­˜åœ¨æ­§ä¹‰ã€‚</p> <p><img src="assets%5C1670453141904.png" alt="1670453141904"></p> <blockquote><p>è§£å†³æ­§ä¹‰çš„ä¸‰ç§æ–¹æ³•ï¼š</p> <ol><li>å¼ºåˆ¶è½¬æ¢lambdaè¡¨è¾¾ç¤º</li> <li>äº‹å…ˆå°†lambdaè¡¨è¾¾ç¤ºåˆ†é…ç»™ä¸€ä¸ªå‡½æ•°æ¥å£</li> <li>æ˜¾ç¤ºæŒ‡å®šå‚æ•°ç±»å‹ï¼›</li></ol></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@FunctionalInterface</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IntCalculator</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@FunctionalInterface</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">LongCalculator</span> <span class="token punctuation">{</span>
    <span class="token keyword">long</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">long</span> x<span class="token punctuation">,</span> <span class="token keyword">long</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> argv<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// engine(((x, y) -&gt; x + y));</span>
        <span class="token comment">//æ–¹æ³•1ï¼šé€šè¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢è§£å†³æ­§ä¹‰</span>
        <span class="token function">engine</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">IntCalculator</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token operator">-&gt;</span>x<span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ–¹æ³•2ï¼šäº‹å…ˆå°†lambdaè¡¨è¾¾ç¤ºåˆ†é…ä¸€ä¸ªå‡½æ•°æ¥å£è§£å†³æ­§ä¹‰</span>
        <span class="token class-name">LongCalculator</span> lc <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> x <span class="token operator">*</span> y<span class="token punctuation">;</span>
        <span class="token function">engine</span><span class="token punctuation">(</span>lc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ–¹æ³•3ï¼šé€šè¿‡æŒ‡å®šlambdaè¡¨è¾¾ç¤ºå‚æ•°ç±»å‹è§£å†³æ­§ä¹‰</span>
        <span class="token function">engine</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> x <span class="token operator">/</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">engine</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">long</span> x<span class="token punctuation">,</span> <span class="token keyword">long</span> y<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> x <span class="token operator">%</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">engine</span><span class="token punctuation">(</span><span class="token class-name">IntCalculator</span> ic<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> result <span class="token operator">=</span> ic<span class="token punctuation">.</span><span class="token function">calc</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">engine</span><span class="token punctuation">(</span><span class="token class-name">LongCalculator</span> lc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">long</span> x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> result <span class="token operator">=</span> lc<span class="token punctuation">.</span><span class="token function">calc</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="lambdaè¡¨è¾¾å¼ä¸Šä¸‹æ–‡"><a href="#lambdaè¡¨è¾¾å¼ä¸Šä¸‹æ–‡" class="header-anchor">#</a> Lambdaè¡¨è¾¾å¼ä¸Šä¸‹æ–‡</h2> <p>lambdaè¡¨è¾¾å¼çš„ä¸Šä¸‹æ–‡åˆ†ä¸ºèµ‹å€¼ä¸Šä¸‹æ–‡ã€æ–¹æ³•è°ƒç”¨ä¸Šä¸‹æ–‡ã€è¿”å›ä¸Šä¸‹æ–‡ã€è½¬æ¢ä¸Šä¸‹æ–‡4ç§ï¼š</p> <ul><li><strong>èµ‹å€¼ä¸Šä¸‹æ–‡</strong>ï¼šlambdaè¡¨è¾¾å¼åœ¨èµ‹å€¼è¿ç®—ç¬¦çš„å³ä¾§ï¼Œä½œä¸ºå€¼èµ‹å€¼ç»™æŒ‡å®šå˜é‡ï¼›</li> <li><strong>æ–¹æ³•è°ƒç”¨ä¸Šä¸‹æ–‡</strong>ï¼šå°†lambdaè¡¨è¾¾å¼ä½œä¸ºå‚æ•°ä¼ é€’åˆ°å¦ä¸€ä¸ªæ–¹æ³•ä¸­ï¼›</li> <li><strong>è¿”å›ä¸Šä¸‹æ–‡</strong>ï¼šreturnä¸€ä¸ªlambdaè¡¨è¾¾ç¤ºï¼›</li> <li><strong>è½¬æ¢ä¸Šä¸‹æ–‡</strong>ï¼šå°†lambdaè¡¨è¾¾ç¤ºå¼ºåˆ¶è½¬æ¢æˆæŒ‡å®šç±»å‹ï¼›</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@FunctionalInterface</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Calculator</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 1ã€èµ‹å€¼ä¸Šä¸‹æ–‡</span>
        <span class="token class-name">Calculator</span> c <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">calc</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2ã€æ–¹æ³•è°ƒç”¨ä¸Šä¸‹æ–‡</span>
        <span class="token function">engine</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> a <span class="token operator">*</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 3ã€è¿”å›ä¸Šä¸‹æ–‡</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">calc</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 4ã€è½¬æ¢ä¸Šä¸‹æ–‡</span>
        <span class="token function">engine</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Calculator</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Calculator</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> a <span class="token operator">/</span> b<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">engine</span><span class="token punctuation">(</span><span class="token class-name">Calculator</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">calc</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="lambdaè¡¨è¾¾å¼çš„ä½œç”¨åŸŸ"><a href="#lambdaè¡¨è¾¾å¼çš„ä½œç”¨åŸŸ" class="header-anchor">#</a> Lambdaè¡¨è¾¾å¼çš„ä½œç”¨åŸŸ</h2> <p>Lambdaè¡¨è¾¾å¼<code>ä¸å®šä¹‰è‡ªå·±çš„èŒƒå›´</code>ã€‚</p> <blockquote><p>tipï¼š</p> <ol><li>lambdaè¡¨è¾¾å¼ä¸­çš„thisä»£è¡¨å¤–éƒ¨ç±»ï¼›</li> <li>åœ¨lambdaè¡¨è¾¾ç¤ºä¸­çš„thisæˆ–superè¡¨è¾¾å¼éƒ½ä»£æŒ‡å¤–éƒ¨ç±»ï¼›</li></ol></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Scope</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Scope</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// int x = 0; // è¿™æ¡è¯­å¥ä¸lambdaè¡¨è¾¾ç¤ºå˜é‡å®šä¹‰å†²çªï¼Œä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯</span>
        <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f <span class="token operator">=</span> x <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// lambdaè¡¨è¾¾ç¤ºä¸­çš„thisã€superè¡¨è¾¾å¼éƒ½ä»£æŒ‡å¤–éƒ¨ç±», ä¹Ÿå°±æ˜¯Scopeç±»</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;this: &quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;super: &quot;</span> <span class="token operator">+</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> x<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">Scope</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æµ‹è¯•ç»“æœï¼š</p> <p><img src="assets%5C1670455067865.png" alt="1670455067865"></p> <h2 id="lambdaè¡¨è¾¾å¼å˜é‡æ•è·"><a href="#lambdaè¡¨è¾¾å¼å˜é‡æ•è·" class="header-anchor">#</a> Lambdaè¡¨è¾¾å¼å˜é‡æ•è·</h2> <blockquote><p>tipï¼š</p> <ol><li>lambdaè¡¨è¾¾å¼å¯ä»¥ç›´æ¥è®¿é—®finalä¿®é¥°çš„å˜é‡ã€‚</li> <li>lambdaè¡¨è¾¾å¼å¯ä»¥ç›´æ¥è®¿é—®åªåˆå§‹åŒ–ä¸€æ¬¡çš„å˜é‡ã€‚</li> <li>å…¨å±€å˜é‡å¯ä»¥åœ¨ä»»æ„lambdaè¡¨è¾¾å¼ä¸­ä½¿ç”¨ã€‚</li> <li>è¯•å›¾æ”¹å˜åœ¨lambdaè¡¨è¾¾å¼ä¹‹å¤–å®šä¹‰çš„å€¼ï¼Œä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚</li></ol></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>
    <span class="token comment">// å…¨å±€å˜é‡</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> argv<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">final</span> <span class="token class-name">String</span> b <span class="token operator">=</span> <span class="token string">&quot;LML&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">// å˜é‡cåªåˆå§‹åŒ–äº†ä¸€æ¬¡ï¼Œæ˜¯å¯ä»¥åœ¨lambdaè¡¨è¾¾ç¤ºç›´æ¥ä½¿ç”¨çš„</span>
        <span class="token class-name">String</span> c <span class="token operator">=</span> <span class="token string">&quot;DuduDream&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> d <span class="token operator">=</span> <span class="token string">&quot;Dudu&quot;</span><span class="token punctuation">;</span>
        d <span class="token operator">+=</span> <span class="token string">&quot;Dream&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> func1 <span class="token operator">=</span> x <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// å¦‚æœè¯•å›¾æ”¹å˜åœ¨lambdaè¡¨è¾¾å¼ä¹‹å¤–å®šä¹‰çš„å€¼, ç¼–è¯‘é”™è¯¯</span>
            <span class="token comment">// Variable used in lambda expression should be final or effectively final</span>
            <span class="token comment">// c = &quot;AiTao&quot;;</span>
            a <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token comment">// lambdaè¡¨è¾¾å¼ä¸­æ— æ³•ç›´æ¥ä½¿ç”¨å˜é‡d, ç¼–è¯‘é”™è¯¯</span>
            <span class="token comment">// return x + &quot; &quot; + a + &quot; &quot; + b + &quot; &quot; + c + &quot; &quot; + d;</span>
            <span class="token keyword">return</span> x <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> a <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> b <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> c<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> func2 <span class="token operator">=</span> y <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            a <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> y <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> a<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;func1:&quot;</span> <span class="token operator">+</span> func1<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token string">&quot;AiTao&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;func2:&quot;</span> <span class="token operator">+</span> func2<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token string">&quot;DuduDream&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="lambdaçš„ä¸»ä½“è¯­å¥"><a href="#lambdaçš„ä¸»ä½“è¯­å¥" class="header-anchor">#</a> Lambdaçš„ä¸»ä½“è¯­å¥</h2> <p>å¯ä»¥åœ¨lambdaè¡¨è¾¾å¼ä¸»ä½“ä¸­ä½¿ç”¨<code>break</code>ã€<code>continue</code>ã€<code>return</code>ã€<code>throw</code>è¯­å¥ï¼Œä¸èƒ½ä½¿ç”¨è·³è½¬è¯­å¥åšéå±€éƒ¨è·³è½¬ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo_14_</span>ä¸»ä½“è¯­å¥ <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f <span class="token operator">=</span> x <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">//åªè·³å‡ºå½“å‰å¾ªç¯ï¼Œå¹¶æœªè·³å‡ºå½“å‰lambdaè¡¨è¾¾ç¤ºèŒƒå›´</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> x<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token string">&quot;Akor&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f2 <span class="token operator">=</span> y <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                    <span class="token comment">//break; ç¼–è¯‘æ—¶æŠ¥é”™ï¼Œè¿™æ¡è¯­å¥è¯•å›¾è·³å‡ºå½“å‰lambdaè¡¨è¾¾ç¤ºè¯­å¥</span>
                    <span class="token keyword">return</span> y <span class="token operator">+</span> <span class="token string">&quot; World!!&quot;</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>f2<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="é€’å½’lambdaè¡¨è¾¾å¼"><a href="#é€’å½’lambdaè¡¨è¾¾å¼" class="header-anchor">#</a> é€’å½’Lambdaè¡¨è¾¾å¼</h2> <p>ä½¿ç”¨é€’å½’å‡½æ•°ä½œä¸ºæ–¹æ³•å¼•ç”¨æ¥åˆ›å»ºlambdaè¡¨è¾¾å¼ã€‚æœ€åçš„lambdaè¡¨è¾¾å¼æˆä¸ºé€’å½’ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">IntFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> factorialCalc <span class="token operator">=</span> <span class="token class-name">Main</span><span class="token operator">::</span><span class="token function">factorial</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>factorialCalc<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">long</span> <span class="token function">factorial</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> n <span class="token operator">*</span> <span class="token function">factorial</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="â­lambdaåº•å±‚åŸç†"><a href="#â­lambdaåº•å±‚åŸç†" class="header-anchor">#</a> â­Lambdaåº•å±‚åŸç†</h2> <h1 id="å‡½æ•°å¼æ¥å£"><a href="#å‡½æ•°å¼æ¥å£" class="header-anchor">#</a> å‡½æ•°å¼æ¥å£</h1> <p>å®šä¹‰ï¼šåªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ç§°ä¸ºå‡½æ•°å¼æ¥å£ã€‚</p> <blockquote><p>æ³¨ï¼šä¸èƒ½ä½¿ç”¨ä»¥ä¸‹ç±»å‹çš„æ–¹æ³•æ¥å£°æ˜ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼š</p> <ul><li>é»˜è®¤æ–¹æ³•</li> <li>é™æ€æ–¹æ³•</li> <li>ä»Objectç±»ç»§æ‰¿çš„æ–¹æ³•</li></ul></blockquote> <p><code>ä¸€ä¸ªå‡½æ•°å¼æ¥å£å¯ä»¥é‡æ–°å£°æ˜Objectç±»ä¸­çš„æ–¹æ³•</code>ã€‚è¯¥æ–¹æ³•ä¸è¢«è§†ä¸ºæŠ½è±¡æ–¹æ³•ã€‚Comparatoræ¥å£æœ‰ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•ï¼šcompareå’Œequalsã€‚equalsæ–¹æ³•æ˜¯Objectç±»ä¸­çš„equalsæ–¹æ³•çš„é‡æ–°å£°æ˜ï¼Œå¦‚æœä¸‹æ‰€ç¤ºï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@FunctionalInterface</span>
<span class="token keyword">interface</span> <span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token class-name">T</span> o1<span class="token punctuation">,</span> <span class="token class-name">T</span> o2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="functionalinterface"><a href="#functionalinterface" class="header-anchor">#</a> @FunctionalInterface</h2> <p>@FunctionalInterface æ ‡è¯†æ³¨è§£å®šä¹‰åœ¨==java.langåŒ…==ï¼Œä½¿ç”¨å®ƒæ¥æ ‡è®°ä¸€ä¸ªæ¥å£æ˜¯å‡½æ•°å¼æ¥å£ã€‚</p> <p>==æ³¨ï¼šè‹¥ @FunctionalInterface æ ‡è®°åœ¨éå‡½æ•°å¼æ¥å£æˆ–å…¶ä»–ç±»å‹ï¼ˆå¦‚ç±»ï¼‰ä¸Šï¼Œåˆ™ä¼šå‘ç”Ÿç¼–è¯‘é”™è¯¯ã€‚==</p> <h2 id="é€šç”¨å‡½æ•°å¼æ¥å£"><a href="#é€šç”¨å‡½æ•°å¼æ¥å£" class="header-anchor">#</a> é€šç”¨å‡½æ•°å¼æ¥å£</h2> <p>ä½¿ç”¨ç±»å‹å‚æ•°ä¸å‡½æ•°å¼æ¥å£å®šä¹‰é€šç”¨å‡½æ•°å¼æ¥å£ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">interface</span> <span class="token class-name">Calculator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">T</span> a<span class="token punctuation">,</span> <span class="token class-name">T</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä½¿ç”¨æŠ½è±¡é€šç”¨æ–¹æ³•å®šä¹‰éé€šç”¨å‡½æ•°å¼æ¥å£ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@FunctionalInterface</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Processor</span> <span class="token punctuation">{</span>
   <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="java-util-functionåŒ…"><a href="#java-util-functionåŒ…" class="header-anchor">#</a> java.util.functionåŒ…</h2> <p>å‡½æ•°å¼æ¥å£ä¸»è¦åˆ†ä¸º<code>Supplierr</code>æä¾›å‹å‡½æ•°ã€<code>Consumer</code>æ¶ˆè´¹å‹å‡½æ•°ã€<code>Runnable</code>æ— å‚æ— è¿”å›å‹å‡½æ•°ã€<code>Function</code>æœ‰å‚æœ‰è¿”å›å‹å‡½æ•°ï¼Œå®ƒä»¬ä¸»è¦å®šä¹‰åœ¨<code>java.util.functionåŒ…</code>ä¸­ï¼Œå…±æœ‰43ç§å‡½æ•°å¼æ¥å£ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p> <p><img src="assets%5Cb914d6ca0dbbb3830f9e3d8e1b46f61d.png" alt="img"></p> <h3 id="function-t-r"><a href="#function-t-r" class="header-anchor">#</a> Function&lt;T,R&gt;</h3> <p>ä½œç”¨ï¼šæ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>T</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>R</code>çš„å‡½æ•°ã€‚</p> <p>Function&lt;T,R&gt;æ¥å£çš„å˜ç§ï¼š</p> <table><thead><tr><th>å‡½æ•°å¼æ¥å£</th> <th>ä½œç”¨</th></tr></thead> <tbody><tr><td>IntFunction<R></R></td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>int</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>R</code>çš„å‡½æ•°ã€‚</td></tr> <tr><td>LongFunction<R></R></td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>long</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>R</code>çš„å‡½æ•°ã€‚</td></tr> <tr><td>DoubleFunciton<R></R></td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>double</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>R</code>çš„å‡½æ•°ã€‚</td></tr> <tr><td>IntToDoubleFunction</td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>int</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>double</code>çš„å‡½æ•°ã€‚</td></tr> <tr><td>IntToLongFunction</td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>int</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>long</code>çš„å‡½æ•°ã€‚</td></tr> <tr><td>LongToDoubleFunction</td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>long</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>double</code>çš„å‡½æ•°ã€‚</td></tr> <tr><td>LongToIntFunction</td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>long</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>int</code>çš„å‡½æ•°ã€‚</td></tr> <tr><td>DoubleToIntFunction</td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>double</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>int</code>çš„å‡½æ•°ã€‚</td></tr> <tr><td>DoubleToLongFunction</td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>double</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>long</code>çš„å‡½æ•°ã€‚</td></tr> <tr><td>ToIntFunction<T></T></td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>T</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>int</code>çš„å‡½æ•°ã€‚</td></tr> <tr><td>ToLongFunction<T></T></td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>T</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>long</code>çš„å‡½æ•°ã€‚</td></tr> <tr><td>ToDoubleFunction<T></T></td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>T</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>double</code>çš„å‡½æ•°ã€‚</td></tr></tbody></table> <p>æ–¹æ³•æè¿°ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸ºTï¼Œè¿”å›ç»“æœä¸ºRçš„å‡½æ•°</span>
<span class="token class-name">R</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token class-name">T</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//åˆ›å»ºä¸€ä¸ªFunction,è°ƒç”¨å½“å‰å‡½æ•°å’ŒæŒ‡å®šçš„å‡½æ•°åå¾—åˆ°ç»“æœ</span>
<span class="token keyword">default</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token function">andThen</span><span class="token punctuation">(</span><span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span>  <span class="token class-name">R</span><span class="token punctuation">,</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> after<span class="token punctuation">)</span>
<span class="token comment">//åˆ›å»ºä¸€ä¸ªFunction,è¯¥å‡½æ•°è°ƒç”¨æŒ‡å®šçš„å‡½æ•°ï¼Œç„¶åè°ƒç”¨å½“å‰å‡½æ•°å¹¶è¿”å›ç»“æœ</span>
<span class="token keyword">default</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">,</span><span class="token class-name">R</span><span class="token punctuation">&gt;</span></span> <span class="token function">compose</span><span class="token punctuation">(</span><span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span>  <span class="token class-name">V</span><span class="token punctuation">,</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> before<span class="token punctuation">)</span>
<span class="token comment">//åˆ›å»ºä¸€ä¸ªè¿”å›å…¶å‚æ•°çš„å‡½æ•°</span>
<span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">identity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="bifunction-t-u-r"><a href="#bifunction-t-u-r" class="header-anchor">#</a> BiFunction&lt;T,U,R&gt;</h3> <p>ä½œç”¨ï¼šæ¥å—å‚æ•°åˆ—è¡¨ç±»å‹åˆ†åˆ«ä¸º<code>T</code>ï¼Œ<code>U</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>R</code>çš„å‡½æ•°ã€‚</p> <p>BiFunction&lt;T,U,R&gt;æ¥å£çš„å˜ç§ï¼š</p> <table><thead><tr><th>å‡½æ•°å¼æ¥å£</th> <th>ä½œç”¨</th> <th>æŠ½è±¡æ–¹æ³•</th></tr></thead> <tbody><tr><td>ToIntBiFunction&lt;T,U&gt;</td> <td>æ¥å—å‚æ•°åˆ—è¡¨ç±»å‹åˆ†åˆ«ä¸º<code>T</code>ï¼Œ<code>U</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>int</code>çš„å‡½æ•°ã€‚</td> <td>int applyAsInt(T t, U u);</td></tr> <tr><td>ToLongBiFunction&lt;T,U&gt;</td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>long</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>long</code>çš„å‡½æ•°ã€‚</td> <td>long applyAsLong(T t, U u);</td></tr> <tr><td>ToDoubleBiFunction&lt;T,U&gt;</td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>long</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>double</code>çš„å‡½æ•°ã€‚</td> <td>double applyAsDouble(T t, U u);</td></tr></tbody></table> <h3 id="predicate"><a href="#predicate" class="header-anchor">#</a> Predicate<T></T></h3> <p>ä½œç”¨ï¼šæ¥å—ç±»å‹Tçš„å‚æ•°ï¼Œè¿”å›<code>true</code>æˆ–<code>false</code>çš„å¸ƒå°”ç±»å‹ã€‚</p> <p>Predicate<T>æ¥å£çš„å˜ç§ï¼š</T></p> <table><thead><tr><th>å‡½æ•°å¼æ¥å£</th> <th>ä½œç”¨</th></tr></thead> <tbody><tr><td>IntPredicate</td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>int</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>R</code>çš„å‡½æ•°ã€‚</td></tr> <tr><td>LongPredicate</td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>long</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>R</code>çš„å‡½æ•°ã€‚</td></tr> <tr><td>DoublePredicate</td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>double</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>R</code>çš„å‡½æ•°ã€‚</td></tr></tbody></table> <p>æ–¹æ³•æè¿°ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//å¯¹ç»™å®šçš„å‚æ•°è®¡ç®—æ­¤è°“è¯ã€‚</span>
<span class="token keyword">boolean</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token class-name">T</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//å¦å®šåŸå§‹è°“è¯çš„è°“è¯</span>
<span class="token keyword">default</span>  <span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">negate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//ç»„åˆä¸¤ä¸ªå…·æœ‰çŸ­è·¯é€»è¾‘andçš„è°“è¯</span>
<span class="token keyword">default</span>  <span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">and</span><span class="token punctuation">(</span><span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> other<span class="token punctuation">)</span>
<span class="token comment">//ç»„åˆäº†å…·æœ‰çŸ­è·¯é€»è¾‘æˆ–çš„ä¸¤ä¸ªè°“è¯</span>
<span class="token keyword">default</span>  <span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">or</span><span class="token punctuation">(</span><span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span>  <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> other<span class="token punctuation">)</span>
<span class="token comment">//è¿”å›ä¸€ä¸ªè°“è¯ï¼Œæ ¹æ®Objects.equals(Objectï¼ŒObject)æµ‹è¯•ä¸¤ä¸ªå‚æ•°æ˜¯å¦ç›¸ç­‰</span>
<span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">isEqual</span><span class="token punctuation">(</span><span class="token class-name">Object</span>  targetRef<span class="token punctuation">)</span>
</code></pre></div><p>ä¾‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo_06_Predicate</span>æ¥å£ <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//åˆ¤æ–­numå€¼æ˜¯å¦å¤§äº2</span>
        <span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> p1 <span class="token operator">=</span> <span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token operator">-&gt;</span> num <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//åˆ¤æ–­strå­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦å¤§äº0ä¸”å°äº10</span>
        <span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> p2 <span class="token operator">=</span> <span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token operator">-&gt;</span>str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> p3 <span class="token operator">=</span> <span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token operator">-&gt;</span>str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span>p3<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;hello world!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="bipredicate-t-u"><a href="#bipredicate-t-u" class="header-anchor">#</a> BiPredicate&lt;T,U&gt;</h3> <p>ä½œç”¨ï¼šæ¥å—äºŒä¸ªå‚æ•°ï¼Œå‚æ•°ç±»å‹åˆ†åˆ«æ˜¯<code>T</code>å’Œ<code>U</code>ï¼Œè¿”å›ç»“æœä¸º<code>å¸ƒå°”ç±»å‹</code>çš„å‡½æ•°ã€‚</p> <h3 id="consumer"><a href="#consumer" class="header-anchor">#</a> Consumer<T></T></h3> <p>ä½œç”¨ï¼šæ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>T</code>ï¼Œæ— è¿”å›ç»“æœçš„å‡½æ•°ã€‚</p> <p><img src="assets%5C1666706906138.png" alt="1666706906138"></p> <p>Consumer<T>æ¥å£çš„å˜ç§ï¼š</T></p> <table><thead><tr><th>å‡½æ•°å¼æ¥å£</th> <th>ä½œç”¨</th></tr></thead> <tbody><tr><td>IntConsumer</td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>int</code>ï¼Œæ— è¿”å›ç»“æœçš„å‡½æ•°ã€‚</td></tr> <tr><td>LongConsumer</td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>long</code>ï¼Œæ— è¿”å›ç»“æœçš„å‡½æ•°ã€‚</td></tr> <tr><td>DoubleConsumer</td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>double</code>ï¼Œæ— è¿”å›ç»“æœçš„å‡½æ•°ã€‚</td></tr> <tr><td>ObjIntConsumer<T></T></td> <td>æ¥å—äºŒä¸ªå‚æ•°ï¼Œå‚æ•°ç±»å‹åˆ†åˆ«ä¸º<code>T</code>ã€<code>int</code>ï¼Œæ— è¿”å›ç»“æœçš„å‡½æ•°ã€‚</td></tr> <tr><td>ObjLongConsumer<T></T></td> <td>æ¥å—äºŒä¸ªå‚æ•°ï¼Œå‚æ•°ç±»å‹åˆ†åˆ«ä¸º<code>T</code>ã€<code>long</code>ï¼Œæ— è¿”å›ç»“æœçš„å‡½æ•°ã€‚</td></tr> <tr><td>ObjDoubleConsumer<T></T></td> <td>æ¥å—äºŒä¸ªå‚æ•°ï¼Œå‚æ•°ç±»å‹åˆ†åˆ«ä¸º<code>T</code>ã€<code>double</code>ï¼Œæ— è¿”å›ç»“æœçš„å‡½æ•°ã€‚</td></tr></tbody></table> <h3 id="biconsumer-t-u"><a href="#biconsumer-t-u" class="header-anchor">#</a> BiConsumer&lt;T,U&gt;</h3> <p>ä½œç”¨ï¼šæ¥å—ç±»å‹Tï¼ŒUçš„ä¸¤ä¸ªæŒ‡å®šå‚æ•°ï¼Œä¸è¿”å›ç»“æœã€‚</p> <h3 id="supplier"><a href="#supplier" class="header-anchor">#</a> Supplier<T></T></h3> <p>å®šä¹‰ï¼šSupplieræ¥å£ä¹Ÿæ˜¯ç”¨æ¥åˆ›å»ºå¯¹è±¡çš„ï¼Œä½†æ˜¯ä¸åŒäº <code>new</code> ï¼Œé€šè¿‡è°ƒç”¨ get æ–¹æ³•é—´æ¥è°ƒç”¨æ„é€ æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ã€‚</p> <p>ä½œç”¨ï¼šæ¥å—ä¸€ä¸ªæ— å‚åˆ—è¡¨ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>T</code>çš„å‡½æ•°ã€‚</p> <p>Supplier<T>æ¥å£çš„å˜ç§ï¼š</T></p> <table><thead><tr><th>å‡½æ•°å¼æ¥å£</th> <th>ä½œç”¨</th></tr></thead> <tbody><tr><td>IntSupplier</td> <td>æ¥å—ä¸€ä¸ªæ— å‚åˆ—è¡¨ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>int</code>çš„å‡½æ•°ã€‚</td></tr> <tr><td>LongSupplier</td> <td>æ¥å—ä¸€ä¸ªæ— å‚åˆ—è¡¨ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>long</code>çš„å‡½æ•°ã€‚</td></tr> <tr><td>DoubleSupplier</td> <td>æ¥å—ä¸€ä¸ªæ— å‚åˆ—è¡¨ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>double</code>çš„å‡½æ•°ã€‚</td></tr> <tr><td>BooleanSupplier</td> <td>æ¥å—ä¸€ä¸ªæ— å‚åˆ—è¡¨ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>boolean</code>çš„å‡½æ•°ã€‚</td></tr></tbody></table> <p>ä¾‹1ï¼š</p> <h3 id="unaryoperator"><a href="#unaryoperator" class="header-anchor">#</a> UnaryOperator<T></T></h3> <p>ä½œç”¨ï¼šæ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>T</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>T</code>çš„å‡½æ•°ã€‚</p> <p>UnaryOperatorå‡½æ•°å¼æ¥å£ç»§æ‰¿è‡ªFunctionå‡½æ•°å¼æ¥å£ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p> <p><img src="assets%5C1666705863995.png" alt="1666705863995"></p> <p>UnaryOperator<T>æ¥å£çš„å˜ç§ï¼š</T></p> <table><thead><tr><th>å‡½æ•°å¼æ¥å£</th> <th>ä½œç”¨</th></tr></thead> <tbody><tr><td>IntUnaryOperator</td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>int</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>int</code>çš„å‡½æ•°ã€‚</td></tr> <tr><td>LongUnaryOperator</td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>long</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>long</code>çš„å‡½æ•°ã€‚</td></tr> <tr><td>DoubleUnaryOperator</td> <td>æ¥å—ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>double</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>double</code>çš„å‡½æ•°ã€‚</td></tr></tbody></table> <p>ä¾‹1ï¼šæ±‚ä¸¤ä¸ªæ•°çš„æœ€å¤§å€¼</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">UnaryOperator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> unaryOperator <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> x<span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>unaryOperator<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="binaryoperator"><a href="#binaryoperator" class="header-anchor">#</a> BinaryOperator<T></T></h3> <p>ä½œç”¨ï¼šæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œå‚æ•°ç±»å‹éƒ½ä¸º<code>T</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>T</code>çš„å‡½æ•°ã€‚</p> <p>BinaryOperatorå‡½æ•°å¼æ¥å£ç»§æ‰¿è‡ªBiFunctionæ¥å£ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p> <p><img src="assets%5C1666705691174.png" alt="1666705691174"></p> <p>BinaryOperator<T>æ¥å£çš„å˜ç§ï¼š</T></p> <table><thead><tr><th>å‡½æ•°å¼æ¥å£</th> <th>ä½œç”¨</th></tr></thead> <tbody><tr><td>IntBinaryOperator</td> <td>æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œå‚æ•°ç±»å‹éƒ½ä¸º<code>int</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>int</code>çš„å‡½æ•°ã€‚</td></tr> <tr><td>LongBinaryOperator</td> <td>æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œå‚æ•°ç±»å‹éƒ½ä¸º<code>long</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>long</code>çš„å‡½æ•°ã€‚</td></tr> <tr><td>DoubleBinaryOperator</td> <td>æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œå‚æ•°ç±»å‹éƒ½ä¸º<code>double</code>ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>double</code>çš„å‡½æ•°ã€‚</td></tr></tbody></table> <p>ä¾‹1ï¼šæ±‚ä¸¤ä¸ªæ•°çš„æœ€å¤§å€¼</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">BinaryOperator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> bo <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> a <span class="token operator">&gt;</span> b <span class="token operator">?</span> a <span class="token operator">:</span> b<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token comment">//ç­‰ä»·äºbo</span>
        <span class="token class-name">BinaryOperator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> binaryOperator <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token operator">::</span><span class="token function">max</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>bo<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>binaryOperator<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="äº¤å‰ç±»å‹"><a href="#äº¤å‰ç±»å‹" class="header-anchor">#</a> äº¤å‰ç±»å‹</h2> <p>Java 8å¼•å…¥äº†ä¸€ç§ç§°ä¸ºäº¤é›†ç±»å‹çš„æ–°ç±»å‹ã€‚äº¤å‰ç±»å‹æ˜¯å¤šç§ç±»å‹çš„äº¤å‰ã€‚ä¸¤ç§ç±»å‹ä¹‹é—´ä½¿ç”¨<code>Type1 &amp; Type2</code>ï¼Œä»¥è¡¨ç¤ºç±»å‹1ï¼Œç±»å‹2çš„äº¤é›†çš„æ–°ç±»å‹ã€‚</p> <p><strong>æ³¨ï¼šäº¤å‰ç±»å‹æ˜¯è§£å†³lambdaè¡¨è¾¾å¼ä¸èƒ½ç›´æ¥èµ‹å€¼éå‡½æ•°å¼æ¥å£ç±»å‹çš„ä¸€ç§æ–¹å¼</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo_05_</span>äº¤å‰ç±»å‹ <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//ä¸ºåˆ›å»ºä¸€ä¸ªlambdaè¡¨è¾¾å¼å¹¶èµ‹å€¼ç»™éå‡½æ•°å¼æ¥å£ NonFunction ç±»å‹ï¼Œå¯ä½¿ç”¨ &amp; æ¥åˆ›å»ºæ–°çš„å­ç±»å‹ï¼ˆäº¤å‰ç±»å‹ï¼‰ã€‚</span>
        <span class="token class-name">NoFunction</span> noFunction <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">NoFunction</span> <span class="token operator">&amp;</span> <span class="token class-name">Calculator</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> a <span class="token operator">*</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>noFunction<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//ä»¥è¿™ç§æ–¹å¼ï¼Œå¯ä»¥ä½¿ä¸€ä¸ªlambdaè¡¨è¾¾å¼å¯åºåˆ—åŒ–</span>
        <span class="token class-name">Serializable</span> serializable <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Serializable</span> <span class="token operator">&amp;</span> <span class="token class-name">Calculator</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> a <span class="token operator">-</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@FunctionalInterface</span>
    <span class="token keyword">interface</span> <span class="token class-name">Calculator</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//éå‡½æ•°å¼æ¥å£</span>
    <span class="token keyword">interface</span> <span class="token class-name">NoFunction</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h1 id="é»˜è®¤æ–¹æ³•"><a href="#é»˜è®¤æ–¹æ³•" class="header-anchor">#</a> é»˜è®¤æ–¹æ³•</h1> <p>Java 8 æ–°å¢äº†æ¥å£çš„é»˜è®¤æ–¹æ³•ã€‚å®ƒå¯ä»¥åœ¨æ¥å£æœ‰å®ç°æ–¹æ³•ï¼Œè€Œä¸”ä¸éœ€è¦å®ç°ç±»å»å®ç°å…¶æ–¹æ³•ã€‚</p> <p>åªéœ€åœ¨æ–¹æ³•åå‰æ·»åŠ <strong>defaultå…³é”®å­—</strong>å³å¯å®ç°é»˜è®¤æ–¹æ³•ã€‚</p> <blockquote><p><strong>ä¸ºä»€ä¹ˆè¦æœ‰è¿™ä¸ªç‰¹æ€§ï¼Ÿ</strong></p> <p>é¦–å…ˆï¼Œä¹‹å‰çš„æ¥å£æ˜¯ä¸ªåŒåˆƒå‰‘ï¼Œå¥½å¤„æ˜¯é¢å‘æŠ½è±¡è€Œä¸æ˜¯é¢å‘å…·ä½“ç¼–ç¨‹ï¼Œç¼ºé™·æ˜¯ï¼Œå½“éœ€è¦ä¿®æ”¹æ¥å£æ—¶å€™ï¼Œéœ€è¦ä¿®æ”¹å…¨éƒ¨å®ç°è¯¥æ¥å£çš„ç±»ï¼Œç›®å‰çš„java 8ä¹‹å‰çš„é›†åˆæ¡†æ¶æ²¡æœ‰foreachæ–¹æ³•ï¼Œé€šå¸¸èƒ½æƒ³åˆ°çš„è§£å†³åŠæ³•æ˜¯åœ¨JDKé‡Œç»™ç›¸å…³çš„æ¥å£æ·»åŠ æ–°çš„æ–¹æ³•åŠå®ç°ã€‚ç„¶è€Œï¼Œå¯¹äºå·²ç»å‘å¸ƒçš„ç‰ˆæœ¬ï¼Œæ˜¯æ²¡æ³•åœ¨ç»™æ¥å£æ·»åŠ æ–°æ–¹æ³•çš„åŒæ—¶ä¸å½±å“å·²æœ‰çš„å®ç°ã€‚æ‰€ä»¥å¼•è¿›çš„é»˜è®¤æ–¹æ³•ã€‚ä»–ä»¬çš„ç›®çš„æ˜¯ä¸ºäº†è§£å†³æ¥å£çš„ä¿®æ”¹ä¸ç°æœ‰çš„å®ç°ä¸å…¼å®¹çš„é—®é¢˜ã€‚</p></blockquote> <h2 id="é»˜è®¤æ–¹æ³•å†²çª"><a href="#é»˜è®¤æ–¹æ³•å†²çª" class="header-anchor">#</a> é»˜è®¤æ–¹æ³•å†²çª</h2> <p>å½“ä¸€ä¸ªç±»å®ç°å¤šä¸ªæ¥å£æ—¶ï¼Œè‹¥è¿™äº›æ¥å£æœ‰ç›¸åŒçš„é»˜è®¤æ–¹æ³•ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°é»˜è®¤æ–¹æ³•å†²çªé—®é¢˜ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Car</span> <span class="token punctuation">{</span>
   <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æˆ‘æ˜¯ä¸€è¾†è½¦!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">WaterCar</span> <span class="token punctuation">{</span>
   <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æˆ‘æ˜¯ä¸€è¾†æ°´è½¦!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è§£å†³æ–¹å¼ä¸€ï¼šåœ¨å®ç°ç±»ä¸­overrideé»˜è®¤æ–¹æ³•ï¼›</p> <p>è§£å†³æ–¹å¼äºŒï¼šé€šè¿‡superå…³é”®å­—åœ¨å®ç°ç±»ä¸­è°ƒç”¨æŒ‡å®šæ¥å£ä¸­çš„é»˜è®¤æ–¹æ³•</p> <h2 id="é™æ€é»˜è®¤æ–¹æ³•"><a href="#é™æ€é»˜è®¤æ–¹æ³•" class="header-anchor">#</a> é™æ€é»˜è®¤æ–¹æ³•</h2> <p>java8ä¹‹åï¼Œæ¥å£å¯ä»¥å£°æ˜ï¼ˆå¹¶ä¸”å¯ä»¥æä¾›å®ç°ï¼‰é™æ€æ–¹æ³•ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Car</span> <span class="token punctuation">{</span>
   <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æˆ‘æ˜¯ä¸€è¾†è½¦!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
	<span class="token comment">//é™æ€é»˜è®¤æ–¹æ³•</span>
   <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">blowHorn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æŒ‰å–‡å­!!!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="æ–¹æ³•å¼•ç”¨"><a href="#æ–¹æ³•å¼•ç”¨" class="header-anchor">#</a> æ–¹æ³•å¼•ç”¨</h2> <p>é€šè¿‡æ–¹æ³•çš„åå­—æ¥å¼•ç”¨ä¸€ä¸ªæ–¹æ³•ç§°ä¸ºæ–¹æ³•å¼•ç”¨ã€‚ä½¿ç”¨å†’å·(::)æ¥å¼•ç”¨æ–¹æ³•ã€‚</p> <h3 id="æ–¹æ³•å¼•ç”¨ç±»å‹"><a href="#æ–¹æ³•å¼•ç”¨ç±»å‹" class="header-anchor">#</a> æ–¹æ³•å¼•ç”¨ç±»å‹</h3> <p>javaæœ‰6ç§ç±»å‹çš„æ–¹æ³•å¼•ç”¨ï¼š</p> <table><thead><tr><th>ç±»å‹</th> <th>è¯­æ³•</th> <th>è¯´æ˜</th></tr></thead> <tbody><tr><td>é™æ€æ–¹æ³•å¼•ç”¨</td> <td>TypeName::staticMethod</td> <td>å¼•ç”¨ç±»çš„é™æ€æ–¹æ³•ï¼Œæ¥å£æˆ–æšä¸¾</td></tr> <tr><td>å®ä¾‹æ–¹æ³•å¼•ç”¨</td> <td>objectRef::instanceMethod</td> <td>å¼•ç”¨å®ä¾‹æ–¹æ³•</td></tr> <tr><td></td> <td>ClassName::instanceMethod</td> <td>ä»ç±»ä¸­å¼•ç”¨å®ä¾‹æ–¹æ³•</td></tr> <tr><td></td> <td>TypeName.super::instanceMethod</td> <td>ä»å¯¹è±¡çš„ä½ ç±»å‹å¼•ç”¨å®ä¾‹æ–¹æ³•</td></tr> <tr><td>æ„é€ å‡½æ•°å¼•ç”¨</td> <td>ClassName::new</td> <td>å¼•ç”¨ç±»çš„æ„é€ å‡½æ•°</td></tr> <tr><td></td> <td>ArrayTypeName::new</td> <td>å¯¹æŒ‡å®šæ•°ç»„ç±»å‹çš„æ„é€ å‡½æ•°çš„å¼•ç”¨</td></tr></tbody></table> <h4 id="é™æ€æ–¹æ³•å¼•ç”¨"><a href="#é™æ€æ–¹æ³•å¼•ç”¨" class="header-anchor">#</a> é™æ€æ–¹æ³•å¼•ç”¨</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f1 <span class="token operator">=</span> x <span class="token operator">-&gt;</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">toBinaryString</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f2 <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token operator">::</span><span class="token function">toBinaryString</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">BiFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> bf1 <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">BiFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> bf2 <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token operator">::</span><span class="token function">sum</span><span class="token punctuation">;</span>
<span class="token comment">//é‡è½½ä¸­çš„é™æ€æ–¹æ³•å¼•ç”¨</span>
<span class="token comment">//ä½¿ç”¨ Integer.valueOf(int)</span>
<span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> f3 <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token operator">::</span><span class="token function">valueOf</span><span class="token punctuation">;</span>
<span class="token comment">//ä½¿ç”¨ Integer.valueOf(String)</span>
<span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> f3 <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token operator">::</span><span class="token function">valueOf</span><span class="token punctuation">;</span>
<span class="token comment">//ä½¿ç”¨ Integer.valueOf(String,Integer)</span>
<span class="token class-name">BiFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> bf3 <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token operator">::</span><span class="token function">valueOf</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="å®ä¾‹æ–¹æ³•å¼•ç”¨"><a href="#å®ä¾‹æ–¹æ³•å¼•ç”¨" class="header-anchor">#</a> å®ä¾‹æ–¹æ³•å¼•ç”¨</h3> <h4 id="ç»‘å®šå®ä¾‹æ–¹æ³•å¼•ç”¨"><a href="#ç»‘å®šå®ä¾‹æ–¹æ³•å¼•ç”¨" class="header-anchor">#</a> ç»‘å®šå®ä¾‹æ–¹æ³•å¼•ç”¨</h4> <p>è¯­æ³•ï¼š</p> <div class="language-json extra-class"><pre class="language-json"><code>instance<span class="token operator">:</span><span class="token operator">:</span>MethodName
</code></pre></div><p>ä½¿ç”¨æ— å‚ç»‘å®šæ¥æ”¶å™¨å’Œæ–¹æ³•æ¥åˆ›å»ºå®ä¾‹æ–¹æ³•å¼•ç”¨ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span><span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> argv<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> s1  <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span>  <span class="token string">&quot;I Love you&quot;</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s1<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> s2  <span class="token operator">=</span> <span class="token string">&quot;I Love you&quot;</span><span class="token operator">::</span><span class="token function">length</span><span class="token punctuation">;</span> 
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s2<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="æœªç»‘å®šå®ä¾‹æ–¹æ³•å¼•ç”¨"><a href="#æœªç»‘å®šå®ä¾‹æ–¹æ³•å¼•ç”¨" class="header-anchor">#</a> æœªç»‘å®šå®ä¾‹æ–¹æ³•å¼•ç”¨</h4> <p>è¯­æ³•ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">ClassName</span><span class="token operator">::</span><span class="token function">instanceMethod</span>
</code></pre></div><p>ä¾‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo_09_</span>æœªç»‘å®šå®ä¾‹æ–¹æ³•å¼•ç”¨ <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> argv<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">BiFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> strFunc <span class="token operator">=</span> <span class="token class-name">Util2</span><span class="token operator">::</span><span class="token function">append</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> love <span class="token operator">=</span> strFunc<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token string">&quot;I Love you &quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;LML&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>love<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Util2</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token class-name">String</span> s1<span class="token punctuation">,</span> <span class="token class-name">String</span> s2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> s1 <span class="token operator">+</span> s2<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="è¶…ç±»å‹å®ä¾‹æ–¹æ³•å¼•ç”¨"><a href="#è¶…ç±»å‹å®ä¾‹æ–¹æ³•å¼•ç”¨" class="header-anchor">#</a> è¶…ç±»å‹å®ä¾‹æ–¹æ³•å¼•ç”¨</h4> <p>è¯­æ³•ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">ClassName</span><span class="token punctuation">.</span><span class="token keyword">super</span><span class="token operator">::</span><span class="token function">instanceMethod</span>
</code></pre></div><p>ä¾‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo_10_</span>è¶…ç±»å‹å®ä¾‹æ–¹æ³•å¼•ç”¨ <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> argv<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">Util</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Util</span> <span class="token keyword">extends</span> <span class="token class-name">ParentUtil</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Util</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">BiFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> bf <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">::</span><span class="token function">append</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> love <span class="token operator">=</span> bf<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token string">&quot;I love you &quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;lml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>love<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è¶…ç±»å‹å®ä¾‹æ–¹æ³•å¼•ç”¨</span>
        <span class="token class-name">BiFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> bf2 <span class="token operator">=</span> <span class="token class-name">Util</span><span class="token punctuation">.</span><span class="token keyword">super</span><span class="token operator">::</span><span class="token function">append</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> love2 <span class="token operator">=</span> bf<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token string">&quot;I love you &quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;lml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>love2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token class-name">String</span> s1<span class="token punctuation">,</span><span class="token class-name">String</span> s2<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;child append&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> s1<span class="token operator">+</span>s2<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">ParentUtil</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token class-name">String</span> s1<span class="token punctuation">,</span> <span class="token class-name">String</span> s2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;parent append&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> s1 <span class="token operator">+</span> s2<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="æ„é€ å‡½æ•°å¼•ç”¨"><a href="#æ„é€ å‡½æ•°å¼•ç”¨" class="header-anchor">#</a> æ„é€ å‡½æ•°å¼•ç”¨</h3> <p>è¯­æ³•ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">ClassName</span><span class="token operator">::</span><span class="token keyword">new</span> <span class="token comment">//å¯¹è±¡æ„é€ å‡½æ•°å¼•ç”¨</span>
<span class="token class-name">ArrayTypeName</span><span class="token operator">::</span><span class="token keyword">new</span> <span class="token comment">//æ•°ç»„æ„é€ å‡½æ•°å¼•ç”¨</span>
</code></pre></div><p>å…³é”®å­—newæŒ‡çš„æ˜¯ç±»çš„æ„é€ å‡½æ•°ã€‚ç¼–è¯‘å™¨ä¼šæ ¹æ®ä¸Šä¸‹æ–‡é€‰æ‹©ä¸€ä¸ªæ„é€ å‡½æ•°ã€‚</p> <p>ä¾‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo_11_</span>æ•°ç»„æ„é€ å‡½æ•°å¼•ç”¨ <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">IntFunction</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> intFunction <span class="token operator">=</span> size <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>size<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">//å‚æ•°ä¸ºintç±»å‹ï¼Œè¿”å›å€¼ä¸ºint[]ç±»å‹</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data <span class="token operator">=</span> intFunction<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">IntFunction</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> intFunction1 <span class="token operator">=</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">::</span><span class="token keyword">new</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data2 <span class="token operator">=</span> intFunction1<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>data2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//åˆ›å»ºäºŒç»´æ•°ç»„</span>
        <span class="token class-name">Function</span><span class="token operator">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> intFunction2 <span class="token operator">=</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">::</span><span class="token keyword">new</span><span class="token punctuation">;</span>
        <span class="token comment">//ç›¸å½“äºåˆ›å»ºäº†ä¸€ä¸ª int[5][] çš„æ•°ç»„</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data3 <span class="token operator">=</span> intFunction2<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> data3<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            data3<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> intFunction1<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">deepToString</span><span class="token punctuation">(</span>data3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="é€šç”¨æ–¹æ³•å¼•ç”¨"><a href="#é€šç”¨æ–¹æ³•å¼•ç”¨" class="header-anchor">#</a> é€šç”¨æ–¹æ³•å¼•ç”¨</h3> <p>è¯­æ³•ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">ClassName</span><span class="token operator">::</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TypeName</span><span class="token punctuation">&gt;</span></span>methodName
<span class="token comment">//é€šç”¨æ„é€ å‡½æ•°å¼•ç”¨</span>
<span class="token class-name">ClassName</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TypeName</span><span class="token punctuation">&gt;</span></span><span class="token operator">::</span><span class="token keyword">new</span> 
</code></pre></div><p>asListæ–¹æ³•åŸå‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>public static &lt;T&gt; List&lt;T&gt; asList(T... a) {
    return new ArrayList&lt;&gt;(a);
}
</code></pre></div><p>ä¾‹ï¼šå°†Arrays.asListæ–¹æ³•è°ƒç”¨è½¬æ¢æˆæ–¹æ³•å¼•ç”¨çš„å½¢å¼</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span> args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Function</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> f <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token operator">::</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span>asList<span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">&quot;I&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Love&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;You&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h1 id="stream-api"><a href="#stream-api" class="header-anchor">#</a> Stream API</h1> <h2 id="ä»€ä¹ˆæ˜¯stream"><a href="#ä»€ä¹ˆæ˜¯stream" class="header-anchor">#</a> ä»€ä¹ˆæ˜¯Stream</h2> <p>Streamï¼ˆæµï¼‰æ˜¯ä¸€ä¸ªæ¥è‡ªæ•°æ®æºçš„å…ƒç´ é˜Ÿåˆ—å¹¶æ”¯æŒèšåˆæ“ä½œã€‚</p> <ul><li>å…ƒç´ æ˜¯ç‰¹å®šç±»å‹çš„å¯¹è±¡ï¼Œå½¢æˆä¸€ä¸ªé˜Ÿåˆ—ã€‚ Javaä¸­çš„Streamå¹¶ä¸ä¼šå­˜å‚¨å…ƒç´ ï¼Œè€Œæ˜¯æŒ‰éœ€è®¡ç®—ã€‚</li> <li>æ•°æ®æºï¼šæµçš„æ¥æºã€‚å¯ä»¥æ˜¯é›†åˆï¼Œæ•°ç»„ï¼ŒI/O channelï¼Œ äº§ç”Ÿå™¨generator ç­‰ã€‚</li> <li>èšåˆæ“ä½œï¼šç±»ä¼¼SQLè¯­å¥ä¸€æ ·çš„æ“ä½œï¼Œ æ¯”å¦‚filter, map, reduce, find, match, sortedç­‰ã€‚</li></ul> <p>Streamæµä¸¤å¤§ç‰¹å¾ï¼š</p> <ul><li>Pipeliningï¼šä¸­é—´æ“ä½œéƒ½ä¼šè¿”å›æµå¯¹è±¡æœ¬èº«ã€‚</li> <li>å†…éƒ¨è¿­ä»£ï¼šä»¥å‰å¯¹é›†åˆéå†éƒ½æ˜¯é€šè¿‡Iteratoræˆ–è€…For-Eachçš„æ–¹å¼, æ˜¾å¼çš„åœ¨é›†åˆå¤–éƒ¨è¿›è¡Œè¿­ä»£ï¼Œ è¿™å«åšå¤–éƒ¨è¿­ä»£ã€‚ Streamæä¾›äº†å†…éƒ¨è¿­ä»£çš„æ–¹å¼ï¼Œ é€šè¿‡è®¿é—®è€…æ¨¡å¼(Visitor)å®ç°</li></ul> <p>Streamçš„ç‰¹æ€§ï¼š</p> <ul><li><p><strong>ä¸­é—´æ“ä½œæƒ°æ€§æ‰§è¡Œ</strong>ï¼šä¸€ä¸ªæµåé¢å¯ä»¥è·Ÿéš0åˆ°å¤šä¸ªä¸­é—´æ“ä½œï¼Œä¸»è¦ç›®çš„æ˜¯æ‰“å¼€æµï¼Œå¹¶æ²¡æœ‰çœŸæ­£çš„å»è®¡ç®—ï¼Œè€Œæ˜¯åšå‡ºæŸç§ç¨‹åº¦çš„æ•°æ®æ˜ å°„/è¿‡æ»¤ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„æµï¼Œäº¤ç»™ä¸‹ä¸€ä¸ªæ“ä½œä½¿ç”¨ã€‚è¿™ç±»æ“ä½œéƒ½æ˜¯æƒ°æ€§åŒ–çš„ï¼ˆlazyï¼‰ï¼Œå°±æ˜¯è¯´ï¼Œä»…ä»…è°ƒç”¨åˆ°è¿™ç±»æ–¹æ³•ï¼Œå¹¶æ²¡æœ‰çœŸæ­£å¼€å§‹æµçš„éå†ï¼Œå¹¶æ²¡æœ‰æ¶ˆè€—èµ„æºã€‚</p> <p>è¿˜æœ‰å¤šä¸ªä¸­é—´æ“ä½œçš„è¯ï¼Œè¿™é‡Œçš„æ—¶é—´å¤æ‚åº¦å¹¶ä¸æ˜¯nä¸ªforå¾ªç¯ï¼Œè½¬æ¢æ“ä½œéƒ½æ˜¯ lazy çš„ï¼Œ<strong>å¤šä¸ªè½¬æ¢æ“ä½œåªä¼šåœ¨</strong> <strong>Terminal</strong> **æ“ä½œçš„æ—¶å€™èåˆèµ·æ¥ï¼Œä¸€æ¬¡å¾ªç¯å®Œæˆã€‚**å¯ä»¥è¿™æ ·ç®€å•çš„ç†è§£ï¼ŒStream é‡Œæœ‰ä¸ªæ“ä½œå‡½æ•°çš„é›†åˆï¼Œæ¯æ¬¡è½¬æ¢æ“ä½œå°±æ˜¯æŠŠè½¬æ¢å‡½æ•°æ”¾å…¥è¿™ä¸ªé›†åˆä¸­ï¼Œåœ¨Terminalæ“ä½œçš„æ—¶å€™å¾ªç¯ Stream å¯¹åº”çš„é›†åˆï¼Œç„¶åå¯¹æ¯ä¸ªå…ƒç´ æ‰§è¡Œæ‰€æœ‰çš„å‡½æ•°ã€‚</p></li> <li><p><strong>æµçš„æœ«ç«¯æ“ä½œåªèƒ½æœ‰ä¸€æ¬¡</strong>ï¼š å½“è¿™ä¸ªæ“ä½œæ‰§è¡Œåï¼Œæµå°±è¢«ä½¿ç”¨â€œå…‰â€äº†ï¼Œæ— æ³•å†è¢«æ“ä½œã€‚æ‰€ä»¥è¿™å¿…å®šæ˜¯æµçš„æœ€åä¸€ä¸ªæ“ä½œã€‚ä¹‹åå¦‚æœæƒ³è¦æ“ä½œå°±å¿…é¡»æ–°æ‰“å¼€æµã€‚</p></li></ul> <h2 id="ç”Ÿæˆstream"><a href="#ç”Ÿæˆstream" class="header-anchor">#</a> ç”ŸæˆStream</h2> <ol><li><p>é€šè¿‡Collectionä¸­çš„streamå’ŒparallelStreamæ–¹æ³•åˆ›å»ºæµï¼›</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//stream() ä¸²è¡Œæµ</span>
<span class="token comment">//parallelStream() å¹¶è¡Œæµ</span>
</code></pre></div></li> <li><p>é€šè¿‡Arraysç±»ä¸­streamæ–¹æ³•ï¼Œå°†æ•°ç»„è½¬æ¢æˆæµï¼›</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">arrayOf</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">joining</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> names <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;aitao&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;lml&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;dnf&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;7f&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">arrayOf</span><span class="token punctuation">(</span>names<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//aitao,lml,dnf,7f</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>é€šè¿‡Streamç±»ä¸­çš„é™æ€æ–¹æ³•ofã€iterateã€generateåˆ›å»ºæµï¼›</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//iterate æ–¹æ³•è¿”å›ä¸€ä¸ªæ— é™é¡ºåºçš„æœ‰åºæµ</span>

</code></pre></div></li> <li><p>é€šè¿‡Patternç±»ä¸­çš„splitAsStreamæ–¹æ³•ï¼Œå°†å­—ç¬¦ä¸²åˆ†éš”æˆæµï¼›</p></li> <li><p>é€šè¿‡BufferedReaderä¸­çš„linesé™æ€æ–¹æ³•ï¼Œå°†æ¯è¡Œå†…å®¹è½¬æ¢æˆæµï¼›</p></li></ol> <h2 id="streamå¸¸ç”¨æ–¹æ³•"><a href="#streamå¸¸ç”¨æ–¹æ³•" class="header-anchor">#</a> Streamå¸¸ç”¨æ–¹æ³•</h2> <table><thead><tr><th>æ–¹æ³•å</th> <th>æè¿°</th></tr></thead> <tbody><tr><td>forEach</td> <td>è¿­ä»£æµä¸­æ¯ä¸ªæ•°æ®</td></tr> <tr><td>map</td> <td>æ˜ å°„æ¯ä¸ªå…ƒç´ åˆ°å¯¹åº”çš„ç»“æœ</td></tr> <tr><td>filter</td> <td>é€šè¿‡è®¾ç½®çš„æ¡ä»¶è¿‡æ»¤å‡ºå…ƒç´ </td></tr> <tr><td>limit</td> <td>è·å–æŒ‡å®šæ•°é‡çš„æµ</td></tr> <tr><td>skip</td> <td>è·¯è¿‡æŒ‡å®šæ•°é‡çš„æµ</td></tr> <tr><td>sorted</td> <td>å¯¹æµè¿›è¡Œæ’åº</td></tr> <tr><td>concat</td> <td>åˆå¹¶æµ</td></tr> <tr><td>max</td> <td>è·å–æµä¸­æœ€å¤§å…ƒç´ </td></tr> <tr><td>min</td> <td>è·å–æµä¸­æœ€å°å…ƒç´ </td></tr> <tr><td>count</td> <td>ç»Ÿè®¡æµä¸­æ•°æ®å…ƒç´ çš„ä¸ªæ•°</td></tr> <tr><td>distinct</td> <td>æŸ¥é‡ï¼Œè·å–æµä¸­ä¸é‡å¤çš„å…ƒç´ </td></tr> <tr><td>allMatch</td> <td>æµä¸­<strong>æ‰€æœ‰</strong>å…ƒç´ ç¬¦åˆä¼ å…¥çš„ Predicateï¼Œè¿”å› true</td></tr> <tr><td>anyMatch</td> <td>æµä¸­<strong>åªè¦æœ‰ä¸€ä¸ª</strong>å…ƒç´ ç¬¦åˆä¼ å…¥çš„ Predicateï¼Œè¿”å› true</td></tr> <tr><td>noneMatch</td> <td>æµä¸­<strong>æ²¡æœ‰ä¸€ä¸ª</strong>å…ƒç´ ç¬¦åˆä¼ å…¥çš„ Predicateï¼Œè¿”å› true</td></tr> <tr><td>findFirst</td> <td>è¿”å›æµä¸­é¦–ä¸ªå…ƒç´ ï¼Œå¸¸ä¸orElseä¸€èµ·ç”¨: Stream.findFirst().orElse(null):è¿”å›ç¬¬ä¸€ä¸ªï¼Œè‹¥æ²¡æœ‰åˆ™è¿”å›null</td></tr> <tr><td>reduce</td> <td>å°†é›†åˆä¸­çš„æ‰€æœ‰å€¼æ ¹æ®è§„åˆ™è®¡ç®—ï¼Œæœ€ååªè¿”å›ä¸€ä¸ªç»“æœ</td></tr> <tr><td>collect</td> <td>æ˜¯ä¸€ä¸ªéå¸¸å¸¸ç”¨çš„æœ«ç«¯æ“ä½œï¼Œå¸¸å¸¸ä½¿ç”¨collectå°†æµè½¬æ¢æˆList,Mapæˆ–Set</td></tr> <tr><td>orElse</td> <td>å½“Optionalå€¼ä¸å­˜åœ¨æ—¶ï¼Œè°ƒç”¨orElseè¿”å›çš„å‚æ•°ï¼Œå¦‚æœOptionalçš„å€¼å­˜åœ¨æ—¶è¿”å›Optionalçš„å€¼</td></tr> <tr><td>orElseGet</td> <td>å½“Optionalå€¼ä¸å­˜åœ¨æ—¶ï¼Œè°ƒç”¨orElseGetè¿”å›çš„å‚æ•°ï¼Œå¦‚æœOptionalçš„å€¼å­˜åœ¨æ—¶è¿”å›Optionalçš„å€¼</td></tr> <tr><td>orElseThrow</td> <td>å¦‚æœOptionalæœ‰å€¼åˆ™å°†å…¶è¿”å›ï¼Œå¦åˆ™æŠ›å‡º<code>Supplier</code>æ¥å£åˆ›å»ºçš„å¼‚å¸¸</td></tr></tbody></table> <h2 id="streamä¸­é—´æ“ä½œ"><a href="#streamä¸­é—´æ“ä½œ" class="header-anchor">#</a> Streamä¸­é—´æ“ä½œ</h2> <h3 id="ç­›é€‰ä¸åˆ‡ç‰‡"><a href="#ç­›é€‰ä¸åˆ‡ç‰‡" class="header-anchor">#</a> ç­›é€‰ä¸åˆ‡ç‰‡</h3> <p>filterï¼šè¿‡æ»¤æµä¸­çš„å…ƒç´ ï¼›</p> <p>limitï¼šè·å–æµä¸­æŒ‡å®šæ•°é‡çš„å…ƒç´ ï¼›</p> <p>skipï¼šè·³è¿‡æµä¸­æŒ‡å®šæ•°é‡çš„å…ƒç´ ï¼›</p> <p>distinctï¼šæŸ¥é‡ï¼Œè·å–æµä¸­ä¸é‡å¤çš„å…ƒç´ </p> <div class="language-java extra-class"><pre class="language-java"><code>
</code></pre></div><h3 id="æ˜ å°„"><a href="#æ˜ å°„" class="header-anchor">#</a> æ˜ å°„</h3> <p>mapï¼šæ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°ä¼šè¢«åº”ç”¨åˆ°æµä¸­æ¯ä¸ªå…ƒç´ ä¸Šï¼Œå¹¶å°†å…¶æ˜ å°„æˆä¸€ä¸ªæ–°çš„å…ƒç´ ã€‚</p> <p>flatMapï¼šæ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå°†æµä¸­çš„æ¯ä¸ªå€¼éƒ½æ¢æˆå¦ä¸€ä¸ªæµï¼Œç„¶åæŠŠæ‰€æœ‰æµè¿æ¥æˆä¸€ä¸ªæµã€‚</p> <h3 id="æ’åº"><a href="#æ’åº" class="header-anchor">#</a> æ’åº</h3> <p>sorted()ï¼šé»˜è®¤æ’åºï¼›</p> <p>sorted(Comparator com)ï¼šå®šåˆ¶åŒ–æ’åºï¼Œè‡ªå®šä¹‰Comparatoræ’åºè§„åˆ™ï¼›</p> <h3 id="æ¶ˆè´¹"><a href="#æ¶ˆè´¹" class="header-anchor">#</a> æ¶ˆè´¹</h3> <p>peekï¼šç±»ä¼¼äºmapï¼Œèƒ½å¾—åˆ°æµä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ã€‚mapæ¥æ”¶çš„æ˜¯ä¸€ä¸ªFunctionè¡¨è¾¾å¼ï¼›è€Œpeekæ¥æ”¶çš„æ˜¯Consumerè¡¨è¾¾å¼ã€‚</p> <h2 id="streamç»ˆæ­¢æ“ä½œ"><a href="#streamç»ˆæ­¢æ“ä½œ" class="header-anchor">#</a> Streamç»ˆæ­¢æ“ä½œ</h2> <p>allMatchï¼šæ¥æ”¶ä¸€ä¸ª Predicate å‡½æ•°ï¼Œå½“æµä¸­æ¯ä¸ªå…ƒç´ éƒ½ç¬¦åˆè¯¥æ–­è¨€æ—¶æ‰è¿”å›trueï¼Œå¦åˆ™è¿”å›false</p> <p>noneMatchï¼šæ¥æ”¶ä¸€ä¸ª Predicate å‡½æ•°ï¼Œå½“æµä¸­æ¯ä¸ªå…ƒç´ éƒ½ä¸ç¬¦åˆè¯¥æ–­è¨€æ—¶æ‰è¿”å›trueï¼Œå¦åˆ™è¿”å›false</p> <p>anyMatchï¼šæ¥æ”¶ä¸€ä¸ª Predicate å‡½æ•°ï¼Œåªè¦æµä¸­æœ‰ä¸€ä¸ªå…ƒç´ æ»¡è¶³è¯¥æ–­è¨€åˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false</p> <p>findFirstï¼šè¿”å›æµä¸­ç¬¬ä¸€ä¸ªå…ƒç´ </p> <p>findAnyï¼šè¿”å›æµä¸­çš„ä»»æ„å…ƒç´ </p> <p>countï¼šè¿”å›æµä¸­å…ƒç´ çš„æ€»ä¸ªæ•°</p> <p>maxï¼šè¿”å›æµä¸­å…ƒç´ æœ€å¤§å€¼</p> <p>minï¼šè¿”å›æµä¸­å…ƒç´ æœ€å°å€¼</p> <h4 id="foreach"><a href="#foreach" class="header-anchor">#</a> forEach</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="map"><a href="#map" class="header-anchor">#</a> map</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">R</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">String</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">R</span><span class="token punctuation">&gt;</span></span> <span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">R</span><span class="token punctuation">&gt;</span></span> mapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="filter"><a href="#filter" class="header-anchor">#</a> filter</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> predicate<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="limit"><a href="#limit" class="header-anchor">#</a> limit</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">limit</span><span class="token punctuation">(</span><span class="token keyword">long</span> maxSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="skip"><a href="#skip" class="header-anchor">#</a> skip</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">skip</span><span class="token punctuation">(</span><span class="token keyword">long</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="sorted"><a href="#sorted" class="header-anchor">#</a> sorted</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">sorted</span><span class="token punctuation">(</span><span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> comparator<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="concat"><a href="#concat" class="header-anchor">#</a> concat</h4> <div class="language-java extra-class"><pre class="language-java"><code> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">concat</span><span class="token punctuation">(</span><span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> a<span class="token punctuation">,</span> <span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> b<span class="token punctuation">)</span>
</code></pre></div><h4 id="max"><a href="#max" class="header-anchor">#</a> max</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> comparator<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="min"><a href="#min" class="header-anchor">#</a> min</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> comparator<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="count"><a href="#count" class="header-anchor">#</a> count</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Long</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="distinct"><a href="#distinct" class="header-anchor">#</a> distinct</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">distinct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="allmatch"><a href="#allmatch" class="header-anchor">#</a> allMatch</h4> <h4 id="anymatch"><a href="#anymatch" class="header-anchor">#</a> anyMatch</h4> <h4 id="nonematch"><a href="#nonematch" class="header-anchor">#</a> noneMatch</h4> <h4 id="findfirst"><a href="#findfirst" class="header-anchor">#</a> findFirst</h4> <h4 id="reduce"><a href="#reduce" class="header-anchor">#</a> reduce</h4> <h4 id="orelseã€orelsegetã€orelsethrow"><a href="#orelseã€orelsegetã€orelsethrow" class="header-anchor">#</a> orElseã€orElseGetã€orElseThrow</h4> <blockquote><p>åŒºåˆ«ï¼šåœ¨optionalä¸ºç©ºå€¼æ—¶orElseå’ŒorElseGetéƒ½ä¼šæ‰§è¡Œï¼Œå½“optionalä¸ä¸ºç©ºæ—¶ï¼ŒorElseGetä¸ä¼šæ‰§è¡Œï¼Œä½†orElseä»ä¼šæ‰§è¡Œï¼›</p></blockquote> <h4 id="collect"><a href="#collect" class="header-anchor">#</a> collect</h4> <div class="language- extra-class"><pre><code>ç°åœ¨æœ‰ä¸¤ä¸ªArrayListé›†åˆå­˜å‚¨é˜Ÿä¼å½“ä¸­çš„å¤šä¸ªæˆå‘˜å§“åï¼Œè¦æ±‚ä½¿ç”¨ä¼ ç»Ÿçš„forå¾ªç¯(æˆ–å¢å¼ºforå¾ªç¯)ä¾æ¬¡è¿›è¡Œä»¥ä¸‹è‹¥å¹²æ“ä½œæ­¥éª¤ï¼š
  1. ç¬¬ä¸€æ”¯é˜Ÿä¼åªè¦åå­—ä¸º3ä¸ªå­—çš„æˆå‘˜å§“åï¼›å­˜å‚¨åˆ°ä¸€ä¸ªæ–°çš„é›†åˆä¸­ã€‚
  2. ç¬¬ä¸€æ”¯é˜Ÿä¼ç­›é€‰ä¹‹ååªè¦å‰3ä¸ªäººï¼›å­˜å‚¨åˆ°ä¸€ä¸ªæ–°é›†åˆä¸­ã€‚
  3. ç¬¬äºŒæ”¯é˜Ÿä¼åªè¦å§“å¼ çš„æˆå‘˜å§“åï¼›å­˜å‚¨åˆ°ä¸€ä¸ªæ–°é›†åˆä¸­ã€‚
  4. ç¬¬äºŒæ”¯é˜Ÿä¼ç­›é€‰ä¹‹åä¸è¦å‰2ä¸ªäººï¼›å­˜å‚¨åˆ°ä¸€ä¸ªæ–°é›†åˆä¸­ã€‚
  5. å°†ä¸¤ä¸ªé˜Ÿä¼åˆå¹¶ä¸ºä¸€ä¸ªé˜Ÿä¼ï¼›å­˜å‚¨åˆ°ä¸€ä¸ªæ–°é›†åˆä¸­ã€‚
  6. æ ¹æ®å§“ååˆ›å»ºPersonå¯¹è±¡ï¼›å­˜å‚¨åˆ°ä¸€ä¸ªæ–°é›†åˆä¸­ã€‚
  7. æ‰“å°æ•´ä¸ªé˜Ÿä¼çš„Personå¯¹è±¡ä¿¡æ¯ã€‚
</code></pre></div><h2 id="streamæœ«ç«¯æ“ä½œ"><a href="#streamæœ«ç«¯æ“ä½œ" class="header-anchor">#</a> Streamæœ«ç«¯æ“ä½œ</h2> <p>ä¹‹å‰çš„ä¸­é—´æ“ä½œåªæ˜¯å¯¹æµä¸­æ•°æ®çš„å¤„ç†ï¼Œæœ€ç»ˆè¿˜æ˜¯è¦å°†å®ƒä»¬æ•´åˆè¾“å‡ºä¸ºä¸€ä¸ªç»“æœï¼Œæ¯”å¦‚è¿”å›ä¸€ä¸ªæœ€å¤§å€¼ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œæˆ–è€…å°†æ‰€æœ‰å…ƒç´ è¿›è¡Œåˆ†ç»„ç­‰ï¼Œè¿™å°±æ˜¯è§„çº¦ï¼ˆæœ«ç«¯ï¼‰æ“ä½œçš„ä½œç”¨ã€‚</p> <p>å¸¸ç”¨çš„æœ«ç«¯æ“ä½œå‡½æ•°æœ‰ reduce() å’Œ collect()</p> <h3 id="è§„çº¦æ“ä½œ"><a href="#è§„çº¦æ“ä½œ" class="header-anchor">#</a> è§„çº¦æ“ä½œ</h3> <p><code>è§„çº¦</code>ï¼šå°†é›†åˆä¸­çš„æ‰€æœ‰å€¼æ ¹æ®è§„åˆ™è®¡ç®—ï¼Œæœ€ååªè¿”å›ä¸€ä¸ªç»“æœã€‚</p> <p>reduceåŒ…å«ä¸‰ä¸ªé‡è½½æ–¹æ³•ã€‚</p> <h4 id="é‡è½½æ–¹æ³•ä¸€"><a href="#é‡è½½æ–¹æ³•ä¸€" class="header-anchor">#</a> é‡è½½æ–¹æ³•ä¸€</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">reduce</span><span class="token punctuation">(</span><span class="token class-name">BinaryOperator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> accumulator<span class="token punctuation">)</span>
</code></pre></div><p>ä¾‹ï¼šæ‰¾å‡ºé›†åˆä¸­çš„æœ€å¤§å€¼</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> reduce <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>num1<span class="token punctuation">,</span> num2<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> num1 <span class="token operator">&gt;</span> num2 <span class="token operator">?</span> num1 <span class="token operator">:</span> num2<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>reduce<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//5</span>
</code></pre></div><h4 id="é‡è½½æ–¹æ³•äºŒ"><a href="#é‡è½½æ–¹æ³•äºŒ" class="header-anchor">#</a> é‡è½½æ–¹æ³•äºŒ</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">T</span> <span class="token function">reduce</span><span class="token punctuation">(</span><span class="token class-name">T</span> identity<span class="token punctuation">,</span> <span class="token class-name">BinaryOperator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> accumulator<span class="token punctuation">)</span>
</code></pre></div><p>ä¾‹ï¼šæ¯”è¾ƒä¸¤ä¸ªæ•°çš„å¤§å°</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// T reduce(T identity, BinaryOperator&lt;T&gt; accumulator);</span>
<span class="token comment">// identity:æ˜¯ä¸€ä¸ªå›ºå®šçš„åˆå§‹åŒ–çš„å€¼ï¼Œå®ƒä¼šä½œä¸ºå®¹å™¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ è¿›å…¥è®¡ç®—</span>
<span class="token comment">// listé›†åˆåœ¨ä¸Šé¢ä¾‹å­ä¸­å®šä¹‰</span>
<span class="token class-name">Integer</span> reduce2 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>num1<span class="token punctuation">,</span> num2<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> num1 <span class="token operator">&gt;</span> num2 <span class="token operator">?</span> num1 <span class="token operator">:</span> num2<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>reduce2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//5</span>
</code></pre></div><h4 id="é‡è½½æ–¹æ³•ä¸‰"><a href="#é‡è½½æ–¹æ³•ä¸‰" class="header-anchor">#</a> é‡è½½æ–¹æ³•ä¸‰</h4> <p>ä¸‰ä¸ªå‚æ•°çš„æƒ…å†µä¸»è¦æ˜¯åœ¨å¹¶è¡Œï¼ˆparallelStreamï¼‰æƒ…å†µä¸‹ä½¿ç”¨ã€‚</p> <h3 id="æ”¶é›†æ“ä½œ"><a href="#æ”¶é›†æ“ä½œ" class="header-anchor">#</a> æ”¶é›†æ“ä½œ</h3> <p><code>æ”¶é›†</code>ï¼šå°†Streamä¸­çš„æ‰€æœ‰æ•°æ®æ•´ç†åœ¨ä¸€ä¸ªé›†åˆå®¹å™¨ä¸­ï¼Œå°†æµè½¬æ¢æˆListã€Setã€Mapç­‰å½¢å¼ï¼›</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo_22_collect</span>æ–¹æ³•ä½¿ç”¨ <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//é€šè¿‡collectæ–¹æ³•å°†æµè½¬æ¢æˆListã€Setã€Map</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;===========è½¬æ¢List===============&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">accept</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> ele<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ele<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;===========è½¬æ¢Set===============&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">accept</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> ele<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ele<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;===========è½¬æ¢Map===============&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">distinct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toMap</span><span class="token punctuation">(</span><span class="token class-name">Function</span><span class="token punctuation">.</span><span class="token function">identity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token punctuation">.</span><span class="token function">identity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å°†æ•°ç»„ä¸­çš„å­—ç¬¦ä¸²ä½œä¸ºkeyï¼Œå­—ç¬¦ä¸²é•¿åº¦ä½œä¸ºvalueï¼Œç”Ÿæˆä¸€ä¸ªMap&lt;String,Integer&gt;</span>
        <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;bc&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;efg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;abcd&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;jkl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toMap</span><span class="token punctuation">(</span><span class="token class-name">Function</span><span class="token punctuation">.</span><span class="token function">identity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token operator">::</span><span class="token function">length</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BiConsumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">accept</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">Integer</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//å°†æ•°ç»„ä¸­çš„å­—ç¬¦ä¸²æŒ‰é•¿åº¦åˆ†ç»„,groupingByç±»ä¼¼SQLä¸­çš„group by</span>
        <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;bc&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;efg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;abcd&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;jkl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">groupingBy</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token operator">::</span><span class="token function">length</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BiConsumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">accept</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> len<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> ele<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>len <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> ele<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//è¾“å‡ºç»“æœ:</span>
                <span class="token comment">//2 [bc]</span>
                <span class="token comment">//3 [abc, efg, jkl]</span>
                <span class="token comment">//4 [abcd]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="collectors"><a href="#collectors" class="header-anchor">#</a> Collectors</h3> <p>ä½œç”¨ï¼šå¯ç”¨äºè¿”å›åˆ—è¡¨æˆ–å­—ç¬¦ä¸²</p> <h2 id="â­streamæºç åˆ†æ"><a href="#â­streamæºç åˆ†æ" class="header-anchor">#</a> â­Streamæºç åˆ†æ</h2> <h1 id="optional"><a href="#optional" class="header-anchor">#</a> Optional</h1> <p>Optional ç”¨æ¥è§£å†³ Java ä¸­ç»å¸¸å‡ºç°çš„ <strong>NullPointerException</strong> ï¼Œä»è€Œé¿å…æºç è¢«å„ç§ç©ºæ£€æŸ¥æ±¡æŸ“ï¼Œä½¿æºç æ›´åŠ ç®€æ´å’Œæ›´åŠ å®¹æ˜“é˜…è¯»</p> <table><thead><tr><th>æ–¹æ³•</th> <th>è¯´æ˜</th></tr></thead> <tbody><tr><td>boolean isPresent()</td> <td>è‹¥å€¼å­˜åœ¨è¿”å›trueï¼Œå¦åˆ™è¿”å› false</td></tr> <tr><td>static <T> Optional<T> ofNullable(T value)</T></T></td> <td>è‹¥ä¸ºéç©ºï¼Œè¿”å› Optional æè¿°çš„æŒ‡å®šå€¼ï¼Œå¦åˆ™è¿”å›ç©ºçš„ Optional</td></tr> <tr><td>T get()</td> <td>è‹¥Optionalä¸­åŒ…å«è¿™ä¸ªå€¼ï¼Œè¿”å›å€¼ï¼Œå¦åˆ™æŠ›å‡ºNoSuchElementExceptionå¼‚å¸¸</td></tr></tbody></table> <h1 id="æ—¥æœŸæ—¶é—´api"><a href="#æ—¥æœŸæ—¶é—´api" class="header-anchor">#</a> æ—¥æœŸæ—¶é—´API</h1> <p>å‡ ä¹æ‰€æœ‰çš„æ—¶é—´å¯¹è±¡éƒ½å®ç°äº† <code>Temporal</code> æ¥å£ï¼Œæ‰€ä»¥æ¥å£å‚æ•°ä¸€èˆ¬éƒ½æ˜¯ <code>Temporal</code></p> <ul><li><strong>Instantï¼š</strong> è¡¨ç¤ºæ—¶é—´çº¿ä¸Šçš„ä¸€ä¸ªç‚¹ï¼Œå‚è€ƒç‚¹æ˜¯æ ‡å‡†çš„Javaçºªå…ƒ(epoch)ï¼Œå³1970-01-01T00ï¼š00ï¼š00Zï¼ˆ1970å¹´1æœˆ1æ—¥00:00 GMTï¼‰</li> <li><strong>LocalDateï¼š</strong> æ—¥æœŸå€¼å¯¹è±¡å¦‚ 2019-09-22</li> <li>**LocalTimeï¼š**æ—¶é—´å€¼å¯¹è±¡å¦‚ 21:25:36</li> <li>**LocalDateTimeï¼š**æ—¥æœŸ+æ—¶é—´å€¼å¯¹è±¡</li> <li>**ZoneIdï¼š**æ—¶åŒº</li> <li>**ZonedDateTimeï¼š**æ—¥æœŸ+æ—¶é—´+æ—¶åŒºå€¼å¯¹è±¡</li> <li>**DateTimeFormatterï¼š**ç”¨äºæ—¥æœŸæ—¶é—´çš„æ ¼å¼åŒ–</li> <li>**Periodï¼š**ç”¨äºè®¡ç®—æ—¥æœŸé—´éš”</li> <li>**Durationï¼š**ç”¨äºè®¡ç®—æ—¶é—´é—´éš”</li></ul> <p><strong><code>Instant</code> è¡¨ç¤ºæ—¶é—´çº¿ä¸Šçš„ä¸€ä¸ªç‚¹(ç¬æ—¶)</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// æµ‹è¯•æ‰§è¡Œä¸€ä¸ª new æ“ä½œä½¿ç”¨çš„æ—¶é—´(çº³ç§’å€¼)</span>
<span class="token class-name">Instant</span> begin <span class="token operator">=</span> <span class="token class-name">Instant</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">StreamMain</span> streamMain <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StreamMain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Instant</span> end <span class="token operator">=</span> <span class="token class-name">Instant</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">between</span><span class="token punctuation">(</span>begin<span class="token punctuation">,</span>end<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toNanos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong><code>LocalDate</code>ã€<code>LocalTime</code>ã€<code>LocalDateTime</code>ã€<code>ZonedDateTime</code>ç”¨äºè¡¨ç¤ºæ—¶é—´çš„</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// å¯ä»¥ä½¿ç”¨ of æ–¹æ³•æ„å»ºå®ƒä»¬çš„å®ä¾‹,å¦‚ä¸‹é¢åˆ›å»ºäº†ä¸€ä¸ª 2019-9-22 21:42:59 ä¸œå…«åŒº çš„æ—¶é—´å¯¹è±¡ </span>
<span class="token class-name">LocalDate</span> localDate <span class="token operator">=</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">2019</span><span class="token punctuation">,</span> <span class="token class-name">Month</span><span class="token punctuation">.</span><span class="token constant">SEPTEMBER</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">LocalTime</span> localTime <span class="token operator">=</span> <span class="token class-name">LocalTime</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">LocalDateTime</span> localDateTime <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>localDate<span class="token punctuation">,</span> localTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ZonedDateTime</span> zonedDateTime <span class="token operator">=</span> <span class="token class-name">ZonedDateTime</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>localDateTime<span class="token punctuation">,</span> <span class="token class-name">ZoneId</span><span class="token punctuation">.</span><span class="token function">systemDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// è·å–ç°åœ¨çš„æ—¶é—´ï¼Œè¿™æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•</span>
<span class="token class-name">LocalDate</span> now <span class="token operator">=</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æ¯ä¸ªå®ä¾‹å¯ä»¥è·å–å®ƒä»¬çš„ part ä¿¡æ¯,å¦‚è·å–å¹´ </span>
<span class="token keyword">int</span> year <span class="token operator">=</span> localDate<span class="token punctuation">.</span><span class="token function">getYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å¯ä»¥ä¿®æ”¹ part ä¿¡æ¯ï¼Œè¿™å°†è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¦‚å¢åŠ ä¸€å¹´</span>
<span class="token class-name">LocalDate</span> localDatePlus <span class="token operator">=</span> localDate<span class="token punctuation">.</span><span class="token function">plusYears</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// è®¾ç½® part ä¿¡æ¯ï¼Œä¹Ÿä¼šè¿”å›æ–°çš„å¯¹è±¡ï¼Œå¦‚è®¾ç½®ä¸º 2017 å¹´ </span>
<span class="token class-name">LocalDate</span> localDateWithYear <span class="token operator">=</span> localDate<span class="token punctuation">.</span><span class="token function">withYear</span><span class="token punctuation">(</span><span class="token number">2017</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æ¯”è¾ƒä¸¤ä¸ªæ—¥æœŸ isAfter,isBefore</span>
<span class="token keyword">boolean</span> after <span class="token operator">=</span> localDate<span class="token punctuation">.</span><span class="token function">isAfter</span><span class="token punctuation">(</span><span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æ ¼å¼åŒ–æ—¥æœŸæ—¶é—´</span>
<span class="token comment">// yyyy-MM-dd</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>now<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token class-name">DateTimeFormatter</span><span class="token punctuation">.</span><span class="token constant">ISO_DATE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// yyyy-MM-ddTHH:mm:ss</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>now<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token class-name">DateTimeFormatter</span><span class="token punctuation">.</span><span class="token constant">ISO_DATE_TIME</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// yyyy-MM-dd HH:mm:ss</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>now<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token class-name">DateTimeFormatter</span><span class="token punctuation">.</span><span class="token function">ofLocalizedDateTime</span><span class="token punctuation">(</span><span class="token class-name">FormatStyle</span><span class="token punctuation">.</span><span class="token constant">MEDIUM</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æ—¥æœŸè§£æ </span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;2019-09-22&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;2019-09-22T21:05:22&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;2019-09-22 21:05:22&quot;</span><span class="token punctuation">,</span><span class="token class-name">DateTimeFormatter</span><span class="token punctuation">.</span><span class="token function">ofLocalizedDateTime</span><span class="token punctuation">(</span><span class="token class-name">FormatStyle</span><span class="token punctuation">.</span><span class="token constant">MEDIUM</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong><code>ZoneId</code> ç”¨æ¥æ“ä½œæ—¶åŒºï¼Œå®ƒæä¾›äº†è·å–æ‰€æœ‰æ—¶åŒºå’Œæœ¬åœ°æ—¶åŒºçš„æ–¹æ³•</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">ZoneId</span> zoneId <span class="token operator">=</span> <span class="token class-name">ZoneId</span><span class="token punctuation">.</span><span class="token function">systemDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> availableZoneIds <span class="token operator">=</span> <span class="token class-name">ZoneId</span><span class="token punctuation">.</span><span class="token function">getAvailableZoneIds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong><code>Period</code>ï¼Œ<code>Duration</code> å¯ä»¥è§†ä¸ºä¸€ç»„ï¼Œç”¨äºè®¡ç®—æ—¶é—´é—´éš”</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// åˆ›å»ºä¸€ä¸ªä¸¤å‘¨çš„é—´éš”</span>
<span class="token class-name">Period</span> periodWeeks <span class="token operator">=</span> <span class="token class-name">Period</span><span class="token punctuation">.</span><span class="token function">ofWeeks</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ä¸€å¹´ä¸‰ä¸ªæœˆé›¶äºŒå¤©çš„é—´éš”</span>
<span class="token class-name">Period</span> custom <span class="token operator">=</span> <span class="token class-name">Period</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ä¸€å¤©çš„æ—¶é•¿</span>
<span class="token class-name">Duration</span> duration <span class="token operator">=</span> <span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofDays</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// è®¡ç®—2015/6/16 å·åˆ°ç°åœ¨ 2019/09/22 è¿‡äº†å¤šä¹…ï¼Œå®ƒè¿™ä¸ªæŠŠé—´éš”åˆ†åˆ°æ¯ä¸ª part äº†</span>
<span class="token class-name">LocalDate</span> now <span class="token operator">=</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">LocalDate</span> customDate <span class="token operator">=</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">2015</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Period</span> between <span class="token operator">=</span> <span class="token class-name">Period</span><span class="token punctuation">.</span><span class="token function">between</span><span class="token punctuation">(</span>customDate<span class="token punctuation">,</span> now<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ç»“æœä¸º 4:3:6 å³è¿‡å»äº† 4å¹´3ä¸ªæœˆ6å¤©äº†</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>between<span class="token punctuation">.</span><span class="token function">getYears</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;:&quot;</span><span class="token operator">+</span>between<span class="token punctuation">.</span><span class="token function">getMonths</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;:&quot;</span><span class="token operator">+</span>between<span class="token punctuation">.</span><span class="token function">getDays</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æ¯”è¾ƒä¸¤ä¸ªç¬æ—¶çš„æ—¶é—´é—´éš” </span>
<span class="token class-name">Instant</span> begin <span class="token operator">=</span> <span class="token class-name">Instant</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Instant</span> end <span class="token operator">=</span> <span class="token class-name">Instant</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">between</span><span class="token punctuation">(</span>begin<span class="token punctuation">,</span>end<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// åŒæ ·å¯ä»¥ä¿®æ”¹ part ä¿¡æ¯å’Œè®¾ç½® part ä¿¡æ¯ï¼Œéƒ½æ˜¯è¿”å›æ–°çš„å¯¹è±¡æ¥è¡¨ç¤ºè®¾ç½®è¿‡çš„å€¼ï¼ŒåŸæ¥çš„å¯¹è±¡ä¸å˜</span>
<span class="token class-name">Period</span> plusDays <span class="token operator">=</span> between<span class="token punctuation">.</span><span class="token function">plusDays</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Period</span> withDays <span class="token operator">=</span> between<span class="token punctuation">.</span><span class="token function">withDays</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="base64"><a href="#base64" class="header-anchor">#</a> Base64</h2> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//ç¼–ç </span>
<span class="token keyword">final</span> <span class="token class-name">String</span> encode <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encodeToString</span><span class="token punctuation">(</span><span class="token string">&quot;è‰¾éŸ¬&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//è§£ç </span>
<span class="token keyword">final</span> <span class="token class-name">String</span> decode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>encode<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h1 id="completablefuture-api"><a href="#completablefuture-api" class="header-anchor">#</a> CompletableFuture API</h1> <p>å‚è€ƒæ–‡ç« ï¼š</p> <ul><li><a href="https://mikechen.cc/15629.html" target="_blank" rel="noopener noreferrer">CompletableFutureåŸç†ä¸ç”¨æ³•è¯¦è§£<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/qq_43803129/article/details/126609353" target="_blank" rel="noopener noreferrer">å¤šçº¿ç¨‹ä¹‹CompletableFutureå…¨æ–¹é¢è§£æ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/qq_38150250/article/details/123294887" target="_blank" rel="noopener noreferrer">CompletableFuture ä½¿ç”¨åŠåº”ç”¨åœºæ™¯<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/CoderBruis/article/details/103181520" target="_blank" rel="noopener noreferrer">æ·±å…¥è§£è¯»CompletableFutureæºç ä¸åŸç†<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/q331464542/article/details/125487318" target="_blank" rel="noopener noreferrer">ã€Javaé¢è¯•ã€‘è¯´ä¸€ä¸‹ä½ å¯¹CompletableFutureçš„ç†è§£<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://zhuanlan.zhihu.com/p/529724020" target="_blank" rel="noopener noreferrer">ã€Œç¾å›¢æŠ€æœ¯å›¢é˜Ÿã€CompletableFutureåŸç†ä¸å®è·µ-å¤–å–å•†å®¶ç«¯å¼‚æ­¥åŒ–<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="åˆ›å»ºå¼‚æ­¥ä»»åŠ¡"><a href="#åˆ›å»ºå¼‚æ­¥ä»»åŠ¡" class="header-anchor">#</a> åˆ›å»ºå¼‚æ­¥ä»»åŠ¡</h2> <h3 id="supplyasync"><a href="#supplyasync" class="header-anchor">#</a> supplyAsync</h3> <p>ä½œç”¨ï¼šåˆ›å»ºä¸€ä¸ª<code>å¸¦è¿”å›å€¼</code>çš„å¼‚æ­¥ä»»åŠ¡ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// é»˜è®¤çº¿ç¨‹æ± </span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> supplier<span class="token punctuation">)</span>
<span class="token comment">// è‡ªå®šä¹‰çº¿ç¨‹æ± </span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> supplier<span class="token punctuation">,</span> <span class="token class-name">Executor</span> executor<span class="token punctuation">)</span>
</code></pre></div><p>åŸºæœ¬ä½¿ç”¨ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testSupplyAsync2</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//supplyAsyncè¡¨ç¤ºåˆ›å»ºå¸¦è¿”å›å€¼çš„å¼‚æ­¥ä»»åŠ¡</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token string">&quot;testSupplyAsync&quot;</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testSupplyAsync1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//supplyAsyncè¡¨ç¤ºåˆ›å»ºå¸¦è¿”å›å€¼çš„å¼‚æ­¥ä»»åŠ¡</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token string">&quot;testSupplyAsync&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="runasync"><a href="#runasync" class="header-anchor">#</a> runAsync</h3> <p>ä½œç”¨ï¼šåˆ›å»ºä¸€ä¸ª<code>ä¸å¸¦è¿”å›å€¼</code>çš„å¼‚æ­¥ä»»åŠ¡ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// é»˜è®¤çº¿ç¨‹æ± </span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">runAsync</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> runnable<span class="token punctuation">)</span>
 
<span class="token comment">// è‡ªå®šä¹‰çº¿ç¨‹æ± </span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">runAsync</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> runnable<span class="token punctuation">,</span> <span class="token class-name">Executor</span> executor<span class="token punctuation">)</span>
</code></pre></div><p>åŸºç¡€ä½¿ç”¨ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testRunAsync2</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//runAsyncè¡¨ç¤ºåˆ›å»ºæ— è¿”å›å€¼çš„å¼‚æ­¥ä»»åŠ¡, è‡ªå®šä¹‰çº¿ç¨‹æ± </span>
    <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">runAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;testRunAsync2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testRunAsync1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//runAsyncè¡¨ç¤ºåˆ›å»ºæ— è¿”å›å€¼çš„å¼‚æ­¥ä»»åŠ¡, ä½¿ç”¨é»˜è®¤çº¿ç¨‹æ± </span>
    <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">runAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;testRunAsync&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="è·å–å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œç»“æœ"><a href="#è·å–å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œç»“æœ" class="header-anchor">#</a> è·å–å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œç»“æœ</h2> <h3 id="é˜»å¡å¼è·å–æ‰§è¡Œç»“æœ"><a href="#é˜»å¡å¼è·å–æ‰§è¡Œç»“æœ" class="header-anchor">#</a> é˜»å¡å¼è·å–æ‰§è¡Œç»“æœ</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// å¦‚æœä»»åŠ¡æ­£å¸¸å®Œæˆå°±è¿”å›ç»“æœï¼Œå¦åˆ™å°±æŠ›å‡ºå¼‚å¸¸</span>
<span class="token comment">// ç›´æ¥æŠ›å‡ºå¼‚å¸¸</span>
<span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span><span class="token punctuation">,</span> <span class="token class-name">ExecutionException</span><span class="token punctuation">;</span>
<span class="token comment">// å¦‚æœåœ¨æŒ‡å®šæ—¶é—´å†…å®Œæˆä»»åŠ¡å°±è¿”å›ç»“æœï¼Œå¦åˆ™å°±æŠ›å‡ºå¼‚å¸¸</span>
<span class="token comment">// ç›´æ¥æŠ›å‡ºå¼‚å¸¸</span>
<span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">long</span> timeout<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span> unit<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span><span class="token punctuation">,</span> <span class="token class-name">ExecutionException</span><span class="token punctuation">,</span> <span class="token class-name">TimeoutException</span><span class="token punctuation">;</span>
<span class="token comment">// å¦‚æœä»»åŠ¡æ­£å¸¸å®Œæˆå°±è¿”å›ç»“æœï¼Œå¦åˆ™å°±æŠ›å‡ºå¼‚å¸¸</span>
<span class="token comment">// é—´æ¥æŠ›å‡ºå¼‚å¸¸</span>
<span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// å¦‚æœä»»åŠ¡æ­£å¸¸å®Œæˆåˆ™è¿”å›ç»“æœå€¼ï¼›å¦‚æœä»»åŠ¡å¼‚å¸¸å®Œæˆåˆ™æŠ›å‡ºé‡åˆ°çš„å¼‚å¸¸ï¼›å¦åˆ™è¿”å›ç»™å®šçš„valueIfAbsentå€¼</span>
<span class="token comment">// é—´æ¥æŠ›å‡ºå¼‚å¸¸</span>
<span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">getNow</span><span class="token punctuation">(</span><span class="token class-name">T</span> valueIfAbsent<span class="token punctuation">)</span>
</code></pre></div><h3 id="ä¸»åŠ¨å®Œæˆä»»åŠ¡"><a href="#ä¸»åŠ¨å®Œæˆä»»åŠ¡" class="header-anchor">#</a> ä¸»åŠ¨å®Œæˆä»»åŠ¡</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// å°†å¼‚æ­¥ä»»åŠ¡çš„ç»“æœè®¾ç½®ä¸º value å€¼ï¼ˆæ­£å¸¸ç»“æœï¼‰ï¼›å¦‚æœCompletableFutureè½¬æ¢ä¸ºå·²å®ŒæˆçŠ¶æ€ï¼Œåˆ™ä¸ºtrueï¼Œå¦åˆ™ä¸ºfalseã€‚</span>
<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">complete</span><span class="token punctuation">(</span><span class="token class-name">T</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// å°†å¼‚æ­¥ä»»åŠ¡çš„ç»“æœè®¾ç½®ä¸º ex å€¼ï¼ˆå¼‚å¸¸ç»“æœï¼‰ï¼›å¦‚æœCompletableFutureè½¬æ¢ä¸ºå·²å®ŒæˆçŠ¶æ€ï¼Œåˆ™ä¸ºtrueï¼Œå¦åˆ™ä¸ºfalseã€‚</span>
<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">completeExceptionally</span><span class="token punctuation">(</span><span class="token class-name">Throwable</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>åŸºæœ¬ä½¿ç”¨ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestCompleteAndCompleteExceptionally</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Double</span><span class="token punctuation">&gt;</span></span> <span class="token function">async</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Double</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¦èµ·ä¸€ä¸ªçº¿ç¨‹ï¼Œç”¨æ¥è®¡ç®—å€¼</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Thread-&quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">double</span> value <span class="token operator">=</span> <span class="token function">div</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// å°†å¼‚æ­¥ä»»åŠ¡è®¡ç®—å¾—åˆ°çš„ç»“æœè®¾ç½®CompletableFutureä¸­</span>
                <span class="token comment">// è®¾ç½®æ­£å¸¸ç»“æœ</span>
                future<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> <span class="token operator">|</span> <span class="token class-name">ArithmeticException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// è®¾ç½®å¼‚å¸¸ç»“æœ</span>
                future<span class="token punctuation">.</span><span class="token function">completeExceptionally</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;å¼‚å¸¸ç»“æœ&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ— éœ€ç­‰å¾…è®¡ç®—ç»“æœ, ç›´æ¥è¿”å›</span>
        <span class="token keyword">return</span> future<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">double</span> <span class="token function">div</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>y <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ArithmeticException</span><span class="token punctuation">(</span><span class="token string">&quot;é™¤æ•°ä¸èƒ½ä¸ºé›¶&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> x <span class="token operator">/</span> y<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ­£å¸¸</span>
        <span class="token comment">// CompletableFuture&lt;Double&gt; future = async(20, 5);</span>
        <span class="token comment">// å¼‚å¸¸</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Double</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span> <span class="token function">async</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ä¸»çº¿ç¨‹è°ƒç”¨ join è·å–å¼‚æ­¥ä»»åŠ¡è®¡ç®—ç»“æœï¼Œæ­¤æ—¶ä¼šé˜»å¡ï¼Œç›´åˆ°ä»»åŠ¡è¿”å›ç»“æœ</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å¼‚æ­¥ä»»åŠ¡ç»“æœ: &quot;</span> <span class="token operator">+</span> future<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ä¸»çº¿ç¨‹å®Œæˆä»»åŠ¡~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="å¼‚æ­¥ä»»åŠ¡å›è°ƒ"><a href="#å¼‚æ­¥ä»»åŠ¡å›è°ƒ" class="header-anchor">#</a> å¼‚æ­¥ä»»åŠ¡å›è°ƒ</h2> <p><img src="https://img-blog.csdnimg.cn/ae0711a2990642c19fe4addcc9244dbc.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> <h3 id="thenapply-thenapplyasync"><a href="#thenapply-thenapplyasync" class="header-anchor">#</a> thenApply &amp; thenApplyAsync</h3> <p>thenApply &amp; thenApplyAsyncè¡¨ç¤ºç­‰å¾…æŸä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼ˆé€šå¸¸æŒ‡supplyAsyncï¼‰æ‰§è¡Œå®Œæˆåè¦æ‰§è¡Œçš„å›è°ƒæ–¹æ³•ï¼Œè¯¥å›è°ƒæ–¹æ³•<code>æœ‰å…¥å‚ï¼Œæœ‰è¿”å›å€¼</code>ã€‚å®ƒéœ€è¦å°†å¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œç»“æœä½œä¸ºå…¥å‚ä¼ é€’åˆ°å›è°ƒæ–¹æ³•ä¸­ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ç»“æœå€¼ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// fnï¼šå›è°ƒæ–¹æ³•</span>
<span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token function">thenApply</span><span class="token punctuation">(</span><span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">,</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token function">thenApplyAsync</span><span class="token punctuation">(</span><span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">,</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// executorï¼šè‡ªå®šä¹‰çº¿ç¨‹æ± </span>
<span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token function">thenApplyAsync</span><span class="token punctuation">(</span><span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">,</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> fn<span class="token punctuation">,</span> <span class="token class-name">Executor</span> executor<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>åŸºæœ¬ä½¿ç”¨ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestThenApplyAndThenApplyAsync</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token class-name">T</span> data<span class="token punctuation">,</span> <span class="token keyword">long</span> second<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;==================&quot;</span> <span class="token operator">+</span> data <span class="token operator">+</span> <span class="token string">&quot;===================&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;returnOneData: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// å…¥å‚dataçš„å€¼å°±æ˜¯supplyAsyncå¼‚æ­¥ä»»åŠ¡çš„è¿”å›ç»“æœå€¼</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">handleOneData</span><span class="token punctuation">(</span><span class="token class-name">T</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;handleOneData: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¯¹å•æ¡æ•°æ®è¿›è¡Œå¤„ç†</span>
        <span class="token class-name">String</span> newData <span class="token operator">=</span> <span class="token string">&quot;handleOneData#&quot;</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;data:&quot;</span> <span class="token operator">+</span> newData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span>newData<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// thenApply</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testThenApply</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testThenApply&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">thenApply</span><span class="token punctuation">(</span><span class="token class-name">TestThenApplyAndThenApplyAsync</span><span class="token operator">::</span><span class="token function">handleOneData</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ:&quot;</span> <span class="token operator">+</span> future<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// thenApplyAsync</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testThenApplyAsync</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span>
            <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testThenApplyAsync&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span><span class="token class-name">TestThenApplyAndThenApplyAsync</span><span class="token operator">::</span><span class="token function">handleOneData</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ:&quot;</span> <span class="token operator">+</span> future<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ThreadPoolExecutor</span> pool <span class="token operator">=</span>
            <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MILLISECONDS</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">testThenApply</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">testThenApplyAsync</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æµ‹è¯•ç»“æœï¼š</p> <p><img src="assets%5C1669889305076.png" alt="1669799310902"></p> <blockquote><p><strong>thenApply &amp; thenApplyAsyncçš„åŒºåˆ«?</strong></p> <ol><li>thenApply æ˜¯ç”±æ‰§è¡Œä»»åŠ¡(returnOneData)çš„çº¿ç¨‹ç«‹å³æ‰§è¡Œä»»åŠ¡(handleOneData)ï¼Œå³<code>ä¸¤ä¸ªä»»åŠ¡éƒ½ç”±åŒä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ</code>ã€‚</li> <li>thenApplyAsync æ˜¯å°†ä»»åŠ¡(handleOneData)æäº¤åˆ°çº¿ç¨‹æ± ä¸­å¼‚æ­¥æ‰§è¡Œï¼Œå®é™…æ‰§è¡Œä»»åŠ¡(handleOneData)çš„çº¿ç¨‹å¯èƒ½æ˜¯å¦å¤–ä¸€ä¸ªçº¿ç¨‹ï¼Œå³<code>å°†ä¸åŒä»»åŠ¡äº¤ç”±ä¸åŒçº¿ç¨‹æ‰§è¡Œ</code>ã€‚</li></ol></blockquote> <h3 id="thenaccept-thenacceptasync"><a href="#thenaccept-thenacceptasync" class="header-anchor">#</a> thenAccept &amp; thenAcceptAsync</h3> <p>thenAccept &amp; thenAcceptAsyncè¡¨ç¤ºç­‰å¾…æŸä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼ˆé€šå¸¸æŒ‡supplyAsyncï¼‰æ‰§è¡Œå®Œæˆåè¦æ‰§è¡Œçš„å›è°ƒæ–¹æ³•ï¼Œè¯¥å›è°ƒæ–¹æ³•<code>æœ‰å…¥å‚ï¼Œä½†æ— è¿”å›å€¼</code>ã€‚å®ƒéœ€è¦å°†å¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œç»“æœä½œä¸ºå…¥å‚ä¼ é€’åˆ°å›è°ƒæ–¹æ³•ä¸­ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">thenAccept</span><span class="token punctuation">(</span><span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">thenAcceptAsync</span><span class="token punctuation">(</span><span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">thenAcceptAsync</span><span class="token punctuation">(</span><span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> action<span class="token punctuation">,</span> <span class="token class-name">Executor</span> executor<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>åŸºæœ¬ä½¿ç”¨ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestThenAcceptAndThenAcceptAsync</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token class-name">T</span> data<span class="token punctuation">,</span> <span class="token keyword">long</span> second<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;==================&quot;</span> <span class="token operator">+</span> data <span class="token operator">+</span> <span class="token string">&quot;===================&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;returnOneData: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// å…¥å‚dataçš„å€¼å°±æ˜¯supplyAsyncå¼‚æ­¥ä»»åŠ¡çš„è¿”å›ç»“æœå€¼</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">handleOneData</span><span class="token punctuation">(</span><span class="token class-name">T</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;handleOneData: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¯¹å•æ¡æ•°æ®è¿›è¡Œå¤„ç†</span>
        <span class="token class-name">String</span> newData <span class="token operator">=</span> <span class="token string">&quot;handleOneData#&quot;</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;data:&quot;</span> <span class="token operator">+</span> newData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span>newData<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// thenAcceptåŒthenApply,æ¥æ”¶ä¸Šä¸€ä¸ªä»»åŠ¡çš„è¿”å›å€¼ä½œä¸ºå‚æ•°,ä½†æ˜¯æ— è¿”å›å€¼</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testThenAccept</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testThenAccept&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">thenAccept</span><span class="token punctuation">(</span><span class="token class-name">TestThenAcceptAndThenAcceptAsync</span><span class="token operator">::</span><span class="token function">handleOneData</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ:&quot;</span> <span class="token operator">+</span> future<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// thenAcceptAsyncåŒthenApplyAsync,æ¥æ”¶ä¸Šä¸€ä¸ªä»»åŠ¡çš„è¿”å›å€¼ä½œä¸ºå‚æ•°,ä½†æ˜¯æ— è¿”å›å€¼</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testThenAcceptAsync</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span>
            <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testThenAcceptAsync&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenAcceptAsync</span><span class="token punctuation">(</span><span class="token class-name">TestThenAcceptAndThenAcceptAsync</span><span class="token operator">::</span><span class="token function">handleOneData</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ:&quot;</span> <span class="token operator">+</span> future<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ThreadPoolExecutor</span> pool <span class="token operator">=</span>
            <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MILLISECONDS</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">testThenAccept</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">testThenAcceptAsync</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æµ‹è¯•ç»“æœï¼š</p> <p><img src="assets%5C1669889388322.png" alt="1669800849306"></p> <blockquote><p><strong>thenAccept &amp; thenAcceptAsyncçš„åŒºåˆ«?</strong></p> <ol><li>thenAccept æ˜¯ç”±æ‰§è¡Œä»»åŠ¡(returnOneData)çš„çº¿ç¨‹ç«‹å³æ‰§è¡Œä»»åŠ¡(handleOneData)ï¼Œå³<code>ä¸¤ä¸ªä»»åŠ¡éƒ½ç”±åŒä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ</code>ã€‚</li> <li>thenAcceptAsync æ˜¯å°†ä»»åŠ¡(handleOneData)æäº¤åˆ°çº¿ç¨‹æ± ä¸­å¼‚æ­¥æ‰§è¡Œï¼Œå®é™…æ‰§è¡Œä»»åŠ¡(handleOneData)çš„çº¿ç¨‹å¯èƒ½æ˜¯å¦å¤–ä¸€ä¸ªçº¿ç¨‹ï¼Œå³<code>å°†ä¸åŒä»»åŠ¡äº¤ç”±ä¸åŒçº¿ç¨‹æ‰§è¡Œ</code>ã€‚</li></ol></blockquote> <h3 id="thenrun-thenrunasync"><a href="#thenrun-thenrunasync" class="header-anchor">#</a> thenRun &amp; thenRunAsync</h3> <p>thenRun &amp; thenRunAsyncè¡¨ç¤ºç­‰å¾…æŸä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼ˆé€šå¸¸æŒ‡supplyAsyncï¼‰æ‰§è¡Œå®Œæˆåè¦æ‰§è¡Œçš„å›è°ƒæ–¹æ³•ï¼Œè¯¥å›è°ƒæ–¹æ³•<code>æœ‰å…¥å‚ï¼Œæœ‰è¿”å›å€¼</code>ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">thenRun</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">thenRunAsync</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">thenRunAsync</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> action<span class="token punctuation">,</span> <span class="token class-name">Executor</span> executor<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>åŸºæœ¬ä½¿ç”¨ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestThenRunAndThenRunAsync</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token class-name">T</span> data<span class="token punctuation">,</span> <span class="token keyword">long</span> second<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;==================&quot;</span> <span class="token operator">+</span> data <span class="token operator">+</span> <span class="token string">&quot;===================&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;returnOneData: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;handle: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testThenRunAsync</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è¿”å›ç±»å‹æ˜¯Voidï¼Œæ— è¿”å›å€¼</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testThenRunAsync&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">thenRunAsync</span><span class="token punctuation">(</span><span class="token class-name">TestThenRunAndThenRunAsync</span><span class="token operator">::</span><span class="token function">handle</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ:&quot;</span> <span class="token operator">+</span> future<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testThenRun</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è¿”å›ç±»å‹æ˜¯Voidï¼Œæ— è¿”å›å€¼</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testThenRun&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">thenRun</span><span class="token punctuation">(</span><span class="token class-name">TestThenRunAndThenRunAsync</span><span class="token operator">::</span><span class="token function">handle</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ:&quot;</span> <span class="token operator">+</span> future<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ThreadPoolExecutor</span> pool <span class="token operator">=</span>
            <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MILLISECONDS</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">testThenRun</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">testThenRunAsync</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æµ‹è¯•ç»“æœï¼š</p> <p><img src="assets%5C1669889201492.png" alt="1669889201492"></p> <blockquote><p><strong>thenRun &amp; thenRunAsyncçš„åŒºåˆ«?</strong></p> <ol><li>thenRun æ˜¯ç”±æ‰§è¡Œä»»åŠ¡(returnOneData)çš„çº¿ç¨‹ç«‹å³æ‰§è¡Œä»»åŠ¡(handle)ï¼Œå³<code>ä¸¤ä¸ªä»»åŠ¡éƒ½ç”±åŒä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ</code>ã€‚</li> <li>thenRunAsync æ˜¯å°†ä»»åŠ¡(handle)æäº¤åˆ°çº¿ç¨‹æ± ä¸­å¼‚æ­¥æ‰§è¡Œï¼Œå®é™…æ‰§è¡Œä»»åŠ¡(handle)çš„çº¿ç¨‹å¯èƒ½æ˜¯å¦å¤–ä¸€ä¸ªçº¿ç¨‹ï¼Œå³<code>å°†ä¸åŒä»»åŠ¡äº¤ç”±ä¸åŒçº¿ç¨‹æ‰§è¡Œ</code>ã€‚</li></ol></blockquote> <h3 id="whencomplete-whencompleteasync"><a href="#whencomplete-whencompleteasync" class="header-anchor">#</a> whenComplete &amp; whenCompleteAsync</h3> <p>whenComplete &amp; whenCompleteAsyncè¡¨ç¤ºç­‰å¾…æŸä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼ˆé€šå¸¸æŒ‡supplyAsyncï¼‰æ‰§è¡Œå®Œæˆåè¦æ‰§è¡Œçš„å›è°ƒæ–¹æ³•ï¼Œè¯¥å›è°ƒæ–¹æ³•<code>æœ‰å…¥å‚ï¼Œæ— è¿”å›å€¼</code>ã€‚å®ƒéœ€è¦å°†<strong>å¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œç»“æœå’Œå¼‚æ­¥ä»»åŠ¡æ‰§è¡Œæ—¶æŠ›å‡ºçš„å¼‚å¸¸</strong>ä½œä¸ºå…¥å‚ä¼ é€’åˆ°å›è°ƒæ–¹æ³•ä¸­ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">whenComplete</span><span class="token punctuation">(</span><span class="token class-name">BiConsumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">Throwable</span><span class="token punctuation">&gt;</span></span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">whenCompleteAsync</span><span class="token punctuation">(</span><span class="token class-name">BiConsumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">Throwable</span><span class="token punctuation">&gt;</span></span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">whenCompleteAsync</span><span class="token punctuation">(</span><span class="token class-name">BiConsumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">Throwable</span><span class="token punctuation">&gt;</span></span> action<span class="token punctuation">,</span> <span class="token class-name">Executor</span> executor<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>åŸºæœ¬ä½¿ç”¨ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestWhenCompleteAndWhenCompleteAsync</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token class-name">T</span> data<span class="token punctuation">,</span> <span class="token keyword">long</span> second<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;==================&quot;</span> <span class="token operator">+</span> data <span class="token operator">+</span> <span class="token string">&quot;===================&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;returnOneData: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// å…¥å‚dataçš„å€¼å°±æ˜¯supplyAsyncå¼‚æ­¥ä»»åŠ¡çš„è¿”å›ç»“æœå€¼</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">handleOneData</span><span class="token punctuation">(</span><span class="token class-name">T</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;handleOneData: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¯¹å•æ¡æ•°æ®è¿›è¡Œå¤„ç†</span>
        <span class="token class-name">String</span> newData <span class="token operator">=</span> <span class="token string">&quot;handleOneData#&quot;</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;data:&quot;</span> <span class="token operator">+</span> newData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span>newData<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testWhenComplete</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span>
            <span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testWhenComplete&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">whenComplete</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> error<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token class-name">String</span> newData <span class="token operator">=</span> <span class="token function">handleOneData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;é”™è¯¯ä¿¡æ¯:&quot;</span> <span class="token operator">+</span> error<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;whenCompleteä¸­çš„data:&quot;</span> <span class="token operator">+</span> newData<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ:&quot;</span> <span class="token operator">+</span> future<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testWhenCompleteAsync</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span>
            <span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testWhenCompleteAsync&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">whenCompleteAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> error<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token class-name">String</span> newData <span class="token operator">=</span> <span class="token function">handleOneData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;é”™è¯¯ä¿¡æ¯:&quot;</span> <span class="token operator">+</span> error<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;whenCompleteAsyncä¸­çš„data:&quot;</span> <span class="token operator">+</span> newData<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ:&quot;</span> <span class="token operator">+</span> future<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ThreadPoolExecutor</span> pool <span class="token operator">=</span>
            <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MILLISECONDS</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">testWhenComplete</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">testWhenCompleteAsync</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æµ‹è¯•ç»“æœï¼š</p> <p><img src="assets%5C1669889131813.png" alt="1669802248889"></p> <blockquote><p><strong>whenComplete &amp; whenCompleteAsyncçš„åŒºåˆ«?</strong></p> <ol><li>whenComplete æ˜¯ç”±æ‰§è¡Œä»»åŠ¡(returnOneData)çš„çº¿ç¨‹ç«‹å³æ‰§è¡Œä»»åŠ¡(handleOneData)ï¼Œå³<code>ä¸¤ä¸ªä»»åŠ¡éƒ½ç”±åŒä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ</code>ã€‚</li> <li>whenCompleteAsync æ˜¯å°†ä»»åŠ¡(handleOneData)æäº¤åˆ°çº¿ç¨‹æ± ä¸­å¼‚æ­¥æ‰§è¡Œï¼Œå®é™…æ‰§è¡Œä»»åŠ¡(handleOneData)çš„çº¿ç¨‹å¯èƒ½æ˜¯å¦å¤–ä¸€ä¸ªçº¿ç¨‹ï¼Œå³<code>å°†ä¸åŒä»»åŠ¡äº¤ç”±ä¸åŒçº¿ç¨‹æ‰§è¡Œ</code>ã€‚</li></ol></blockquote> <h3 id="handle-handleasync"><a href="#handle-handleasync" class="header-anchor">#</a> handle &amp; handleAsync</h3> <p>handle &amp; handleAsyncè¡¨ç¤ºç­‰å¾…æŸä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼ˆé€šå¸¸æŒ‡supplyAsyncï¼‰æ‰§è¡Œå®Œæˆåè¦æ‰§è¡Œçš„å›è°ƒæ–¹æ³•ï¼Œè¯¥å›è°ƒæ–¹æ³•<code>æœ‰å…¥å‚ï¼Œæœ‰è¿”å›å€¼</code>ã€‚å®ƒéœ€è¦å°†<strong>å¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œç»“æœå’Œå¼‚æ­¥ä»»åŠ¡æ‰§è¡Œæ—¶æŠ›å‡ºçš„å¼‚å¸¸</strong>ä½œä¸ºå…¥å‚ä¼ é€’åˆ°å›è°ƒæ–¹æ³•ä¸­ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ç»“æœå€¼ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token class-name">BiFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">Throwable</span><span class="token punctuation">,</span> <span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">handleAsync</span><span class="token punctuation">(</span><span class="token class-name">BiFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">Throwable</span><span class="token punctuation">,</span> <span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">handleAsync</span><span class="token punctuation">(</span><span class="token class-name">BiFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">Throwable</span><span class="token punctuation">,</span> <span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> fn<span class="token punctuation">,</span> <span class="token class-name">Executor</span> executor<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>åŸºæœ¬ä½¿ç”¨ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestHandleAndHandleAsync</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token class-name">T</span> data<span class="token punctuation">,</span> <span class="token keyword">long</span> second<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;==================&quot;</span> <span class="token operator">+</span> data <span class="token operator">+</span> <span class="token string">&quot;===================&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;returnOneData: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// å…¥å‚dataçš„å€¼å°±æ˜¯supplyAsyncå¼‚æ­¥ä»»åŠ¡çš„è¿”å›ç»“æœå€¼</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">handleOneData</span><span class="token punctuation">(</span><span class="token class-name">T</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;handleOneData: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¯¹å•æ¡æ•°æ®è¿›è¡Œå¤„ç†</span>
        <span class="token class-name">String</span> newData <span class="token operator">=</span> <span class="token string">&quot;handleOneData#&quot;</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;data:&quot;</span> <span class="token operator">+</span> newData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span>newData<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testHandleAsync</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span>
            <span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testHandleAsync&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">handleAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> error<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token class-name">String</span> newData <span class="token operator">=</span> <span class="token function">handleOneData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;é”™è¯¯ä¿¡æ¯:&quot;</span> <span class="token operator">+</span> error<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;handleAsyncä¸­çš„data:&quot;</span> <span class="token operator">+</span> newData<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> newData<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ:&quot;</span> <span class="token operator">+</span> future<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testHandle</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span>
            <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testHandle&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> error<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token class-name">String</span> newData <span class="token operator">=</span> <span class="token function">handleOneData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;é”™è¯¯ä¿¡æ¯:&quot;</span> <span class="token operator">+</span> error<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;handleä¸­çš„data:&quot;</span> <span class="token operator">+</span> newData<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> newData<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ:&quot;</span> <span class="token operator">+</span> future<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ThreadPoolExecutor</span> pool <span class="token operator">=</span>
            <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MILLISECONDS</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">testHandle</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">testHandleAsync</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æµ‹è¯•ç»“æœï¼š</p> <p><img src="assets%5C1669889462841.png" alt="1669889462841"></p> <blockquote><p><strong>handle &amp; handleAsyncçš„åŒºåˆ«?</strong></p> <ol><li>handle æ˜¯ç”±æ‰§è¡Œä»»åŠ¡(returnOneData)çš„çº¿ç¨‹ç«‹å³æ‰§è¡Œä»»åŠ¡(handleOneData)ï¼Œå³<code>ä¸¤ä¸ªä»»åŠ¡éƒ½ç”±åŒä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ</code>ã€‚</li> <li>handleAsync æ˜¯å°†ä»»åŠ¡(handleOneData)æäº¤åˆ°çº¿ç¨‹æ± ä¸­å¼‚æ­¥æ‰§è¡Œï¼Œå®é™…æ‰§è¡Œä»»åŠ¡(handleOneData)çš„çº¿ç¨‹å¯èƒ½æ˜¯å¦å¤–ä¸€ä¸ªçº¿ç¨‹ï¼Œå³<code>å°†ä¸åŒä»»åŠ¡äº¤ç”±ä¸åŒçº¿ç¨‹æ‰§è¡Œ</code>ã€‚</li></ol></blockquote> <h3 id="exceptionally-exceptionallyasync"><a href="#exceptionally-exceptionallyasync" class="header-anchor">#</a> exceptionally &amp; exceptionallyAsync</h3> <p>exceptionally &amp; exceptionallyAsyncè¡¨ç¤ºç­‰å¾…æŸä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼ˆé€šå¸¸æŒ‡supplyAsyncï¼‰æ‰§è¡Œå®Œæˆåè¦æ‰§è¡Œçš„å›è°ƒæ–¹æ³•ã€‚å®ƒéœ€è¦å°†<strong>å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œæ—¶æŠ›å‡ºçš„å¼‚å¸¸</strong>ä½œä¸ºå…¥å‚ä¼ é€’åˆ°å›è°ƒæ–¹æ³•ä¸­ï¼Œåªæœ‰å¼‚æ­¥ä»»åŠ¡å¼‚å¸¸å®Œæˆæ—¶ï¼Œå›è°ƒæ–¹æ³•æ‰ä¼šè¢«è°ƒç”¨ã€‚</p> <p>æ³¨ï¼šexceptionally &amp; exceptionallyAsyncæ–¹æ³•é€šå¸¸ç”¨æ¥å¤„ç†Â·å¼‚æ­¥ä»»åŠ¡å¼‚å¸¸å·¥ä½œåè¦åšçš„åç»­å·¥ä½œã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestExceptionallyAndExceptionallyAsync</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token class-name">T</span> data<span class="token punctuation">,</span> <span class="token keyword">long</span> second<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;==================&quot;</span> <span class="token operator">+</span> data <span class="token operator">+</span> <span class="token string">&quot;===================&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;returnOneData: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// æ¨¡æ‹Ÿå¼‚å¸¸</span>
            <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">caughtException</span><span class="token punctuation">(</span><span class="token class-name">Throwable</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;caughtException: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>t <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            t<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token string">&quot;caughtException&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testExceptionally</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span>
            <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testExceptionally&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">exceptionally</span><span class="token punctuation">(</span><span class="token class-name">TestExceptionallyAndExceptionallyAsync</span><span class="token operator">::</span><span class="token function">caughtException</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ:&quot;</span> <span class="token operator">+</span> future<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testExceptionallyAsync</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span>
            <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testExceptionallyAsync&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">exceptionallyAsync</span><span class="token punctuation">(</span><span class="token class-name">TestExceptionallyAndExceptionallyAsync</span><span class="token operator">::</span><span class="token function">caughtException</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ:&quot;</span> <span class="token operator">+</span> future<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ThreadPoolExecutor</span> pool <span class="token operator">=</span>
            <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MILLISECONDS</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">testExceptionally</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">testExceptionallyAsync</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æµ‹è¯•ç»“æœï¼š</p> <p><img src="assets%5C1669808188516.png" alt="exceptionallyæ­£å¸¸æƒ…å†µ"></p> <p><img src="assets%5C1669808223038.png" alt="exceptionallyå¼‚å¸¸æƒ…å†µ"></p> <p><img src="assets%5C1669808284953.png" alt="exceptionallyAsyncæ­£å¸¸æƒ…å†µ"></p> <p><img src="assets%5C1669808257588.png" alt="exceptionallyAsyncå¼‚å¸¸æƒ…å†µ"></p> <blockquote><p><strong>exceptionally &amp; exceptionallyAsyncçš„åŒºåˆ«?</strong></p> <ol><li>exceptionally æ˜¯ç”±æ‰§è¡Œä»»åŠ¡(returnOneData)çš„çº¿ç¨‹ç«‹å³æ‰§è¡Œä»»åŠ¡(caughtException)ï¼Œå³<code>ä¸¤ä¸ªä»»åŠ¡éƒ½ç”±åŒä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ</code>ã€‚</li> <li>exceptionallyAsync æ˜¯å°†ä»»åŠ¡(caughtException)æäº¤åˆ°çº¿ç¨‹æ± ä¸­å¼‚æ­¥æ‰§è¡Œï¼Œå®é™…æ‰§è¡Œä»»åŠ¡(caughtException)çš„çº¿ç¨‹å¯èƒ½æ˜¯å¦å¤–ä¸€ä¸ªçº¿ç¨‹ï¼Œå³<code>å°†ä¸åŒä»»åŠ¡äº¤ç”±ä¸åŒçº¿ç¨‹æ‰§è¡Œ</code>ã€‚</li></ol></blockquote> <h2 id="å¤šå¼‚æ­¥ä»»åŠ¡"><a href="#å¤šå¼‚æ­¥ä»»åŠ¡" class="header-anchor">#</a> å¤šå¼‚æ­¥ä»»åŠ¡</h2> <p><img src="https://img-blog.csdnimg.cn/9cc45ca494b4448285944dc1fc508cd5.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> <h3 id="andç»„åˆ"><a href="#andç»„åˆ" class="header-anchor">#</a> andç»„åˆ</h3> <p><strong>Andç»„åˆ</strong>ï¼šæŒ‡==å°†ä¸¤ä¸ªCompletableFutureç»„åˆèµ·æ¥ï¼Œåªæœ‰ä¸¤ä¸ªCompletableFutureéƒ½æ­£å¸¸æ‰§è¡Œå®Œï¼Œæ‰ä¼šæ‰§è¡ŒæŸä¸ªä»»åŠ¡==ã€‚</p> <h4 id="thencombine-thencombineasync"><a href="#thencombine-thencombineasync" class="header-anchor">#</a> thenCombine &amp; thenCombineAsync</h4> <p>thenCombine &amp; thenCombineAsyncä¼šå°†ä¸¤ä¸ªä»»åŠ¡çš„æ‰§è¡Œç»“æœä½œä¸ºæ–¹æ³•å…¥å‚ä¼ é€’åˆ°æŒ‡å®šæ–¹æ³•ä¸­ï¼Œå¹¶ä¸”æœ‰è¿”å›å€¼ï¼ˆ<code>æœ‰å…¥å‚ï¼Œæœ‰è¿”å›å€¼</code>ï¼‰ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @param other è¦åˆå¹¶çš„å¼‚æ­¥ä»»åŠ¡
 * @param fn å›è°ƒå‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°åŒ…å«2çš„å…¥å‚ï¼Œparam1ï¼šå½“å‰å¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œç»“æœï¼Œparam2ï¼šotherå¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œç»“æœ
 */</span>
<span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token function">thenCombine</span><span class="token punctuation">(</span><span class="token class-name">CompletionStage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> other<span class="token punctuation">,</span> <span class="token class-name">BiFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">,</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">U</span><span class="token punctuation">,</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * @param other è¦åˆå¹¶çš„å¼‚æ­¥ä»»åŠ¡
 * @param fn å›è°ƒå‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°åŒ…å«2çš„å…¥å‚ï¼Œparam1ï¼šå½“å‰å¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œç»“æœï¼Œparam2ï¼šotherå¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œç»“æœ
 */</span>
<span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token function">thenCombineAsync</span><span class="token punctuation">(</span><span class="token class-name">CompletionStage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> other<span class="token punctuation">,</span> <span class="token class-name">BiFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">,</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">U</span><span class="token punctuation">,</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * @param other è¦åˆå¹¶çš„å¼‚æ­¥ä»»åŠ¡
 * @param fn å›è°ƒå‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°åŒ…å«2çš„å…¥å‚ï¼Œparam1ï¼šå½“å‰å¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œç»“æœï¼Œparam2ï¼šotherå¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œç»“æœ
 * @param executor è‡ªå®šä¹‰çº¿ç¨‹æ± 
 */</span>
<span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token function">thenCombineAsync</span><span class="token punctuation">(</span><span class="token class-name">CompletionStage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> other<span class="token punctuation">,</span> <span class="token class-name">BiFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">,</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">U</span><span class="token punctuation">,</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> fn<span class="token punctuation">,</span> <span class="token class-name">Executor</span> executor<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>åŸºæœ¬ä½¿ç”¨ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestThenCombineAndThenCombineAsync</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token class-name">T</span> data<span class="token punctuation">,</span> <span class="token keyword">long</span> second<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;==================&quot;</span> <span class="token operator">+</span> data <span class="token operator">+</span> <span class="token string">&quot;===================&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;returnOneData: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// æ¨¡æ‹Ÿå¼‚å¸¸</span>
            <span class="token comment">// int n = 1 / 0;</span>
            <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">,</span> <span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">V</span> <span class="token function">combineResult</span><span class="token punctuation">(</span><span class="token class-name">V</span> secondResult<span class="token punctuation">,</span> <span class="token class-name">U</span> firstResult<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;combineResult: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å¼‚æ­¥ä»»åŠ¡1çš„ç»“æœ: &quot;</span> <span class="token operator">+</span> firstResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å¼‚æ­¥ä»»åŠ¡2çš„ç»“æœ: &quot;</span> <span class="token operator">+</span> secondResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">V</span><span class="token punctuation">)</span><span class="token string">&quot;firstTaskä¸secondTaskå¼‚æ­¥ä»»åŠ¡éƒ½æ­£å¸¸æ‰§è¡Œå®Œäº†&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testThenCombine</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f1 <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">completedFuture</span><span class="token punctuation">(</span><span class="token string">&quot;testThenCombine-1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å½“å‰å¼‚æ­¥ä»»åŠ¡è¦åˆå¹¶firstTaskå¼‚æ­¥ä»»åŠ¡</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f2 <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testThenCombine-2&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">thenCombine</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span> <span class="token class-name">TestThenCombineAndThenCombineAsync</span><span class="token operator">::</span><span class="token function">combineResult</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ:&quot;</span> <span class="token operator">+</span> f2<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testThenCombineAsync</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f1 <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">completedFuture</span><span class="token punctuation">(</span><span class="token string">&quot;testThenCombineAsync-1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å½“å‰å¼‚æ­¥ä»»åŠ¡è¦åˆå¹¶firstTaskå¼‚æ­¥ä»»åŠ¡</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f2 <span class="token operator">=</span>
            <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testThenCombineAsync-2&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenCombineAsync</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span>
                <span class="token class-name">TestThenCombineAndThenCombineAsync</span><span class="token operator">::</span><span class="token function">combineResult</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ:&quot;</span> <span class="token operator">+</span> f2<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ThreadPoolExecutor</span> pool <span class="token operator">=</span>
            <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MILLISECONDS</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">testThenCombine</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">testThenCombineAsync</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æµ‹è¯•ç»“æœï¼š</p> <p><img src="assets%5C1669890387729.png" alt="1669890387729"></p> <h4 id="thenacceptboth-thenacceptbothasync"><a href="#thenacceptboth-thenacceptbothasync" class="header-anchor">#</a> thenAcceptBoth &amp; thenAcceptBothAsync</h4> <p>thenAcceptBoth &amp; thenAcceptBothAsyncä¼š==å°†ä¸¤ä¸ªä»»åŠ¡çš„æ‰§è¡Œç»“æœä½œä¸ºæ–¹æ³•å…¥å‚ä¼ é€’åˆ°æŒ‡å®šæ–¹æ³•ä¸­ï¼Œå¹¶ä¸”æ— è¿”å›å€¼==ï¼ˆ<code>æœ‰å…¥å‚ï¼Œæ— è¿”å›å€¼</code>ï¼‰ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @param other è¦åˆå¹¶çš„å¼‚æ­¥ä»»åŠ¡
 * @param action å›è°ƒå‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°åŒ…å«2çš„å…¥å‚ï¼Œparam1ï¼šå½“å‰å¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œç»“æœï¼Œparam2ï¼šotherå¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œç»“æœ
 */</span>
<span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token function">thenCombine</span><span class="token punctuation">(</span><span class="token class-name">CompletionStage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> other<span class="token punctuation">,</span> <span class="token class-name">BiConsumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">,</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * @param other è¦åˆå¹¶çš„å¼‚æ­¥ä»»åŠ¡
 * @param action å›è°ƒå‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°åŒ…å«2çš„å…¥å‚ï¼Œparam1ï¼šå½“å‰å¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œç»“æœï¼Œparam2ï¼šotherå¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œç»“æœ
 */</span>
<span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token function">thenCombineAsync</span><span class="token punctuation">(</span><span class="token class-name">CompletionStage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> other<span class="token punctuation">,</span> <span class="token class-name">BiConsumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">,</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * @param other è¦åˆå¹¶çš„å¼‚æ­¥ä»»åŠ¡
 * @param action å›è°ƒå‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°åŒ…å«2çš„å…¥å‚ï¼Œparam1ï¼šå½“å‰å¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œç»“æœï¼Œparam2ï¼šotherå¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œç»“æœ
 * @param executor è‡ªå®šä¹‰çº¿ç¨‹æ± 
 */</span>
<span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token function">thenCombineAsync</span><span class="token punctuation">(</span><span class="token class-name">CompletionStage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> other<span class="token punctuation">,</span> <span class="token class-name">BiConsumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">,</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> action<span class="token punctuation">,</span> <span class="token class-name">Executor</span> executor<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>åŸºæœ¬ä½¿ç”¨ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestThenAcceptBothAndThenAcceptBothAsync</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token class-name">T</span> data<span class="token punctuation">,</span> <span class="token keyword">long</span> second<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;==================%s===================\nreturnOneData: %s%n&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">,</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">,</span> <span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">combineResult</span><span class="token punctuation">(</span><span class="token class-name">V</span> secondResult<span class="token punctuation">,</span> <span class="token class-name">U</span> firstResult<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;combineResult: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å¼‚æ­¥ä»»åŠ¡1çš„ç»“æœ: &quot;</span> <span class="token operator">+</span> firstResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å¼‚æ­¥ä»»åŠ¡2çš„ç»“æœ: &quot;</span> <span class="token operator">+</span> secondResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testThenAcceptBoth</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> f1 <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">runAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testThenAcceptBoth-1&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å½“å‰å¼‚æ­¥ä»»åŠ¡è¦åˆå¹¶firstTaskå¼‚æ­¥ä»»åŠ¡, secondResult=testThenAcceptBoth-2, firstResult=null</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> f2 <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testThenAcceptBoth-2&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">thenAcceptBoth</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span> <span class="token class-name">TestThenAcceptBothAndThenAcceptBothAsync</span><span class="token operator">::</span><span class="token function">combineResult</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ:&quot;</span> <span class="token operator">+</span> f2<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testThenAcceptBothAsync</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å½“å‰å¼‚æ­¥ä»»åŠ¡è¦åˆå¹¶firstTaskå¼‚æ­¥ä»»åŠ¡</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f1 <span class="token operator">=</span>
            <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testThenAcceptBothAsync-1&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> f2 <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">runAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testThenAcceptBothAsync-2&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">thenAcceptBothAsync</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span> <span class="token class-name">TestThenAcceptBothAndThenAcceptBothAsync</span><span class="token operator">::</span><span class="token function">combineResult</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ:&quot;</span> <span class="token operator">+</span> f2<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ThreadPoolExecutor</span> pool <span class="token operator">=</span>
            <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MILLISECONDS</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">testThenAcceptBoth</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">testThenAcceptBothAsync</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æµ‹è¯•ç»“æœï¼š</p> <p><img src="assets%5C1669890735440.png" alt="1669890735440"></p> <h4 id="runafterboth-runafterbothasync"><a href="#runafterboth-runafterbothasync" class="header-anchor">#</a> runAfterBoth &amp; runAfterBothAsync</h4> <p>runAfterBoth &amp; runAfterBothAsync==ä¸ä¼šå°†ä¸¤ä¸ªä»»åŠ¡çš„æ‰§è¡Œç»“æœä½œä¸ºæ–¹æ³•å…¥å‚ä¼ é€’åˆ°æŒ‡å®šæ–¹æ³•ä¸­ï¼Œå¹¶ä¸”æ— è¿”å›å€¼==ï¼ˆ<code>æ— å…¥å‚ï¼Œæ— è¿”å›å€¼</code>ï¼‰ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @param other è¦åˆå¹¶çš„å¼‚æ­¥ä»»åŠ¡
 * @param action å›è°ƒå‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°æ— å…¥å‚ï¼Œæ— è¿”å›å€¼
 */</span>
<span class="token keyword">public</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">runAfterBoth</span><span class="token punctuation">(</span><span class="token class-name">CompletionStage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> other<span class="token punctuation">,</span> <span class="token class-name">Runnable</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * @param other è¦åˆå¹¶çš„å¼‚æ­¥ä»»åŠ¡
 * @param action å›è°ƒå‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°æ— å…¥å‚ï¼Œæ— è¿”å›å€¼
 */</span>
<span class="token keyword">public</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">runAfterBothAsync</span><span class="token punctuation">(</span><span class="token class-name">CompletionStage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> other<span class="token punctuation">,</span> <span class="token class-name">Runnable</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * @param other è¦åˆå¹¶çš„å¼‚æ­¥ä»»åŠ¡
 * @param action å›è°ƒå‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°æ— å…¥å‚ï¼Œæ— è¿”å›å€¼
 * @param executor è‡ªå®šä¹‰çº¿ç¨‹æ± 
 */</span>
<span class="token keyword">public</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">runAfterBothAsync</span><span class="token punctuation">(</span><span class="token class-name">CompletionStage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> other<span class="token punctuation">,</span> <span class="token class-name">Runnable</span> action<span class="token punctuation">,</span> <span class="token class-name">Executor</span> executor<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>åŸºæœ¬ä½¿ç”¨ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestRunAfterBothAndRunAfterBothAsync</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token class-name">T</span> data<span class="token punctuation">,</span> <span class="token keyword">long</span> second<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;==================%s===================\nreturnOneData: %s%n&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">,</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">combineResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;combineResult: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testRunAfterBoth</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> f1 <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">runAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testThenAcceptBoth-1&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å½“å‰å¼‚æ­¥ä»»åŠ¡è¦åˆå¹¶firstTaskå¼‚æ­¥ä»»åŠ¡</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> f2 <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testThenAcceptBoth-2&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">runAfterBoth</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span> <span class="token class-name">TestRunAfterBothAndRunAfterBothAsync</span><span class="token operator">::</span><span class="token function">combineResult</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ:&quot;</span> <span class="token operator">+</span> f2<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testRunAfterBothAsync</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å½“å‰å¼‚æ­¥ä»»åŠ¡è¦åˆå¹¶firstTaskå¼‚æ­¥ä»»åŠ¡</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f1 <span class="token operator">=</span>
            <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testThenAcceptBothAsync-1&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> f2 <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">runAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testThenAcceptBothAsync-2&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">runAfterBothAsync</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span> <span class="token class-name">TestRunAfterBothAndRunAfterBothAsync</span><span class="token operator">::</span><span class="token function">combineResult</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ:&quot;</span> <span class="token operator">+</span> f2<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ThreadPoolExecutor</span> pool <span class="token operator">=</span>
            <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MILLISECONDS</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">testRunAfterBoth</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">testRunAfterBothAsync</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æµ‹è¯•ç»“æœï¼š</p> <p><img src="assets%5C1669893766602.png" alt="1669893766602"></p> <h3 id="orç»„åˆ"><a href="#orç»„åˆ" class="header-anchor">#</a> orç»„åˆ</h3> <p><strong>orç»„åˆ</strong>ï¼šæŒ‡==å°†ä¸¤ä¸ªCompletableFutureç»„åˆèµ·æ¥ï¼Œåªè¦å…¶ä¸­ä¸€ä¸ªCompletableFutureæ­£å¸¸æ‰§è¡Œå®Œï¼Œå°±ä¼šæ‰§è¡ŒæŸä¸ªä»»åŠ¡==ã€‚</p> <h4 id="applytoeither-applytoeitherasync"><a href="#applytoeither-applytoeitherasync" class="header-anchor">#</a> applyToEither &amp; applyToEitherAsync</h4> <p>applyToEither &amp; applyToEitherAsyncä¼š==å°†ä¸¤ä¸ªä»»åŠ¡çš„æ‰§è¡Œç»“æœä½œä¸ºæ–¹æ³•å…¥å‚ä¼ é€’åˆ°æŒ‡å®šæ–¹æ³•ä¸­ï¼Œå¹¶ä¸”æœ‰è¿”å›å€¼==ï¼ˆ<code>æœ‰å…¥å‚ï¼Œæœ‰è¿”å›å€¼</code>ï¼‰ã€‚</p> <blockquote><p>å…¥å‚1ï¼šè¡¨ç¤ºå…¶ä¸­ä¸€ä¸ªæ­£å¸¸æ‰§è¡Œå®Œçš„å¼‚æ­¥ä»»åŠ¡ç»“æœï¼›å¦‚æœéƒ½æ­£å¸¸æ‰§è¡Œå®Œï¼Œé‚£ä¹ˆè¯¥å€¼ä¸ºæœ€å…ˆæ‰§è¡Œå®Œçš„é‚£ä¸ªå¼‚æ­¥ä»»åŠ¡çš„ç»“æœã€‚</p> <p>è¿”å›å€¼ï¼š</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token function">applyToEither</span><span class="token punctuation">(</span><span class="token class-name">CompletionStage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> other<span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token function">applyToEitherAsync</span><span class="token punctuation">(</span><span class="token class-name">CompletionStage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> other<span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token function">applyToEitherAsync</span><span class="token punctuation">(</span><span class="token class-name">CompletionStage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> other<span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> fn<span class="token punctuation">,</span> <span class="token class-name">Executor</span> executor<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>åŸºæœ¬ä½¿ç”¨ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestApplyToEitherAndApplyToEitherAsync</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token class-name">T</span> data<span class="token punctuation">,</span> <span class="token keyword">long</span> second<span class="token punctuation">,</span> <span class="token keyword">boolean</span> markOfException<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">StringBuilder</span> msg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token string">&quot;==================%s===================\nreturnOneData: %s\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>markOfException<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            msg<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;exception: å½“å‰å¼‚æ­¥ä»»åŠ¡å‡ºç°å¼‚å¸¸ï¼ï¼ï¼\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// æ¨¡æ‹Ÿå¼‚å¸¸</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>markOfException<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">InterruptedException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">P</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">String</span> <span class="token function">combineResult</span><span class="token punctuation">(</span><span class="token class-name">P</span> param<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;combineResult: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å¼‚æ­¥ä»»åŠ¡çš„ç»“æœ: &quot;</span> <span class="token operator">+</span> param<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;combineResult#&quot;</span> <span class="token operator">+</span> param<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// case1: æ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸¤ä¸ªå¼‚æ­¥ä»»åŠ¡éƒ½æ‰§è¡Œå®Œã€‚å…¥å‚ä¸ºæœ€å…ˆæ‰§è¡Œå®Œçš„å¼‚æ­¥ä»»åŠ¡ç»“æœ</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testApplyToEither1</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f1 <span class="token operator">=</span>
            <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testApplyToEither1-1&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f2 <span class="token operator">=</span>
            <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testApplyToEither1-2&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">applyToEither</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span>
                <span class="token class-name">TestApplyToEitherAndApplyToEitherAsync</span><span class="token operator">::</span><span class="token function">combineResult</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ: &quot;</span> <span class="token operator">+</span> f2<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// case2: å…¶ä¸­ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡æŠ›å‡ºå¼‚å¸¸ã€‚å…¥å‚å°±æ˜¯æ­£å¸¸æ‰§è¡Œå®Œçš„å¼‚æ­¥ä»»åŠ¡ç»“æœ</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testApplyToEither2</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// f1å¼‚å¸¸æ‰§è¡Œå®Œ</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f1 <span class="token operator">=</span>
            <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testApplyToEither2-1&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f2 <span class="token operator">=</span>
            <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testApplyToEither2-2&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">applyToEither</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span>
                <span class="token class-name">TestApplyToEitherAndApplyToEitherAsync</span><span class="token operator">::</span><span class="token function">combineResult</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ: &quot;</span> <span class="token operator">+</span> f2<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// case1: æ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸¤ä¸ªå¼‚æ­¥ä»»åŠ¡éƒ½æ‰§è¡Œå®Œã€‚å…¥å‚ä¸ºæœ€å…ˆæ‰§è¡Œå®Œçš„å¼‚æ­¥ä»»åŠ¡ç»“æœ</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testApplyToEitherAsync1</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f1 <span class="token operator">=</span>
            <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testApplyToEitherAsync-1&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f2 <span class="token operator">=</span>
            <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testApplyToEitherAsync-2&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">applyToEitherAsync</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span> <span class="token class-name">TestApplyToEitherAndApplyToEitherAsync</span><span class="token operator">::</span><span class="token function">combineResult</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ: &quot;</span> <span class="token operator">+</span> f2<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// case2: å…¶ä¸­ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡æŠ›å‡ºå¼‚å¸¸ã€‚å…¥å‚å°±æ˜¯æ­£å¸¸æ‰§è¡Œå®Œçš„å¼‚æ­¥ä»»åŠ¡ç»“æœ</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testApplyToEitherAsync2</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f1 <span class="token operator">=</span>
            <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testApplyToEitherAsync-1&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f2 <span class="token operator">=</span>
            <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testApplyToEitherAsync-2&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">applyToEitherAsync</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span> <span class="token class-name">TestApplyToEitherAndApplyToEitherAsync</span><span class="token operator">::</span><span class="token function">combineResult</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ: &quot;</span> <span class="token operator">+</span> f2<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ThreadPoolExecutor</span> pool <span class="token operator">=</span>
            <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MILLISECONDS</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// testApplyToEither1(pool);</span>
        <span class="token comment">// testApplyToEither2(pool);</span>
        <span class="token function">testApplyToEitherAsync1</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">testApplyToEitherAsync2</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>applyToEitheræ–¹æ³•æµ‹è¯•ç»“æœï¼š</p> <p><img src="assets%5C1669893275719.png" alt="1669893275719"></p> <p>applyToEitherAsyncæ–¹æ³•æµ‹è¯•ç»“æœï¼š</p> <p><img src="assets%5C1669893373381.png" alt="1669893373381"></p> <h4 id="accepteither-accepteitherasync"><a href="#accepteither-accepteitherasync" class="header-anchor">#</a> acceptEither &amp; acceptEitherAsync</h4> <p>acceptEither &amp; acceptEitherAsyncä¼š==å°†ä¸¤ä¸ªä»»åŠ¡çš„æ‰§è¡Œç»“æœä½œä¸ºæ–¹æ³•å…¥å‚ä¼ é€’åˆ°æŒ‡å®šæ–¹æ³•ä¸­ï¼Œå¹¶ä¸”æ— è¿”å›å€¼==ï¼ˆ<code>æœ‰å…¥å‚ï¼Œæ— è¿”å›å€¼</code>ï¼‰ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token function">acceptEither</span><span class="token punctuation">(</span><span class="token class-name">CompletionStage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> other<span class="token punctuation">,</span> <span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token function">acceptEitherAsync</span><span class="token punctuation">(</span><span class="token class-name">CompletionStage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> other<span class="token punctuation">,</span> <span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token function">acceptEitherAsync</span><span class="token punctuation">(</span><span class="token class-name">CompletionStage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> other<span class="token punctuation">,</span> <span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> action<span class="token punctuation">,</span> <span class="token class-name">Executor</span> executor<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ç”¨æ³•åŒapplyToEither &amp; applyToEitherAsyncæ–¹æ³•ï¼Œå”¯ä¸€åŒºåˆ«åœ¨äºæŒ‡å®šçš„æ–¹æ³•æ— è¿”å›å€¼ã€‚</p> <h4 id="runaftereither-runaftereitherasync"><a href="#runaftereither-runaftereitherasync" class="header-anchor">#</a> runAfterEither &amp; runAfterEitherAsync</h4> <p>runAfterEither &amp; runAfterEitherAsync==ä¸ä¼šå°†ä¸¤ä¸ªä»»åŠ¡çš„æ‰§è¡Œç»“æœä½œä¸ºæ–¹æ³•å…¥å‚ä¼ é€’åˆ°æŒ‡å®šæ–¹æ³•ä¸­ï¼Œå¹¶ä¸”æ— è¿”å›å€¼==ï¼ˆ<code>æ— å…¥å‚ï¼Œæ— è¿”å›å€¼</code>ï¼‰ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token function">acceptEither</span><span class="token punctuation">(</span><span class="token class-name">CompletionStage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> other<span class="token punctuation">,</span> <span class="token class-name">Runnable</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token function">acceptEitherAsync</span><span class="token punctuation">(</span><span class="token class-name">CompletionStage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> other<span class="token punctuation">,</span> <span class="token class-name">Runnable</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token function">acceptEitherAsync</span><span class="token punctuation">(</span><span class="token class-name">CompletionStage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> other<span class="token punctuation">,</span> <span class="token class-name">Runnable</span> action<span class="token punctuation">,</span> <span class="token class-name">Executor</span> executor<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ç”¨æ³•åŒapplyToEither &amp; applyToEitherAsyncæ–¹æ³•ï¼Œå”¯ä¸€åŒºåˆ«åœ¨äºæŒ‡å®šçš„æ–¹æ³•æ— å…¥å‚ï¼Œæ— è¿”å›å€¼ã€‚</p> <h3 id="anyof"><a href="#anyof" class="header-anchor">#</a> anyOf</h3> <p>==åªè¦æœ‰ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œå°±ä¼šæ‰§è¡ŒanyOfæ–¹æ³•==ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„<code>CompletableFuture&lt;Object&gt;</code>å®ä¾‹å¯¹è±¡ ã€‚å¦‚æœä»»æ„ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡æŠ›å‡ºå¼‚å¸¸ï¼Œæ‰§è¡ŒanyOfæ–¹æ³•å¾—åˆ°çš„CompletableFuture<Object>å®ä¾‹å¯¹è±¡åœ¨æ‰§è¡Œgetæ–¹æ³•æ—¶ä¹Ÿä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</Object></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">anyOf</span><span class="token punctuation">(</span><span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> cfs<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>é€šå¸¸å¯ä»¥ä½¿ç”¨ anyOf æ–¹æ³•æ¥<strong>è·å–åˆ°æœ€å¿«æ‰§è¡Œå®Œçš„å¼‚æ­¥ä»»åŠ¡ç»“æœ</strong>ã€‚</p> <p>åŸºæœ¬ä½¿ç”¨ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token class-name">T</span> mark<span class="token punctuation">,</span> <span class="token keyword">long</span> second<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ¨¡æ‹Ÿå¼‚å¸¸</span>
        <span class="token comment">// int n = 1 / 0;</span>
        <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> <span class="token operator">|</span> <span class="token class-name">ArithmeticException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;==================%s===================\nreturnOneData: %s%n&quot;</span><span class="token punctuation">,</span> mark<span class="token punctuation">,</span>
                      <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> mark<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testAnyOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f1 <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;f1&quot;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f2 <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;f2&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f3 <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;f3&quot;</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// f2å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œå®Œåï¼Œå°±ä¼šæ‰§è¡ŒanyOfæ–¹æ³•</span>
    <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> f4 <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">anyOf</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span> f2<span class="token punctuation">,</span> f3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å¯ä»¥å–åˆ° data å’Œ error çš„å€¼ï¼Œè¿”å›çš„æ˜¯é¦–ä¸ªå®Œæˆçš„ä»»åŠ¡çš„CompletableFutureçš„è®¡ç®—ç»“æœ</span>
    f4<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> error<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;error:&quot;</span> <span class="token operator">+</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;data:&quot;</span> <span class="token operator">+</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;f1,f2,f3å¼‚æ­¥ä»»åŠ¡éƒ½å·²æ‰§è¡Œå®Œæ¯•~&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ1: &quot;</span> <span class="token operator">+</span> f1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ2: &quot;</span> <span class="token operator">+</span> f2<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ3: &quot;</span> <span class="token operator">+</span> f3<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è·å–æœ€å¿«å®Œæˆçš„å¼‚æ­¥ä»»åŠ¡ç»“æœ</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ4: &quot;</span> <span class="token operator">+</span> f4<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æµ‹è¯•ç»“æœï¼š</p> <p><img src="assets%5C1669886880583.png" alt="1669886880583"></p> <h3 id="allof"><a href="#allof" class="header-anchor">#</a> allOf</h3> <p>==æ‰€æœ‰çš„å¼‚æ­¥ä»»åŠ¡éƒ½æ‰§è¡Œå®Œæˆåï¼Œæ‰æ‰§è¡Œä¼š<code>allOf</code>æ–¹æ³•==ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„<code>CompletableFuture&lt;Void&gt;</code>å®ä¾‹å¯¹è±¡ã€‚å¦‚æœæ‰§è¡Œçš„å¼‚æ­¥ä»»åŠ¡æœ‰ä»»æ„ä¸€ä¸ªæŠ›å‡ºå¼‚å¸¸ï¼Œé‚£ä¹ˆæ‰§è¡ŒallOfæ–¹æ³•å¾—åˆ°çš„CompletableFuture<Void>å®ä¾‹å¯¹è±¡åœ¨æ‰§è¡Œgetæ–¹æ³•æ—¶å°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</Void></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">allOf</span><span class="token punctuation">(</span><span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> cfs<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>åŸºæœ¬ä½¿ç”¨ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">runOneTask</span><span class="token punctuation">(</span><span class="token class-name">String</span> mark<span class="token punctuation">,</span> <span class="token keyword">long</span> second<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ¨¡æ‹Ÿå¼‚æ­¥</span>
        <span class="token comment">// int i = 1 / 0;</span>
        <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> <span class="token operator">|</span> <span class="token class-name">ArithmeticException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;==================%s===================\nrunOneTask: %s%n&quot;</span><span class="token punctuation">,</span> mark<span class="token punctuation">,</span>
                      <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testAllOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> f1 <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">runAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">runOneTask</span><span class="token punctuation">(</span><span class="token string">&quot;f1&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> f2 <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">runAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">runOneTask</span><span class="token punctuation">(</span><span class="token string">&quot;f2&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> f3 <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">runAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">runOneTask</span><span class="token punctuation">(</span><span class="token string">&quot;f3&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> f4 <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">allOf</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span> f2<span class="token punctuation">,</span> f3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æ— æ³•è·å–åˆ° data å’Œ error çš„å€¼ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨å¤šä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œä¸ç¡®å®šæœ€ç»ˆæ‰§è¡Œå“ªä¸€ä¸ªä»»åŠ¡</span>
    f4<span class="token punctuation">.</span><span class="token function">whenComplete</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> error<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;error:&quot;</span> <span class="token operator">+</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;data:&quot;</span> <span class="token operator">+</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// null</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;f1,f2,f3å¼‚æ­¥ä»»åŠ¡éƒ½å·²æ‰§è¡Œå®Œæ¯•~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ1: &quot;</span> <span class="token operator">+</span> f1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ2: &quot;</span> <span class="token operator">+</span> f2<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ3: &quot;</span> <span class="token operator">+</span> f3<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ4: &quot;</span> <span class="token operator">+</span> f4<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æµ‹è¯•ç»“æœï¼š</p> <p><img src="assets%5C1669886932251.png" alt="1669886932251"></p> <h3 id="thencompose-thencomposeasync"><a href="#thencompose-thencomposeasync" class="header-anchor">#</a> thenCompose &amp; thenComposeAsync</h3> <p>thenCompose &amp; thenComposeAsyncæ–¹æ³•ä¼šåœ¨æŸä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œå°†å®ƒçš„æ‰§è¡Œç»“æœä½œä¸ºå…¥å‚å»æ‰§è¡ŒæŒ‡å®šçš„æ–¹æ³•ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„CompletableFutureå®ä¾‹ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token function">thenCompose</span><span class="token punctuation">(</span><span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">CompletionStage</span><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token function">thenComposeAsync</span><span class="token punctuation">(</span><span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">CompletionStage</span><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token function">thenComposeAsync</span><span class="token punctuation">(</span><span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">CompletionStage</span><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> fn<span class="token punctuation">,</span> <span class="token class-name">Executor</span> executor<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>åŸºæœ¬ä½¿ç”¨ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestThenComposeAndThenComposeAsync</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token class-name">T</span> mark<span class="token punctuation">,</span> <span class="token keyword">long</span> second<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> <span class="token operator">|</span> <span class="token class-name">ArithmeticException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;==================%s===================\nreturnOneData: %s%n&quot;</span><span class="token punctuation">,</span> mark<span class="token punctuation">,</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> mark<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// æ¥æ”¶åˆ°dataå°±æ˜¯supplyAsyncå•æ¡è¿”å›ç»“æœå€¼</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">handleOneData</span><span class="token punctuation">(</span><span class="token class-name">T</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;handleOneData: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;oldData:&quot;</span> <span class="token operator">+</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¯¹å•æ¡æ•°æ®è¿›è¡Œå¤„ç†</span>
        <span class="token class-name">String</span> newData <span class="token operator">=</span> <span class="token string">&quot;handleOneData#&quot;</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>data <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token string">&quot;Empty&quot;</span> <span class="token operator">:</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;newData:&quot;</span> <span class="token operator">+</span> newData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span>newData<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token class-name">T</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">handleOneData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è¿”å›ä¸€ä¸ªæ–°çš„CompletableFutureå®ä¾‹å¯¹è±¡</span>
        <span class="token keyword">return</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">completedFuture</span><span class="token punctuation">(</span><span class="token string">&quot;aitao&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testThenComposeAsync</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f <span class="token operator">=</span>
            <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testThenComposeAsync&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenComposeAsync</span><span class="token punctuation">(</span><span class="token class-name">TestThenComposeAndThenComposeAsync</span><span class="token operator">::</span><span class="token function">handle</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ: &quot;</span> <span class="token operator">+</span> f<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testThenCompose</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span> pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> f <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">returnOneData</span><span class="token punctuation">(</span><span class="token string">&quot;testThenCompose&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pool<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">thenCompose</span><span class="token punctuation">(</span><span class="token class-name">TestThenComposeAndThenComposeAsync</span><span class="token operator">::</span><span class="token function">handle</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç»ˆè¿”å›ç»“æœ: &quot;</span> <span class="token operator">+</span> f<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ThreadPoolExecutor</span> pool <span class="token operator">=</span>
            <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MILLISECONDS</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">testThenCompose</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">testThenComposeAsync</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æµ‹è¯•ç»“æœï¼š</p> <p><img src="assets%5C1669888999175.png" alt="1669888747087"></p> <blockquote><p><strong>thenCompose &amp; thenComposeAsyncçš„åŒºåˆ«?</strong></p> <ol><li>thenCompose æ˜¯ç”±æ‰§è¡Œä»»åŠ¡(returnOneData)çš„çº¿ç¨‹ç«‹å³æ‰§è¡Œä»»åŠ¡(handle)ï¼Œå³<code>ä¸¤ä¸ªä»»åŠ¡éƒ½ç”±åŒä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ</code>ã€‚</li> <li>thenComposeAsync æ˜¯å°†ä»»åŠ¡(handle)æäº¤åˆ°çº¿ç¨‹æ± ä¸­å¼‚æ­¥æ‰§è¡Œï¼Œå®é™…æ‰§è¡Œä»»åŠ¡(handle)çš„çº¿ç¨‹å¯èƒ½æ˜¯å¦å¤–ä¸€ä¸ªçº¿ç¨‹ï¼Œå³<code>å°†ä¸åŒä»»åŠ¡äº¤ç”±ä¸åŒçº¿ç¨‹æ‰§è¡Œ</code>ã€‚</li></ol></blockquote> <h2 id="å…¶ä»–api"><a href="#å…¶ä»–api" class="header-anchor">#</a> å…¶ä»–API</h2> <div class="language-java extra-class"><pre class="language-java"><code>
</code></pre></div><h2 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="header-anchor">#</a> æºç åˆ†æ</h2> <h3 id="completablefutureåº•å±‚è®¾è®¡"><a href="#completablefutureåº•å±‚è®¾è®¡" class="header-anchor">#</a> CompletableFutureåº•å±‚è®¾è®¡</h3> <p><img src="https://upload-images.jianshu.io/upload_images/16704367-f29d24823d4c3c83.png" alt="img"></p> <h3 id="completablefutureåˆå§‹åŒ–å±æ€§å€¼"><a href="#completablefutureåˆå§‹åŒ–å±æ€§å€¼" class="header-anchor">#</a> CompletableFutureåˆå§‹åŒ–å±æ€§å€¼</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// CompletableFutureçš„è®¡ç®—ç»“æœå€¼ï¼Œæˆ–è€…æ˜¯å¼‚å¸¸çš„åŒ…è£…å¯¹è±¡ï¼ˆAltResultï¼‰</span>
<span class="token keyword">volatile</span> <span class="token class-name">Object</span> result<span class="token punctuation">;</span>		<span class="token comment">// Either the result or boxed AltResult</span>
<span class="token comment">// ä¾èµ–äºå½“å‰CompletableFutureçš„å…¶ä»–å¼‚æ­¥ä»»åŠ¡ï¼Œéƒ½ä¼šå­˜æ”¾åœ¨è¿™ä¸ªå¹¶å‘æ ˆä¸­</span>
<span class="token keyword">volatile</span> <span class="token class-name">Completion</span> stack<span class="token punctuation">;</span>	<span class="token comment">// Top of Treiber stack of dependent actions</span>

<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>Unsafe</span> <span class="token constant">UNSAFE</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> <span class="token constant">RESULT</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> <span class="token constant">STACK</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> <span class="token constant">NEXT</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">final</span> <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>Unsafe</span> u<span class="token punctuation">;</span>
        <span class="token constant">UNSAFE</span> <span class="token operator">=</span> u <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>Unsafe</span><span class="token punctuation">.</span><span class="token function">getUnsafe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> k <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
        <span class="token constant">RESULT</span> <span class="token operator">=</span> u<span class="token punctuation">.</span><span class="token function">objectFieldOffset</span><span class="token punctuation">(</span>k<span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">&quot;result&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è®¡ç®—resultå±æ€§çš„ä½åç§»é‡</span>
        <span class="token constant">STACK</span> <span class="token operator">=</span> u<span class="token punctuation">.</span><span class="token function">objectFieldOffset</span><span class="token punctuation">(</span>k<span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">&quot;stack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è®¡ç®—stackå±æ€§çš„ä½åç§»é‡</span>
        <span class="token constant">NEXT</span> <span class="token operator">=</span> u<span class="token punctuation">.</span>objectFieldOffset
            <span class="token punctuation">(</span><span class="token class-name">Completion</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">&quot;next&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è®¡ç®—nextå±æ€§çš„ä½åç§»é‡</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// ç”¨äºæ ‡è®°tryFireæ–¹æ³•çš„æ¨¡å¼</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">SYNC</span>   <span class="token operator">=</span>  <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// åŒæ­¥</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">ASYNC</span>  <span class="token operator">=</span>  <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// å¼‚æ­¥</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">NESTED</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// åµŒå¥—</span>
</code></pre></div><h3 id="é»˜è®¤çº¿ç¨‹æ± "><a href="#é»˜è®¤çº¿ç¨‹æ± " class="header-anchor">#</a> é»˜è®¤çº¿ç¨‹æ± </h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// å¦‚æœçº¿ç¨‹æ± çš„å¹¶è¡Œçº§åˆ«å¤§äº1ï¼Œè¿”å›true</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> useCommonPool <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ForkJoinPool</span><span class="token punctuation">.</span><span class="token function">getCommonPoolParallelism</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// å¦‚æœuseCommonPool=true, é‚£ä¹ˆæ‰§è¡Œå¼‚æ­¥ä»»åŠ¡çš„çº¿ç¨‹ä»ForkJoinPool.commonPool()ä¸­åˆ†é…ï¼Œå¦åˆ™å°±ç›´æ¥new Thread()</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Executor</span> <span class="token constant">ASYNC_POOL</span> <span class="token operator">=</span> useCommonPool <span class="token operator">?</span> <span class="token class-name">ForkJoinPool</span><span class="token punctuation">.</span><span class="token function">commonPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPerTaskExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">ThreadPerTaskExecutor</span> <span class="token keyword">implements</span> <span class="token class-name">Executor</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">requireNonNull</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å»å¤„ç†å¼‚æ­¥ä»»åŠ¡</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="runasyncæºç åˆ†æ"><a href="#runasyncæºç åˆ†æ" class="header-anchor">#</a> runAsyncæºç åˆ†æ</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// (1)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">runAsync</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> runnable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">asyncRunStage</span><span class="token punctuation">(</span>asyncPool<span class="token punctuation">,</span> runnable<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// (2)</span>
<span class="token keyword">static</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">asyncRunStage</span><span class="token punctuation">(</span><span class="token class-name">Executor</span> e<span class="token punctuation">,</span> <span class="token class-name">Runnable</span> f<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>f <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œæƒæ˜¯ç”±Executorå†³å®šçš„</span>
    e<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AsyncRun</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> d<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// (3)</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">AsyncRun</span> <span class="token keyword">extends</span> <span class="token class-name">ForkJoinTask</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span><span class="token punctuation">,</span> <span class="token class-name">AsynchronousCompletionTask</span> <span class="token punctuation">{</span>
    <span class="token comment">// depï¼šå½“å‰CompletableFutureå®ä¾‹</span>
    <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> dep<span class="token punctuation">;</span>
    <span class="token comment">// fnï¼šè¦æ‰§è¡Œçš„å¼‚æ­¥ä»»åŠ¡</span>
    <span class="token class-name">Runnable</span> fn<span class="token punctuation">;</span>
    <span class="token class-name">AsyncRun</span><span class="token punctuation">(</span><span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> dep<span class="token punctuation">,</span> <span class="token class-name">Runnable</span> fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dep <span class="token operator">=</span> dep<span class="token punctuation">;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fn <span class="token operator">=</span> fn<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">Void</span> <span class="token function">getRawResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">setRawResult</span><span class="token punctuation">(</span><span class="token class-name">Void</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> d<span class="token punctuation">;</span>
        <span class="token class-name">Runnable</span> f<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>d <span class="token operator">=</span> dep<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>f <span class="token operator">=</span> fn<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// é‡Šæ”¾å†…å­˜</span>
            dep <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>fn <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token comment">// æ£€æµ‹å½“å‰å¼‚æ­¥ä»»åŠ¡æ˜¯å¦å·²ç»å®Œæˆ</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>d<span class="token punctuation">.</span>result <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token comment">// æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ï¼ˆç”¨æˆ·è‡ªå®šä¹‰çš„ä»»åŠ¡å†…å®¹ï¼‰</span>
                    f<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// åˆ©ç”¨caså°†CompletableFutureçš„ç»“æœèµ‹å€¼ä¸ºnullï¼Œç”¨AltResultè¿›è¡ŒåŒ…è£…</span>
                    d<span class="token punctuation">.</span><span class="token function">completeNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// åˆ©ç”¨caså°†CompletableFutureèµ‹å€¼ä¸ºå¼‚å¸¸ç»“æœï¼Œé€šå¸¸ç”¨AltResultåŒ…è£…å¼‚å¸¸ç»“æœ</span>
                    d<span class="token punctuation">.</span><span class="token function">completeThrowable</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// å½“å‰ä»»åŠ¡å®Œæˆä¹‹åï¼Œè¦æ‰§è¡Œçš„å…¶ä»–æ“ä½œã€‚</span>
            d<span class="token punctuation">.</span><span class="token function">postComplete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// (4) å½“å‰ä»»åŠ¡å®Œæˆåï¼Œä¼šæ‰§è¡Œæ‰€æœ‰ä¾èµ–æ­¤ä»»åŠ¡çš„å…¶ä»–å¼‚æ­¥ä»»åŠ¡ã€‚è¿™äº›å¼‚æ­¥ä»»åŠ¡éƒ½å­˜æ”¾åœ¨ä¸€ä¸ªå¹¶å‘æ ˆä¸­</span>
<span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">postComplete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// thisæŒ‡å½“å‰çš„CompletableFuture</span>
    <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> f <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">// </span>
    <span class="token class-name">Completion</span> h<span class="token punctuation">;</span>
    <span class="token comment">// æ£€æµ‹æ˜¯å¦å­˜åœ¨ä¾èµ–äºæ­¤CompletableFutureçš„å…¶ä»–å¼‚æ­¥ä»»åŠ¡</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>h <span class="token operator">=</span> f<span class="token punctuation">.</span>stack<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token punctuation">(</span>f <span class="token operator">!=</span> <span class="token keyword">this</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>h <span class="token operator">=</span> <span class="token punctuation">(</span>f <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span>stack<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> d<span class="token punctuation">;</span>
        <span class="token class-name">Completion</span> t<span class="token punctuation">;</span>
        <span class="token comment">// é€šè¿‡caså‡ºæ ˆ</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">casStack</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> t <span class="token operator">=</span> h<span class="token punctuation">.</span>next<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>t <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// å¦‚æœfä¸æ˜¯thisï¼Œå°†åˆšå‡ºæ ˆçš„hå…¥thisçš„æ ˆé¡¶</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>f <span class="token operator">!=</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">pushStack</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">continue</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                h<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// åˆ©ç”¨tryFireæ–¹æ³•æ£€æµ‹å½“å‰çš„CompletableFutureæ˜¯å¦å­˜åœ¨ä¾èµ–é¡¹ï¼Œå¦‚æœå­˜åœ¨ä¾èµ–é¡¹çš„å¼‚æ­¥ä»»åŠ¡ï¼Œç›´æ¥è¿”å›ï¼›å¦åˆ™</span>
            <span class="token comment">// è¿”å›å½“å‰çš„CompletableFutureï¼Œç»“æŸwhileå¾ªç¯</span>
            f <span class="token operator">=</span> <span class="token punctuation">(</span>d <span class="token operator">=</span> h<span class="token punctuation">.</span><span class="token function">tryFire</span><span class="token punctuation">(</span><span class="token constant">NESTED</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">this</span> <span class="token operator">:</span> d<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">pushStack</span><span class="token punctuation">(</span><span class="token class-name">Completion</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆ©ç”¨casè‡ªæ—‹æ–¹æ³•å°è¯•å°†cå‹å…¥æ ˆï¼Œé¿å…åŠ é”ç«äº‰</span>
    <span class="token keyword">do</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">tryPushStack</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token function">tryPushStack</span><span class="token punctuation">(</span><span class="token class-name">Completion</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Completion</span> h <span class="token operator">=</span> stack<span class="token punctuation">;</span>
    <span class="token comment">// å°è¯•å°†å½“å‰CompletableFutureçš„stackè®¾ç½®ä¸ºcçš„nextåŸŸ</span>
    <span class="token function">lazySetNext</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å°è¯•å°†å½“å‰æ ˆï¼ˆhï¼‰æ›´æ–°ä¸ºæ–°å€¼ï¼ˆcï¼‰</span>
    <span class="token keyword">return</span> <span class="token constant">UNSAFE</span><span class="token punctuation">.</span><span class="token function">compareAndSwapObject</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token constant">STACK</span><span class="token punctuation">,</span> h<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">lazySetNext</span><span class="token punctuation">(</span><span class="token class-name">Completion</span> c<span class="token punctuation">,</span> <span class="token class-name">Completion</span> next<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token constant">UNSAFE</span><span class="token punctuation">.</span><span class="token function">putOrderedObject</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token constant">NEXT</span><span class="token punctuation">,</span> next<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åˆ†æpostComplete()æ–¹æ³•å‰ï¼Œéœ€è¦æŒæ¡çš„å‰ç½®çŸ¥è¯†ç‚¹ï¼š</p> <ol><li>Completionç±»çš„ç»“æ„ã€‚å®ƒçš„åº•å±‚ç»“æ„å…¶å®å°±æ˜¯ä¸€ä¸ªé“¾è¡¨ç»“æ„ã€‚</li> <li>CompletableFutureå†…ç½®å±æ€§stackã€STACKã€NEXTã€NESTEDç­‰
<ul><li>stackï¼šå¯ä»¥ç†è§£ä¸ºå¤´èŠ‚ç‚¹</li></ul></li></ol> <h3 id="completionæºç åˆ†æ"><a href="#completionæºç åˆ†æ" class="header-anchor">#</a> Completionæºç åˆ†æ</h3> <p>Completionæºç ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// Completionå®ƒçš„åŸºæœ¬æ•°æ®ç»“æ„å…¶å®å°±æ˜¯ä¸€ä¸ªé“¾è¡¨</span>
<span class="token keyword">abstract</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Completion</span> <span class="token keyword">extends</span> <span class="token class-name">ForkJoinTask</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> 
	<span class="token keyword">implements</span> <span class="token class-name">Runnable</span><span class="token punctuation">,</span> <span class="token class-name">AsynchronousCompletionTask</span> <span class="token punctuation">{</span>
	<span class="token comment">// åç»§æŒ‡é’ˆåŸŸ</span>
    <span class="token keyword">volatile</span> <span class="token class-name">Completion</span> next<span class="token punctuation">;</span> <span class="token comment">// Treiber stack link</span>
    <span class="token keyword">abstract</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">tryFire</span><span class="token punctuation">(</span><span class="token keyword">int</span> mode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">abstract</span> <span class="token keyword">boolean</span> <span class="token function">isLive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">{</span> <span class="token function">tryFire</span><span class="token punctuation">(</span><span class="token constant">ASYNC</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token punctuation">{</span> <span class="token function">tryFire</span><span class="token punctuation">(</span><span class="token constant">ASYNC</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">Void</span> <span class="token function">getRawResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span>       <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">setRawResult</span><span class="token punctuation">(</span><span class="token class-name">Void</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Completionæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒç»§æ‰¿è‡ªForkJoinTaskç±»ï¼Œè€ŒForkJoinTaskç±»å®ç°äº†Futureæ¥å£ï¼Œæ•…Completionç±»å®é™…ä¸Šä¹Ÿæ˜¯ä¸€ä¸ªFutureã€‚åœ¨CompletableFutureä¸­å……å½“ä¸€ä¸ªæ‰©å±•çš„Futureéª¨æ¶ç±»ï¼Œå®ƒæ‰€æä¾›çš„å…·ä½“åŠŸèƒ½ç”±å­ç±»å®ç°ã€‚å®ƒçš„å®ç°ç±»æœ‰å¾ˆå¤šï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p> <p><img src="assets%5C1669902809692.png" alt="1669902809692"></p> <h3 id="completionstage"><a href="#completionstage" class="header-anchor">#</a> CompletionStage</h3> <p>CompletionStageå°±æ˜¯å®ç°äº†å°†ä¸€ä¸ªå¤§ä»»åŠ¡åˆ†æˆè‹¥ä¸ªå­ä»»åŠ¡ï¼Œè¿™äº›å­ä»»åŠ¡åŸºäºä¸€å®šçš„å¹¶è¡Œã€ä¸²è¡Œç»„åˆå½¢æˆä»»åŠ¡çš„ä¸åŒé˜¶æ®µï¼ŒCompletionStageæ¥å£å®ç°äº†å¯¹è¿™äº›å­ä»»åŠ¡ä¹‹é—´çš„å…³ç³»å®šä¹‰ï¼Œå¹¶æä¾›äº†éå¸¸ä¸°å¯Œçš„åŠŸèƒ½æ¥å£ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p> <p><img src="assets%5C1669910536423.png" alt="1669910536423"></p> <p><strong>CompletionStageç¡®ä¿äº†CompletableFutureèƒ½å¤Ÿè¿›è¡Œé“¾å¼è°ƒç”¨</strong></p> <h3 id="supplyasyncæºç åˆ†æ"><a href="#supplyasyncæºç åˆ†æ" class="header-anchor">#</a> supplyAsyncæºç åˆ†æ</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> supplier<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">asyncSupplyStage</span><span class="token punctuation">(</span>asyncPool<span class="token punctuation">,</span> supplier<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token function">asyncSupplyStage</span><span class="token punctuation">(</span><span class="token class-name">Executor</span> e<span class="token punctuation">,</span> <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> f<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>f <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    e<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AsyncSupply</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> d<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">AsyncSupply</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">extends</span> <span class="token class-name">ForkJoinTask</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> 
	<span class="token keyword">implements</span> <span class="token class-name">Runnable</span><span class="token punctuation">,</span> <span class="token class-name">AsynchronousCompletionTask</span> <span class="token punctuation">{</span>
	<span class="token comment">// depï¼šå½“å‰CompletableFutureå®ä¾‹</span>
    <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> dep<span class="token punctuation">;</span>
    <span class="token comment">// fnï¼šè¦æ‰§è¡Œçš„å¼‚æ­¥ä»»åŠ¡</span>
    <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> fn<span class="token punctuation">;</span>
    <span class="token class-name">AsyncSupply</span><span class="token punctuation">(</span><span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> dep<span class="token punctuation">,</span> <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dep <span class="token operator">=</span> dep<span class="token punctuation">;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fn <span class="token operator">=</span> fn<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">Void</span> <span class="token function">getRawResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">setRawResult</span><span class="token punctuation">(</span><span class="token class-name">Void</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> d<span class="token punctuation">;</span> <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> f<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>d <span class="token operator">=</span> dep<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>f <span class="token operator">=</span> fn<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        	<span class="token comment">// é‡Šæ”¾å†…å­˜</span>
            dep <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> fn <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token comment">// æ£€æµ‹å½“å‰å¼‚æ­¥ä»»åŠ¡æ˜¯å¦å·²ç»å®Œæˆ</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>d<span class="token punctuation">.</span>result <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                	<span class="token comment">// åˆ©ç”¨caså°†CompletableFutureçš„ç»“æœèµ‹å€¼ä¸ºf.get()</span>
                	<span class="token comment">// å¦‚æœf.get()çš„å€¼ä¸ºnullï¼Œä¼šå°†nullå€¼åŒ…è£…æˆAltResultå¯¹è±¡å†ç»™ç»“æœèµ‹å€¼</span>
                	d<span class="token punctuation">.</span><span class="token function">completeValue</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                	<span class="token comment">// åˆ©ç”¨caså°†CompletableFutureèµ‹å€¼ä¸ºå¼‚å¸¸ç»“æœï¼Œé€šå¸¸ç”¨AltResultåŒ…è£…å¼‚å¸¸ç»“æœ</span>
                	d<span class="token punctuation">.</span><span class="token function">completeThrowable</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// å½“å‰ä»»åŠ¡å®Œæˆä¹‹åï¼Œè¦æ‰§è¡Œçš„å…¶ä»–æ“ä½œã€‚</span>
            d<span class="token punctuation">.</span><span class="token function">postComplete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/ichigo/Javaå…¨ç³»åˆ—/Java IOæµ.html" class="prev">
          IOæµ
        </a></span> <span class="next"><a href="/ichigo/Javaå…¨ç³»åˆ—/Java9æ–°ç‰¹æ€§.html">
          Java9æ–°ç‰¹æ€§
        </a></span></p></div> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-b57cc07c data-v-7dd95ae2><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#ä»€ä¹ˆæ˜¯lambdaè¡¨è¾¾å¼" class="sidebar-link reco-side-ä»€ä¹ˆæ˜¯lambdaè¡¨è¾¾å¼" data-v-b57cc07c>ä»€ä¹ˆæ˜¯lambdaè¡¨è¾¾å¼</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#lambdaè¡¨è¾¾å¼ç±»å‹æ£€æŸ¥" class="sidebar-link reco-side-lambdaè¡¨è¾¾å¼ç±»å‹æ£€æŸ¥" data-v-b57cc07c>Lambdaè¡¨è¾¾å¼ç±»å‹æ£€æŸ¥</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#lambdaè¡¨è¾¾å¼ç±»å‹æ¨æ–­" class="sidebar-link reco-side-lambdaè¡¨è¾¾å¼ç±»å‹æ¨æ–­" data-v-b57cc07c>Lambdaè¡¨è¾¾å¼ç±»å‹æ¨æ–­</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#lambdaè¡¨è¾¾å¼è¡Œä¸ºå‚æ•°åŒ–" class="sidebar-link reco-side-lambdaè¡¨è¾¾å¼è¡Œä¸ºå‚æ•°åŒ–" data-v-b57cc07c>Lambdaè¡¨è¾¾å¼è¡Œä¸ºå‚æ•°åŒ–</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#lambdaè¡¨è¾¾å¼ä¸Šä¸‹æ–‡" class="sidebar-link reco-side-lambdaè¡¨è¾¾å¼ä¸Šä¸‹æ–‡" data-v-b57cc07c>Lambdaè¡¨è¾¾å¼ä¸Šä¸‹æ–‡</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#lambdaè¡¨è¾¾å¼çš„ä½œç”¨åŸŸ" class="sidebar-link reco-side-lambdaè¡¨è¾¾å¼çš„ä½œç”¨åŸŸ" data-v-b57cc07c>Lambdaè¡¨è¾¾å¼çš„ä½œç”¨åŸŸ</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#lambdaè¡¨è¾¾å¼å˜é‡æ•è·" class="sidebar-link reco-side-lambdaè¡¨è¾¾å¼å˜é‡æ•è·" data-v-b57cc07c>Lambdaè¡¨è¾¾å¼å˜é‡æ•è·</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#lambdaçš„ä¸»ä½“è¯­å¥" class="sidebar-link reco-side-lambdaçš„ä¸»ä½“è¯­å¥" data-v-b57cc07c>Lambdaçš„ä¸»ä½“è¯­å¥</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#é€’å½’lambdaè¡¨è¾¾å¼" class="sidebar-link reco-side-é€’å½’lambdaè¡¨è¾¾å¼" data-v-b57cc07c>é€’å½’Lambdaè¡¨è¾¾å¼</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#â­lambdaåº•å±‚åŸç†" class="sidebar-link reco-side-â­lambdaåº•å±‚åŸç†" data-v-b57cc07c>â­Lambdaåº•å±‚åŸç†</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#functionalinterface" class="sidebar-link reco-side-functionalinterface" data-v-b57cc07c>@FunctionalInterface</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#é€šç”¨å‡½æ•°å¼æ¥å£" class="sidebar-link reco-side-é€šç”¨å‡½æ•°å¼æ¥å£" data-v-b57cc07c>é€šç”¨å‡½æ•°å¼æ¥å£</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#java-util-functionåŒ…" class="sidebar-link reco-side-java-util-functionåŒ…" data-v-b57cc07c>java.util.functionåŒ…</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#function-t-r" class="sidebar-link reco-side-function-t-r" data-v-b57cc07c>Function</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#bifunction-t-u-r" class="sidebar-link reco-side-bifunction-t-u-r" data-v-b57cc07c>BiFunction</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#predicate" class="sidebar-link reco-side-predicate" data-v-b57cc07c>Predicate</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#bipredicate-t-u" class="sidebar-link reco-side-bipredicate-t-u" data-v-b57cc07c>BiPredicate</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#consumer" class="sidebar-link reco-side-consumer" data-v-b57cc07c>Consumer</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#biconsumer-t-u" class="sidebar-link reco-side-biconsumer-t-u" data-v-b57cc07c>BiConsumer</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#supplier" class="sidebar-link reco-side-supplier" data-v-b57cc07c>Supplier</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#unaryoperator" class="sidebar-link reco-side-unaryoperator" data-v-b57cc07c>UnaryOperator</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#binaryoperator" class="sidebar-link reco-side-binaryoperator" data-v-b57cc07c>BinaryOperator</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#äº¤å‰ç±»å‹" class="sidebar-link reco-side-äº¤å‰ç±»å‹" data-v-b57cc07c>äº¤å‰ç±»å‹</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#é»˜è®¤æ–¹æ³•å†²çª" class="sidebar-link reco-side-é»˜è®¤æ–¹æ³•å†²çª" data-v-b57cc07c>é»˜è®¤æ–¹æ³•å†²çª</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#é™æ€é»˜è®¤æ–¹æ³•" class="sidebar-link reco-side-é™æ€é»˜è®¤æ–¹æ³•" data-v-b57cc07c>é™æ€é»˜è®¤æ–¹æ³•</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#æ–¹æ³•å¼•ç”¨" class="sidebar-link reco-side-æ–¹æ³•å¼•ç”¨" data-v-b57cc07c>æ–¹æ³•å¼•ç”¨</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#æ–¹æ³•å¼•ç”¨ç±»å‹" class="sidebar-link reco-side-æ–¹æ³•å¼•ç”¨ç±»å‹" data-v-b57cc07c>æ–¹æ³•å¼•ç”¨ç±»å‹</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#å®ä¾‹æ–¹æ³•å¼•ç”¨" class="sidebar-link reco-side-å®ä¾‹æ–¹æ³•å¼•ç”¨" data-v-b57cc07c>å®ä¾‹æ–¹æ³•å¼•ç”¨</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#æ„é€ å‡½æ•°å¼•ç”¨" class="sidebar-link reco-side-æ„é€ å‡½æ•°å¼•ç”¨" data-v-b57cc07c>æ„é€ å‡½æ•°å¼•ç”¨</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#é€šç”¨æ–¹æ³•å¼•ç”¨" class="sidebar-link reco-side-é€šç”¨æ–¹æ³•å¼•ç”¨" data-v-b57cc07c>é€šç”¨æ–¹æ³•å¼•ç”¨</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#ä»€ä¹ˆæ˜¯stream" class="sidebar-link reco-side-ä»€ä¹ˆæ˜¯stream" data-v-b57cc07c>ä»€ä¹ˆæ˜¯Stream</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#ç”Ÿæˆstream" class="sidebar-link reco-side-ç”Ÿæˆstream" data-v-b57cc07c>ç”ŸæˆStream</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#streamå¸¸ç”¨æ–¹æ³•" class="sidebar-link reco-side-streamå¸¸ç”¨æ–¹æ³•" data-v-b57cc07c>Streamå¸¸ç”¨æ–¹æ³•</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#streamä¸­é—´æ“ä½œ" class="sidebar-link reco-side-streamä¸­é—´æ“ä½œ" data-v-b57cc07c>Streamä¸­é—´æ“ä½œ</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#ç­›é€‰ä¸åˆ‡ç‰‡" class="sidebar-link reco-side-ç­›é€‰ä¸åˆ‡ç‰‡" data-v-b57cc07c>ç­›é€‰ä¸åˆ‡ç‰‡</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#æ˜ å°„" class="sidebar-link reco-side-æ˜ å°„" data-v-b57cc07c>æ˜ å°„</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#æ’åº" class="sidebar-link reco-side-æ’åº" data-v-b57cc07c>æ’åº</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#æ¶ˆè´¹" class="sidebar-link reco-side-æ¶ˆè´¹" data-v-b57cc07c>æ¶ˆè´¹</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#streamç»ˆæ­¢æ“ä½œ" class="sidebar-link reco-side-streamç»ˆæ­¢æ“ä½œ" data-v-b57cc07c>Streamç»ˆæ­¢æ“ä½œ</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#streamæœ«ç«¯æ“ä½œ" class="sidebar-link reco-side-streamæœ«ç«¯æ“ä½œ" data-v-b57cc07c>Streamæœ«ç«¯æ“ä½œ</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#è§„çº¦æ“ä½œ" class="sidebar-link reco-side-è§„çº¦æ“ä½œ" data-v-b57cc07c>è§„çº¦æ“ä½œ</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#æ”¶é›†æ“ä½œ" class="sidebar-link reco-side-æ”¶é›†æ“ä½œ" data-v-b57cc07c>æ”¶é›†æ“ä½œ</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#collectors" class="sidebar-link reco-side-collectors" data-v-b57cc07c>Collectors</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#â­streamæºç åˆ†æ" class="sidebar-link reco-side-â­streamæºç åˆ†æ" data-v-b57cc07c>â­Streamæºç åˆ†æ</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#base64" class="sidebar-link reco-side-base64" data-v-b57cc07c>Base64</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#åˆ›å»ºå¼‚æ­¥ä»»åŠ¡" class="sidebar-link reco-side-åˆ›å»ºå¼‚æ­¥ä»»åŠ¡" data-v-b57cc07c>åˆ›å»ºå¼‚æ­¥ä»»åŠ¡</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#supplyasync" class="sidebar-link reco-side-supplyasync" data-v-b57cc07c>supplyAsync</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#runasync" class="sidebar-link reco-side-runasync" data-v-b57cc07c>runAsync</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#è·å–å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œç»“æœ" class="sidebar-link reco-side-è·å–å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œç»“æœ" data-v-b57cc07c>è·å–å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œç»“æœ</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#é˜»å¡å¼è·å–æ‰§è¡Œç»“æœ" class="sidebar-link reco-side-é˜»å¡å¼è·å–æ‰§è¡Œç»“æœ" data-v-b57cc07c>é˜»å¡å¼è·å–æ‰§è¡Œç»“æœ</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#ä¸»åŠ¨å®Œæˆä»»åŠ¡" class="sidebar-link reco-side-ä¸»åŠ¨å®Œæˆä»»åŠ¡" data-v-b57cc07c>ä¸»åŠ¨å®Œæˆä»»åŠ¡</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#å¼‚æ­¥ä»»åŠ¡å›è°ƒ" class="sidebar-link reco-side-å¼‚æ­¥ä»»åŠ¡å›è°ƒ" data-v-b57cc07c>å¼‚æ­¥ä»»åŠ¡å›è°ƒ</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#thenapply-thenapplyasync" class="sidebar-link reco-side-thenapply-thenapplyasync" data-v-b57cc07c>thenApply &amp; thenApplyAsync</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#thenaccept-thenacceptasync" class="sidebar-link reco-side-thenaccept-thenacceptasync" data-v-b57cc07c>thenAccept &amp; thenAcceptAsync</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#thenrun-thenrunasync" class="sidebar-link reco-side-thenrun-thenrunasync" data-v-b57cc07c>thenRun &amp; thenRunAsync</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#whencomplete-whencompleteasync" class="sidebar-link reco-side-whencomplete-whencompleteasync" data-v-b57cc07c>whenComplete &amp; whenCompleteAsync</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#handle-handleasync" class="sidebar-link reco-side-handle-handleasync" data-v-b57cc07c>handle &amp; handleAsync</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#exceptionally-exceptionallyasync" class="sidebar-link reco-side-exceptionally-exceptionallyasync" data-v-b57cc07c>exceptionally &amp; exceptionallyAsync</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#å¤šå¼‚æ­¥ä»»åŠ¡" class="sidebar-link reco-side-å¤šå¼‚æ­¥ä»»åŠ¡" data-v-b57cc07c>å¤šå¼‚æ­¥ä»»åŠ¡</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#andç»„åˆ" class="sidebar-link reco-side-andç»„åˆ" data-v-b57cc07c>andç»„åˆ</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#orç»„åˆ" class="sidebar-link reco-side-orç»„åˆ" data-v-b57cc07c>orç»„åˆ</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#anyof" class="sidebar-link reco-side-anyof" data-v-b57cc07c>anyOf</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#allof" class="sidebar-link reco-side-allof" data-v-b57cc07c>allOf</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#thencompose-thencomposeasync" class="sidebar-link reco-side-thencompose-thencomposeasync" data-v-b57cc07c>thenCompose &amp; thenComposeAsync</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#å…¶ä»–api" class="sidebar-link reco-side-å…¶ä»–api" data-v-b57cc07c>å…¶ä»–API</a></li><li class="level-2" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#æºç åˆ†æ" class="sidebar-link reco-side-æºç åˆ†æ" data-v-b57cc07c>æºç åˆ†æ</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#completablefutureåº•å±‚è®¾è®¡" class="sidebar-link reco-side-completablefutureåº•å±‚è®¾è®¡" data-v-b57cc07c>CompletableFutureåº•å±‚è®¾è®¡</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#completablefutureåˆå§‹åŒ–å±æ€§å€¼" class="sidebar-link reco-side-completablefutureåˆå§‹åŒ–å±æ€§å€¼" data-v-b57cc07c>CompletableFutureåˆå§‹åŒ–å±æ€§å€¼</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#é»˜è®¤çº¿ç¨‹æ± " class="sidebar-link reco-side-é»˜è®¤çº¿ç¨‹æ± " data-v-b57cc07c>é»˜è®¤çº¿ç¨‹æ± </a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#runasyncæºç åˆ†æ" class="sidebar-link reco-side-runasyncæºç åˆ†æ" data-v-b57cc07c>runAsyncæºç åˆ†æ</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#completionæºç åˆ†æ" class="sidebar-link reco-side-completionæºç åˆ†æ" data-v-b57cc07c>Completionæºç åˆ†æ</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#completionstage" class="sidebar-link reco-side-completionstage" data-v-b57cc07c>CompletionStage</a></li><li class="level-3" data-v-b57cc07c><a href="/ichigo/Java%E5%85%A8%E7%B3%BB%E5%88%97/Java8%E6%96%B0%E7%89%B9%E6%80%A7.html#supplyasyncæºç åˆ†æ" class="sidebar-link reco-side-supplyasyncæºç åˆ†æ" data-v-b57cc07c>supplyAsyncæºç åˆ†æ</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><!----><div></div></div></div>
    <script src="/ichigo/assets/js/app.8ce08534.js" defer></script><script src="/ichigo/assets/js/3.440a4598.js" defer></script><script src="/ichigo/assets/js/1.7543bd4f.js" defer></script><script src="/ichigo/assets/js/13.ecbcfc5b.js" defer></script><script src="/ichigo/assets/js/9.00897824.js" defer></script>
  </body>
</html>
